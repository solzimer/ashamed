<<<<<<< HEAD
{"version":3,"sources":["angular-ashamed.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","window","AshamedClient","shm","angular","provider","self","host","base","realtime","$get","service","config","$q","$rootScope","$timeout","client","on","$apply","resolve","data","q","defer","promise","get","path","options","then","set","item","diff","changes","update","Path","extend","EventEmitter","applyChanges","applyDiff","strToPath","pathToStr","getPath","WebSocketClient","WebSocket","w3cwebsocket","store","backup","pending","vfn","CHANNEL","DEF_OPTS","handleMessage","msg","JSON","parse","channel","type","modelUpdate","modelResponse","args","patch","cid","err","cb","_options","_host","_base","_realtime","_url","ws","http","_err","connect","callback","Math","random","_ready","send","stringify","def","onerror","emit","reject","onopen","onmessage","onclose","_send","op","undefined","old","jiff","Array","isArray","replace","split","filter","res","join","startsWith","concat","b","create","src","val","root","folder","shift","Object","keys","target","source","d","forEach","p","opath","np","pop","patchInPlace","applyChange","change","_events","_maxListeners","prototype","defaultMaxListeners","setMaxListeners","isNumber","isNaN","TypeError","er","handler","len","listeners","error","isObject","arguments","context","isUndefined","isFunction","slice","apply","addListener","listener","m","newListener","push","warned","console","trace","once","fired","g","removeListener","list","position","splice","removeAllListeners","key","ret","listenerCount","evlistener","emitter","arg","hasOwn","hasOwnProperty","toStr","toString","arr","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","constructor","name","copy","copyIsArray","clone","deep","lcs","array","inverse","jsonPointer","encodeSegment","applyInPlace","InvalidPatchOperationError","TestFailedError","PatchNotInvertibleError","isValidObject","defaultHash","appendChanges","initState","hash","orElse","makeContext","defaultContext","invertible","state","appendArrayChanges","appendObjectChanges","appendValueChanges","o1","o2","keyPath","value","a1","a2","a1hash","map","a2hash","lcsMatrix","compare","lcsToJsonPatch","offset","reduce","j","last","REMOVE","ADD","predicate","x","y","message","captureStackTrace","cons","tail","cloneArray","cloneObject","k","commutePaths","left","right","prefix","getCommonPathPrefix","isArrayPath","ac","copyPatch","bc","commuteArrayPaths","commuteTreePaths","commuteArraySiblings","commuteArrayAncestor","absolute","index","isValidArrayIndex","lpath","rpath","lindex","rindex","commuted","max","direction","rc","p1","p2","p1l","p2l","min","from","deepEquals","compareArrays","compareObjects","akeys","bkeys","patches","pr","skip","invertOp","c","defaultOptions","_parse","find","contains","decodeSegment","parseArrayIndex","separator","separatorRx","encodedSeparator","encodedSeparatorRx","escapeChar","escapeRx","encodedEscape","encodedEscapeRx","findContext","parent","hasContext","segment","findIndex","segments","bind","indexOf","arrayIndexRx","test","SyntaxError","start","jsonPointerParse","parseRx","onSegment","pos","accum","matches","match","charAt","lastIndex","exec","RIGHT","DOWN","SKIP","EQUAL","cols","rows","findPrefix","suffix","findSuffix","remove","matrix","createMatrix","backtrack","al","bl","lastrow","applyTest","invertTest","commute","commuteTest","add","applyAdd","invertAdd","commuteAddOrCopy","applyRemove","invertRemove","commuteRemove","applyReplace","invertReplace","commuteReplace","move","applyMove","invertMove","commuteMove","applyCopy","notInvertible","pointer","notFound","_add","before","after","missingValue","prev","_remove","removed","pto","pfrom","fromContext","_","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","run","nextTick","Item","title","browser","env","argv","version","versions","noop","off","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","definition","bootstrap","define","amd","ses","ok","makeQ","global","previousQ","Q","noConflict","hasStacks","stack","qStartingLine","captureLine","qFileName","head","task","next","flushing","requestTick","isNodeJS","laterQueue","flush","domain","enter","runSingle","exit","setImmediate","MessageChannel","port1","requestPortTick","port2","postMessage","runAfter","Function","uncurryThis","array_slice","array_reduce","basis","array_indexOf","array_map","thisp","collect","object_create","Type","object_defineProperty","defineProperty","prop","descriptor","object_hasOwnProperty","object_keys","object","object_toString","isStopIteration","exception","QReturnValue","ReturnValue","STACK_JUMP_SEPARATOR","makeStackTraceLong","stacks","__minimumStackCounter__","stackCounter","configurable","unshift","concatedStacks","filterStackString","stackString","lines","desiredLines","line","isInternalFrame","isNodeFrame","stackLine","getFileNameAndLineNumber","attempt1","Number","attempt2","attempt3","fileNameAndLineNumber","fileName","lineNumber","qEndingLine","firstLine","deprecate","alternative","warn","Promise","isPromiseAlike","coerce","fulfill","longStackSupport","longStackCounter","Q_DEBUG","messages","progressListeners","resolvedPromise","deferred","promiseDispatch","operands","valueOf","nearerValue","nearer","isPromise","inspect","substring","become","newPromise","reason","notify","progress","progressListener","makeNodeResolver","resolver","race","all","passByCopy","that","spread","answerPs","makePromise","fallback","result","inspected","fulfilled","rejected","progressed","done","_fulfilled","_rejected","newException","_progressed","newValue","threw","tap","fcall","thenResolve","when","thenReject","isPending","isFulfilled","isRejected","unhandledReasons","unhandledRejections","reportedUnhandledRejections","trackUnhandledRejections","resetUnhandledRejections","trackRejection","untrackRejection","at","atReport","getUnhandledReasons","stopUnhandledRejectionTracking","rejection","rhs","master","dispatch","async","makeGenerator","continuer","verb","StopIteration","generator","errback","spawn","_return","promised","del","mapply","post","mcall","invoke","fapply","fbind","fbound","promises","pendingCount","snapshot","any","current","onFulfilled","onRejected","onProgress","allResolved","allSettled","regardless","fail","fin","onUnhandledError","ms","timeoutId","delay","nfapply","nodeArgs","nfcall","nfbind","denodeify","baseArgs","nbind","bound","nmapply","npost","nsend","nmcall","ninvoke","nodeify","nodeback","_global","NativeWebSocket","MozWebSocket","websocket_version","W3CWebSocket","uri","protocols","native_instance"],"mappings":";;;;;;;;;;;;;;AAAA,CAAC,SAASA,CAAT,CAAWC,CAAX,EAAaC,CAAb,EAAeC,CAAf,EAAiB;AAAC,aAASC,CAAT,CAAWC,CAAX,EAAaC,CAAb,EAAe;AAAC,YAAG,CAACJ,EAAEG,CAAF,CAAJ,EAAS;AAAC,gBAAG,CAACJ,EAAEI,CAAF,CAAJ,EAAS;AAAC,oBAAIE,IAAE,OAAOC,OAAP,IAAgB,UAAhB,IAA4BA,OAAlC,CAA0C,IAAG,CAACF,CAAD,IAAIC,CAAP,EAAS,OAAOA,EAAEF,CAAF,EAAI,CAAC,CAAL,CAAP,CAAe,IAAGI,CAAH,EAAK,OAAOA,EAAEJ,CAAF,EAAI,CAAC,CAAL,CAAP,CAAe,IAAIK,IAAE,IAAIC,KAAJ,CAAU,yBAAuBN,CAAvB,GAAyB,GAAnC,CAAN,CAA8C,MAAMK,EAAEE,IAAF,GAAO,kBAAP,EAA0BF,CAAhC;AAAkC,iBAAIG,IAAEX,EAAEG,CAAF,IAAK,EAACS,SAAQ,EAAT,EAAX,CAAwBb,EAAEI,CAAF,EAAK,CAAL,EAAQU,IAAR,CAAaF,EAAEC,OAAf,EAAuB,UAASd,CAAT,EAAW;AAAC,oBAAIE,IAAED,EAAEI,CAAF,EAAK,CAAL,EAAQL,CAAR,CAAN,CAAiB,OAAOI,EAAEF,IAAEA,CAAF,GAAIF,CAAN,CAAP;AAAgB,aAApE,EAAqEa,CAArE,EAAuEA,EAAEC,OAAzE,EAAiFd,CAAjF,EAAmFC,CAAnF,EAAqFC,CAArF,EAAuFC,CAAvF;AAA0F,gBAAOD,EAAEG,CAAF,EAAKS,OAAZ;AAAoB,SAAIL,IAAE,OAAOD,OAAP,IAAgB,UAAhB,IAA4BA,OAAlC,CAA0C,KAAI,IAAIH,IAAE,CAAV,EAAYA,IAAEF,EAAEa,MAAhB,EAAuBX,GAAvB;AAA2BD,UAAED,EAAEE,CAAF,CAAF;AAA3B,KAAmC,OAAOD,CAAP;AAAS,CAAzb,EAA2b,EAAC,GAAE,CAAC,UAASI,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC/d,SAAC,UAASI,MAAT,EAAgB;AAChB;;AAEA,gBAAMC,gBAAgBX,QAAQ,kBAAR,CAAtB;AACA,gBAAMY,MAAMC,QAAQJ,MAAR,CAAe,SAAf,EAAyB,EAAzB,CAAZ;;AAEAG,gBAAIE,QAAJ,CAAa,eAAb,EAA6B,YAAU;AACtC,oBAAIC,OAAO,IAAX;AACA,qBAAKC,IAAL,GAAY,gBAAZ;AACA,qBAAKC,IAAL,GAAY,EAAZ;AACA,qBAAKC,QAAL,GAAgB,IAAhB;;AAEA,qBAAKC,IAAL,GAAY,YAAW;AACtB,2BAAO;AACNH,8BAAOD,KAAKC,IADN;AAENC,8BAAOF,KAAKE,IAFN;AAGNC,kCAAWH,KAAKG;AAHV,qBAAP;AAKA,iBAND;AAOA,aAbD;;AAeAN,gBAAIQ,OAAJ,CAAY,gBAAZ,EAA6B,CAAC,eAAD,EAAiB,IAAjB,EAAsB,YAAtB,EAAmC,UAAnC,EAC7B,UAASC,MAAT,EAAgBC,EAAhB,EAAmBC,UAAnB,EAA8BC,QAA9B,EAAuC;AACtC,oBAAMC,SAAS,IAAId,aAAJ,CAAkBU,MAAlB,CAAf;;AAEAI,uBAAOC,EAAP,CAAU,SAAV,EAAoB,YAAI;AACvBH,+BAAWI,MAAX;AACA,iBAFD;;AAIA,yBAASC,OAAT,CAAiBC,IAAjB,EAAuB;AACtB,wBAAIC,IAAIR,GAAGS,KAAH,EAAR;AACAP,6BAAS,YAAI;AACZD,mCAAWI,MAAX;AACA,qBAFD,EAEE,EAFF;AAGAG,sBAAEF,OAAF,CAAUC,IAAV;AACA,2BAAOC,EAAEE,OAAT;AACA;;AAED,qBAAKC,GAAL,GAAW,UAASC,IAAT,EAAcC,OAAd,EAAuB;AACjC,2BAAOV,OAAOQ,GAAP,CAAWC,IAAX,EAAgBC,OAAhB,EAAyBC,IAAzB,CAA8BR,OAA9B,CAAP;AACA,iBAFD;;AAIA,qBAAKS,GAAL,GAAW,UAASH,IAAT,EAAcI,IAAd,EAAmBH,OAAnB,EAA4B;AACtC,2BAAOV,OAAOY,GAAP,CAAWH,IAAX,EAAgBI,IAAhB,EAAqBH,OAArB,EAA8BC,IAA9B,CAAmCR,OAAnC,CAAP;AACA,iBAFD;;AAIA,qBAAKW,IAAL,GAAY,UAASL,IAAT,EAAcM,OAAd,EAAuB;AAClC,2BAAOf,OAAOc,IAAP,CAAYL,IAAZ,EAAiBM,OAAjB,EAA0BJ,IAA1B,CAA+BR,OAA/B,CAAP;AACA,iBAFD;;AAIA,qBAAKa,MAAL,GAAc,UAASP,IAAT,EAAcI,IAAd,EAAoB;AACjC,2BAAOb,OAAOgB,MAAP,CAAcP,IAAd,EAAmBI,IAAnB,EAAyBF,IAAzB,CAA8BR,OAA9B,CAAP;AACA,iBAFD;AAGD,aAhC6B,CAA7B;AAkCA,SAvDD,EAuDGlB,MAvDH;AAyDC,KA1D6b,EA0D5b,EAAC,oBAAmB,CAApB,EA1D4b,CAAH,EA0Dja,GAAE,CAAC,UAASV,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC7D,YACCwB,IAAI9B,QAAQ,GAAR,CADL;AAAA,YAEC0C,OAAO1C,QAAQ,WAAR,CAFR;AAAA,YAGC2C,SAAS3C,QAAQ,QAAR,CAHV;AAAA,YAIC4C,eAAe5C,QAAQ,QAAR,CAJhB;AAAA,YAKCuC,OAAOG,KAAKH,IALb;AAAA,YAMCM,eAAeH,KAAKG,YANrB;AAAA,YAOCC,YAAYJ,KAAKI,SAPlB;AAAA,YAQCC,YAAYL,KAAKK,SARlB;AAAA,YASCC,YAAYN,KAAKM,SATlB;AAAA,YAUCC,UAAUP,KAAKO,OAVhB;;AAYA,YAAMC,kBAAkB,OAAOC,SAAP,KAAoB,WAApB,GACvBA,SADuB,GACXnD,QAAQ,WAAR,EAAqBoD,YADlC;;AAGA,YAAIC,QAAQ,EAAZ;AAAA,YAAgBC,SAAS,EAAzB;AACA,YAAIC,UAAU,EAAd;;AAEA,YAAMC,MAAM,SAANA,GAAM,GAAI,CAAE,CAAlB;AACA,YAAMC,UAAU,SAAhB;AACA,YAAMC,WAAW;AAChB1C,kBAAO,gBADS;AAEhBC,kBAAO,EAFS;AAGhBC,sBAAW;;AAGZ;;;;AANiB,SAAjB,CAUA,SAASyC,aAAT,CAAuBC,GAAvB,EAA4B;AAC3BA,kBAAMC,KAAKC,KAAL,CAAWF,IAAI/B,IAAf,CAAN;AACA;AACA,gBAAG+B,IAAIG,OAAJ,IAAaN,OAAhB,EAAyB;AACzB,gBAAGG,IAAII,IAAJ,IAAY,cAAf,EAA+B;AAACC,4BAAYL,GAAZ;AAAkB,aAAlD,MACK,IAAGA,IAAII,IAAJ,IAAY,UAAf,EAA2B;AAACE,8BAAcN,GAAd;AAAoB;AACrD;;AAED;;;;AAIA,iBAASK,WAAT,CAAqBL,GAArB,EAA0B;AACzB,gBAAI1B,OAAO0B,IAAIO,IAAJ,CAAS,CAAT,CAAX;AACA,gBAAI3B,UAAUoB,IAAIO,IAAJ,CAAS,CAAT,KAAa,EAA3B;AACA;AACAjC,mBAAOa,UAAUb,IAAV,CAAP;;AAEA;AACAW,yBAAaS,MAAb,EAAoBd,OAApB,EAA4BN,IAA5B;AACA,gBAAIkC,QAAQ7B,KAAKc,KAAL,EAAWC,MAAX,CAAZ;AACAT,yBAAaQ,KAAb,EAAmBe,KAAnB;AACA;;AAED,iBAASF,aAAT,CAAuBN,GAAvB,EAA4B;AAC3B,gBAAIS,MAAMT,IAAIS,GAAd;;AAD2B,2CAEVT,IAAIO,IAFM;AAAA,gBAEtBG,GAFsB;AAAA,gBAElBzC,IAFkB;;AAI3B,gBAAG,CAAC0B,QAAQc,GAAR,CAAJ,EAAkB,OAAlB,KACK;AACJ,oBAAIE,KAAKhB,QAAQc,GAAR,CAAT;AACA,uBAAOd,QAAQc,GAAR,CAAP;AACAE,mBAAGD,GAAH,EAAOzC,IAAP;AACA;AACD;;AAjE4D,YAmEvDlB,aAnEuD;AAAA;;AAoE5D,mCAAYwB,OAAZ,EAAqB;AAAA;;AAAA;;AAGpBA,0BAAUQ,OAAO,EAAP,EAAUe,QAAV,EAAmBvB,OAAnB,CAAV;AACA,sBAAKqC,QAAL,GAAgBrC,OAAhB;AACA,sBAAKsC,KAAL,GAAatC,QAAQnB,IAArB;AACA,sBAAK0D,KAAL,GAAavC,QAAQlB,IAArB;AACA,sBAAK0D,SAAL,GAAiBxC,QAAQjB,QAAzB;AACA,sBAAK0D,IAAL,GAAY;AACXC,wBAAK,UAAQ1C,QAAQnB,IAAhB,GAAqBmB,QAAQlB,IAA7B,GAAkC,KAD5B;AAEX6D,0BAAO,YAAU3C,QAAQnB,IAAlB,GAAuBmB,QAAQlB;AAF3B,iBAAZ;AAIA,sBAAK8D,IAAL,GAAY,IAAZ;AACA,sBAAKC,OAAL;AAboB;AAcpB;;AAlF2D;AAAA;AAAA,sCAoFtDpB,GApFsD,EAoFlDqB,QApFkD,EAoFxC;AACnB,wBAAIX,MAAM,KAAKS,IAAf;AACAnB,wBAAIG,OAAJ,GAAcN,OAAd;AACAwB,+BAAWA,YAAYzB,GAAvB;;AAEA;AACAI,wBAAIS,GAAJ,WAAgBa,KAAKC,MAAL,EAAhB;AACA5B,4BAAQK,IAAIS,GAAZ,IAAmBY,QAAnB;;AAEA,wBAAG,CAACX,GAAJ,EAAS;AACR,6BAAKc,MAAL,CAAYhD,IAAZ,CAAiB,cAAI;AACpByC,+BAAGQ,IAAH,CAAQxB,KAAKyB,SAAL,CAAe1B,GAAf,CAAR;AACA,yBAFD,EAEE,eAAK;AACNU,gCAAIlE,IAAJ,GAAW,OAAX;AACA6E,qCAASX,GAAT,EAAa,IAAb;AACA,yBALD;AAMA,qBAPD,MAQK;AACJA,4BAAIlE,IAAJ,GAAW,OAAX;AACA6E,iCAASX,GAAT,EAAa,IAAb;AACA;AACD;AAzG2D;AAAA;AAAA,0CA+GlD;AAAA;;AACT,wBAAIiB,MAAMzD,EAAEC,KAAF,EAAV;AACA,wBAAI8C,KAAK,IAAI3B,eAAJ,CAAoB,KAAK0B,IAAL,CAAUC,EAA9B,CAAT;AACAA,uBAAGW,OAAH,GAAa,UAAClB,GAAD,EAAO;AACnB,+BAAKS,IAAL,6BAAoC,OAAKH,IAAL,CAAUC,EAA9C;AACA,+BAAKY,IAAL,CAAU,OAAV,EAAkB,OAAKV,IAAvB;AACAQ,4BAAIG,MAAJ,CAAW,OAAKX,IAAhB;AACA,qBAJD;AAKAF,uBAAGc,MAAH,GAAY,YAAI;AACf,+BAAKZ,IAAL,GAAY,IAAZ;AACA,+BAAKU,IAAL,CAAU,OAAV;AACAF,4BAAI3D,OAAJ,CAAYiD,EAAZ;AACA,qBAJD;AAKAA,uBAAGe,SAAH,GAAe,UAAChC,GAAD,EAAO;AACrBD,sCAAcC,GAAd;AACA,+BAAK6B,IAAL,CAAU,SAAV,EAAoB7B,GAApB;AACA,qBAHD;AAIAiB,uBAAGgB,OAAH,GAAa,YAAI;AAChB,+BAAKJ,IAAL,CAAU,OAAV;AACA,+BAAKV,IAAL,GAAY,IAAI5E,KAAJ,CAAU,4BAAV,CAAZ;AACA,qBAHD;AAIA,yBAAKiF,MAAL,GAAcG,IAAIvD,OAAlB;AACA;AArI2D;AAAA;AAAA,oCAuIxDE,IAvIwD,EAuInDC,OAvImD,EAuI1C;AACjB,wBAAIoD,MAAMzD,EAAEC,KAAF,EAAV;AACA,wBAAIsC,MAAM,QAAMa,KAAKC,MAAL,EAAhB;;AAEAhD,8BAAUQ,OAAO,EAAP,EAAU,KAAK6B,QAAf,EAAwBrC,OAAxB,CAAV;AACA,yBAAK2D,KAAL,CAAW,EAACC,IAAG,KAAJ,EAAW5B,MAAK,CAACjC,IAAD,EAAMC,OAAN,CAAhB,EAAX,EAA2C,UAACmC,GAAD,EAAKzC,IAAL,EAAa;AACvD,4BAAGyC,OAAOA,IAAIlE,IAAd,EAAoB;AAACmF,gCAAIG,MAAJ,CAAWpB,GAAX;AAAiB,yBAAtC,MACK,IAAGnC,QAAQjB,QAAR,IAAoBW,SAAO,IAA3B,IAAmCA,SAAOmE,SAA7C,EAAwD;AAC5DlD,sCAAUO,KAAV,EAAgBxB,IAAhB,EAAqBK,IAArB;AACAoB,qCAASX,OAAO,IAAP,EAAY,EAAZ,EAAeU,KAAf,CAAT;AACAkC,gCAAI3D,OAAJ,CAAYqB,QAAQf,IAAR,EAAa,KAAb,EAAmBmB,KAAnB,CAAZ;AACA,yBAJI,MAKA;AAACkC,gCAAI3D,OAAJ,CAAYC,IAAZ;AAAmB;AACzB,qBARD;;AAUA,2BAAO0D,IAAIvD,OAAX;AACA;AAvJ2D;AAAA;AAAA,oCAyJxDE,IAzJwD,EAyJnDI,IAzJmD,EAyJ9CH,OAzJ8C,EAyJrC;AACtB,wBAAIoD,MAAMzD,EAAEC,KAAF,EAAV;AACA,wBAAIsC,MAAM,QAAMa,KAAKC,MAAL,EAAhB;;AAEAhD,8BAAUQ,OAAO,EAAP,EAAU,KAAK6B,QAAf,EAAwBrC,OAAxB,CAAV;AACA,yBAAK2D,KAAL,CAAW,EAACC,IAAG,KAAJ,EAAW5B,MAAK,CAACjC,IAAD,EAAMI,IAAN,EAAWH,OAAX,CAAhB,EAAX,EAAgD,UAACmC,GAAD,EAAKzC,IAAL,EAAa;AAC5D,4BAAGyC,OAAOA,IAAIlE,IAAd,EAAoB;AAACmF,gCAAIG,MAAJ,CAAWpB,GAAX;AAAiB,yBAAtC,MACK,IAAGnC,QAAQjB,QAAX,EAAqB;AACzB4B,sCAAUO,KAAV,EAAgBxB,IAAhB,EAAqBK,IAArB;AACAoB,qCAASX,OAAO,IAAP,EAAY,EAAZ,EAAeU,KAAf,CAAT;AACAkC,gCAAI3D,OAAJ,CAAYqB,QAAQf,IAAR,EAAa,KAAb,EAAmBmB,KAAnB,CAAZ;AACA,yBAJI,MAKA;AAACkC,gCAAI3D,OAAJ,CAAYC,IAAZ;AAAmB;AACzB,qBARD;;AAUA,2BAAO0D,IAAIvD,OAAX;AACA;AAzK2D;AAAA;AAAA,uCA2KrDE,IA3KqD,EA2KhDI,IA3KgD,EA2K1C;AACjB,wBAAI1C,IAAIyD,KAAR;AACA,wBAAI4C,MAAMhD,QAAQf,IAAR,EAAa,IAAb,EAAkBoB,MAAlB,CAAV;AACA,wBAAId,UAAUD,KAAK0D,GAAL,EAAS3D,IAAT,CAAd;AACA,2BAAO,KAAKC,IAAL,CAAUL,IAAV,EAAeM,OAAf,CAAP;AACA;AAhL2D;AAAA;AAAA,qCAkLvDN,IAlLuD,EAkLlDM,OAlLkD,EAkLzC;AAClB,wBAAI+C,MAAMzD,EAAEC,KAAF,EAAV;AACA,wBAAIsC,MAAM,QAAMa,KAAKC,MAAL,EAAhB;;AAEA,yBAAKW,KAAL,CAAW,EAACC,IAAG,MAAJ,EAAY5B,MAAK,CAACjC,IAAD,EAAMM,OAAN,CAAjB,EAAX,EAA4C,UAAC8B,GAAD,EAAKzC,IAAL,EAAa;AACxD,4BAAGyC,OAAOA,IAAIlE,IAAd,EAAoB;AAACmF,gCAAIG,MAAJ,CAAWpB,GAAX;AAAiB,yBAAtC,MACK;AAACiB,gCAAI3D,OAAJ,CAAYC,IAAZ;AAAmB;AACzB,qBAHD;;AAKA,2BAAO0D,IAAIvD,OAAX;AACA;AA5L2D;AAAA;AAAA,qCA8LvDf,IA9LuD,EA8LjD;AACV,wBAAIsE,MAAMzD,EAAEC,KAAF,EAAV;AACA,wBAAIsC,MAAM,QAAMa,KAAKC,MAAL,EAAhB;;AAEA,yBAAKW,KAAL,CAAW,EAACC,IAAG,MAAJ,EAAY5B,MAAK,CAAClD,IAAD,CAAjB,EAAX,EAAoC,UAACqD,GAAD,EAAKzC,IAAL,EAAa;AAChD,4BAAGyC,OAAOA,IAAIlE,IAAd,EAAoB;AAACmF,gCAAIG,MAAJ,CAAWpB,GAAX;AAAiB,yBAAtC,MACK;AAACiB,gCAAI3D,OAAJ,CAAYC,IAAZ;AAAmB;AACzB,qBAHD;;AAKA,2BAAO0D,IAAIvD,OAAX;AACA;AAxM2D;AAAA;AAAA,oCA2GhD;AACX,2BAAOqB,KAAP;AACA;AA7G2D;;AAAA;AAAA,UAmEjCT,YAnEiC;;AA2M7DnC,eAAOH,OAAP,GAAiBK,aAAjB;AAEC,KA7M2B,EA6M1B,EAAC,aAAY,CAAb,EAAe,UAAS,CAAxB,EAA0B,UAAS,CAAnC,EAAqC,KAAI,EAAzC,EAA4C,aAAY,EAAxD,EA7M0B,CA1D+Z,EAuQ5X,GAAE,CAAC,UAASX,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAClG,YACCqC,SAAS3C,QAAQ,QAAR,CADV;AAAA,YAECkG,OAAOlG,QAAQ,MAAR,CAFR;;AAIA,iBAAS+C,SAAT,CAAmBb,IAAnB,EAAyB;AACxBA,mBAAOA,QAAQ,EAAf;AACA,mBAAOiE,MAAMC,OAAN,CAAclE,IAAd,IACNA,IADM,GAENA,KAAKmE,OAAL,CAAa,IAAb,EAAkB,EAAlB,EAAsBC,KAAtB,CAA4B,GAA5B,EAAiCC,MAAjC,CAAwC;AAAA,uBAAG3G,EAAEY,MAAL;AAAA,aAAxC,CAFD;AAGA;;AAED,iBAASwC,SAAT,CAAmBd,IAAnB,EAAyB;AACxBA,mBAAOA,QAAQ,EAAf;AACA,gBAAIsE,MAAM,OAAOtE,IAAP,IAAc,QAAd,GAAwBA,IAAxB,GAA+BA,KAAKuE,IAAL,CAAU,GAAV,CAAzC;AACA,mBAAOD,IAAIE,UAAJ,CAAe,GAAf,IAAsBF,GAAtB,SAAgCA,GAAvC;AACA;;AAED,iBAASG,MAAT,CAAgB5G,CAAhB,EAAkB6G,CAAlB,EAAqB;AACpB7G,gBAAIgD,UAAUhD,CAAV,CAAJ;AACA6G,gBAAI7D,UAAU6D,CAAV,CAAJ;AACA,mBAAO5D,UAAU,GAAG2D,MAAH,CAAU5G,CAAV,EAAa4G,MAAb,CAAoBC,CAApB,CAAV,CAAP;AACA;;AAED,iBAAS3D,OAAT,CAAiBf,IAAjB,EAAsB2E,MAAtB,EAA6BC,GAA7B,EAAiCC,GAAjC,EAAsC;AACrC,gBAAIC,OAAOF,OAAO,EAAlB;AACA5E,mBAAOa,UAAUb,IAAV,CAAP;AACA,gBAAG,CAACA,KAAK1B,MAAT,EAAkB;AACjB,uBAAOmC,OAAOmE,GAAP,EAAWC,GAAX,CAAP;AACA;AACD,mBAAM7E,KAAK1B,MAAX,EAAmB;AAClB,oBAAIyG,SAAS/E,KAAKgF,KAAL,EAAb;AACA,oBAAG,CAACF,KAAKC,MAAL,CAAJ,EAAkB;AACjB,wBAAGJ,MAAH,EAAW;AAACG,6BAAKC,MAAL,IAAe,EAAf;AAAmB,qBAA/B,MACK;AAAC,+BAAO,IAAP;AAAa;AACnB;AACD,oBAAG,CAAC/E,KAAK1B,MAAN,IAAgBuG,QAAMf,SAAzB,EAAoC;AACnC,wBAAG,QAAOgB,KAAKC,MAAL,CAAP,KAAsB,QAAtB,IAAkCE,OAAOC,IAAP,CAAYJ,KAAKC,MAAL,CAAZ,EAA0BzG,MAA/D,EAAuE;AACtE,4BAAG,QAAOuG,GAAP,yCAAOA,GAAP,MAAa,QAAhB,EAA0BpE,OAAO,IAAP,EAAYqE,KAAKC,MAAL,CAAZ,EAAyBF,GAAzB,EAA1B,KACKC,KAAKC,MAAL,IAAeF,GAAf;AACL,qBAHD,MAIK;AACJC,6BAAKC,MAAL,IAAeF,GAAf;AACA;AACD;AACDC,uBAAOA,KAAKC,MAAL,CAAP;AACA,oBAAG,CAAC/E,KAAK1B,MAAT,EAAiB,OAAOwG,IAAP;AACjB;AACD;;AAED,iBAASzE,IAAT,CAAc8E,MAAd,EAAqBC,MAArB,EAA6B;AAC5B,mBAAOpB,KAAK3D,IAAL,CAAU8E,MAAV,EAAiBC,MAAjB,EAAyBf,MAAzB,CAAgC;AAAA,uBAAGgB,EAAExB,EAAF,IAAM,MAAT;AAAA,aAAhC,CAAP;AACA;;AAED,iBAASjD,SAAT,CAAmBuE,MAAnB,EAA0BC,MAA1B,EAAiCpF,IAAjC,EAAuC;AACtC,gBAAIqF,IAAI,EAAR;AACAtE,oBAAQf,IAAR,EAAa,IAAb,EAAkBqF,CAAlB,EAAoBD,MAApB;AACA,mBAAO3E,OAAO,IAAP,EAAY0E,MAAZ,EAAmBE,CAAnB,CAAP;AACA;;AAED,iBAAS1E,YAAT,CAAsBwE,MAAtB,EAA6BjD,KAA7B,EAAmClC,IAAnC,EAAyC;AACxCkC,kBAAMoD,OAAN,CAAc,aAAG;AAChBC,kBAAEC,KAAF,GAAUD,EAAEvF,IAAZ;AACAuF,kBAAEvF,IAAF,GAASyE,OAAOzE,IAAP,EAAYuF,EAAEvF,IAAd,CAAT;AACA,oBAAIyF,KAAK5E,UAAU0E,EAAEvF,IAAZ,CAAT;AACA,oBAAGyF,GAAGnH,MAAH,GAAU,CAAb,EAAgBmH,GAAGC,GAAH;AAChB3E,wBAAQ0E,EAAR,EAAW,IAAX,EAAgBN,MAAhB;AACA,aAND;AAOAnB,iBAAK2B,YAAL,CAAkBzD,KAAlB,EAAyBiD,MAAzB;AACAjD,kBAAMoD,OAAN,CAAc,aAAG;AAChBC,kBAAEvF,IAAF,GAASuF,EAAEC,KAAX;AACA,uBAAOD,EAAEC,KAAT;AACA,aAHD;AAIA;;AAED,iBAASI,WAAT,CAAqBT,MAArB,EAA4BU,MAA5B,EAAoC;AACnC9E,oBAAQ8E,OAAO7F,IAAf,EAAoB,KAApB,EAA0BmF,MAA1B;AACAnB,iBAAK2B,YAAL,CAAkB,CAACE,MAAD,CAAlB,EAA4BV,MAA5B;AACA;;AAED5G,eAAOH,OAAP,GAAiB;AAChByC,uBAAYA,SADI;AAEhBC,uBAAYA,SAFI;AAGhBC,qBAAUA,OAHM;AAIhBV,kBAAOA,IAJS;AAKhBoE,oBAASA,MALO;AAMhB7D,uBAAYA,SANI;AAOhBgF,yBAAcA,WAPE;AAQhBjF,0BAAeA;AARC,SAAjB;AAWC,KA3FgE,EA2F/D,EAAC,UAAS,CAAV,EAAY,QAAO,CAAnB,EA3F+D,CAvQ0X,EAkWla,GAAE,CAAC,UAAS7C,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAASsC,YAAT,GAAwB;AACtB,iBAAKoF,OAAL,GAAe,KAAKA,OAAL,IAAgB,EAA/B;AACA,iBAAKC,aAAL,GAAqB,KAAKA,aAAL,IAAsBjC,SAA3C;AACD;AACDvF,eAAOH,OAAP,GAAiBsC,YAAjB;;AAEA;AACAA,qBAAaA,YAAb,GAA4BA,YAA5B;;AAEAA,qBAAasF,SAAb,CAAuBF,OAAvB,GAAiChC,SAAjC;AACApD,qBAAasF,SAAb,CAAuBD,aAAvB,GAAuCjC,SAAvC;;AAEA;AACA;AACApD,qBAAauF,mBAAb,GAAmC,EAAnC;;AAEA;AACA;AACAvF,qBAAasF,SAAb,CAAuBE,eAAvB,GAAyC,UAAS1I,CAAT,EAAY;AACnD,gBAAI,CAAC2I,SAAS3I,CAAT,CAAD,IAAgBA,IAAI,CAApB,IAAyB4I,MAAM5I,CAAN,CAA7B,EACE,MAAM6I,UAAU,6BAAV,CAAN;AACF,iBAAKN,aAAL,GAAqBvI,CAArB;AACA,mBAAO,IAAP;AACD,SALD;;AAOAkD,qBAAasF,SAAb,CAAuBzC,IAAvB,GAA8B,UAASzB,IAAT,EAAe;AAC3C,gBAAIwE,EAAJ,EAAQC,OAAR,EAAiBC,GAAjB,EAAsBvE,IAAtB,EAA4BlE,CAA5B,EAA+B0I,SAA/B;;AAEA,gBAAI,CAAC,KAAKX,OAAV,EACE,KAAKA,OAAL,GAAe,EAAf;;AAEF;AACA,gBAAIhE,SAAS,OAAb,EAAsB;AACpB,oBAAI,CAAC,KAAKgE,OAAL,CAAaY,KAAd,IACCC,SAAS,KAAKb,OAAL,CAAaY,KAAtB,KAAgC,CAAC,KAAKZ,OAAL,CAAaY,KAAb,CAAmBpI,MADzD,EACkE;AAChEgI,yBAAKM,UAAU,CAAV,CAAL;AACA,wBAAIN,cAAcrI,KAAlB,EAAyB;AACvB,8BAAMqI,EAAN,CADuB,CACb;AACX,qBAFD,MAEO;AACL;AACA,4BAAIlE,MAAM,IAAInE,KAAJ,CAAU,2CAA2CqI,EAA3C,GAAgD,GAA1D,CAAV;AACAlE,4BAAIyE,OAAJ,GAAcP,EAAd;AACA,8BAAMlE,GAAN;AACD;AACF;AACF;;AAEDmE,sBAAU,KAAKT,OAAL,CAAahE,IAAb,CAAV;;AAEA,gBAAIgF,YAAYP,OAAZ,CAAJ,EACE,OAAO,KAAP;;AAEF,gBAAIQ,WAAWR,OAAX,CAAJ,EAAyB;AACvB,wBAAQK,UAAUtI,MAAlB;AACE;AACA,yBAAK,CAAL;AACEiI,gCAAQlI,IAAR,CAAa,IAAb;AACA;AACF,yBAAK,CAAL;AACEkI,gCAAQlI,IAAR,CAAa,IAAb,EAAmBuI,UAAU,CAAV,CAAnB;AACA;AACF,yBAAK,CAAL;AACEL,gCAAQlI,IAAR,CAAa,IAAb,EAAmBuI,UAAU,CAAV,CAAnB,EAAiCA,UAAU,CAAV,CAAjC;AACA;AACF;AACA;AACE3E,+BAAOgC,MAAM+B,SAAN,CAAgBgB,KAAhB,CAAsB3I,IAAtB,CAA2BuI,SAA3B,EAAsC,CAAtC,CAAP;AACAL,gCAAQU,KAAR,CAAc,IAAd,EAAoBhF,IAApB;AAdJ;AAgBD,aAjBD,MAiBO,IAAI0E,SAASJ,OAAT,CAAJ,EAAuB;AAC5BtE,uBAAOgC,MAAM+B,SAAN,CAAgBgB,KAAhB,CAAsB3I,IAAtB,CAA2BuI,SAA3B,EAAsC,CAAtC,CAAP;AACAH,4BAAYF,QAAQS,KAAR,EAAZ;AACAR,sBAAMC,UAAUnI,MAAhB;AACA,qBAAKP,IAAI,CAAT,EAAYA,IAAIyI,GAAhB,EAAqBzI,GAArB;AACE0I,8BAAU1I,CAAV,EAAakJ,KAAb,CAAmB,IAAnB,EAAyBhF,IAAzB;AADF;AAED;;AAED,mBAAO,IAAP;AACD,SArDD;;AAuDAvB,qBAAasF,SAAb,CAAuBkB,WAAvB,GAAqC,UAASpF,IAAT,EAAeqF,QAAf,EAAyB;AAC5D,gBAAIC,CAAJ;;AAEA,gBAAI,CAACL,WAAWI,QAAX,CAAL,EACE,MAAMd,UAAU,6BAAV,CAAN;;AAEF,gBAAI,CAAC,KAAKP,OAAV,EACE,KAAKA,OAAL,GAAe,EAAf;;AAEF;AACA;AACA,gBAAI,KAAKA,OAAL,CAAauB,WAAjB,EACE,KAAK9D,IAAL,CAAU,aAAV,EAAyBzB,IAAzB,EACUiF,WAAWI,SAASA,QAApB,IACAA,SAASA,QADT,GACoBA,QAF9B;;AAIF,gBAAI,CAAC,KAAKrB,OAAL,CAAahE,IAAb,CAAL;AACE;AACA,qBAAKgE,OAAL,CAAahE,IAAb,IAAqBqF,QAArB,CAFF,KAGK,IAAIR,SAAS,KAAKb,OAAL,CAAahE,IAAb,CAAT,CAAJ;AACH;AACA,qBAAKgE,OAAL,CAAahE,IAAb,EAAmBwF,IAAnB,CAAwBH,QAAxB,EAFG;AAIH;AACA,qBAAKrB,OAAL,CAAahE,IAAb,IAAqB,CAAC,KAAKgE,OAAL,CAAahE,IAAb,CAAD,EAAqBqF,QAArB,CAArB;;AAEF;AACA,gBAAIR,SAAS,KAAKb,OAAL,CAAahE,IAAb,CAAT,KAAgC,CAAC,KAAKgE,OAAL,CAAahE,IAAb,EAAmByF,MAAxD,EAAgE;AAC9D,oBAAI,CAACT,YAAY,KAAKf,aAAjB,CAAL,EAAsC;AACpCqB,wBAAI,KAAKrB,aAAT;AACD,iBAFD,MAEO;AACLqB,wBAAI1G,aAAauF,mBAAjB;AACD;;AAED,oBAAImB,KAAKA,IAAI,CAAT,IAAc,KAAKtB,OAAL,CAAahE,IAAb,EAAmBxD,MAAnB,GAA4B8I,CAA9C,EAAiD;AAC/C,yBAAKtB,OAAL,CAAahE,IAAb,EAAmByF,MAAnB,GAA4B,IAA5B;AACAC,4BAAQd,KAAR,CAAc,kDACA,qCADA,GAEA,kDAFd,EAGc,KAAKZ,OAAL,CAAahE,IAAb,EAAmBxD,MAHjC;AAIA,wBAAI,OAAOkJ,QAAQC,KAAf,KAAyB,UAA7B,EAAyC;AACvC;AACAD,gCAAQC,KAAR;AACD;AACF;AACF;;AAED,mBAAO,IAAP;AACD,SAhDD;;AAkDA/G,qBAAasF,SAAb,CAAuBxG,EAAvB,GAA4BkB,aAAasF,SAAb,CAAuBkB,WAAnD;;AAEAxG,qBAAasF,SAAb,CAAuB0B,IAAvB,GAA8B,UAAS5F,IAAT,EAAeqF,QAAf,EAAyB;AACrD,gBAAI,CAACJ,WAAWI,QAAX,CAAL,EACE,MAAMd,UAAU,6BAAV,CAAN;;AAEF,gBAAIsB,QAAQ,KAAZ;;AAEA,qBAASC,CAAT,GAAa;AACX,qBAAKC,cAAL,CAAoB/F,IAApB,EAA0B8F,CAA1B;;AAEA,oBAAI,CAACD,KAAL,EAAY;AACVA,4BAAQ,IAAR;AACAR,6BAASF,KAAT,CAAe,IAAf,EAAqBL,SAArB;AACD;AACF;;AAEDgB,cAAET,QAAF,GAAaA,QAAb;AACA,iBAAK3H,EAAL,CAAQsC,IAAR,EAAc8F,CAAd;;AAEA,mBAAO,IAAP;AACD,SAnBD;;AAqBA;AACAlH,qBAAasF,SAAb,CAAuB6B,cAAvB,GAAwC,UAAS/F,IAAT,EAAeqF,QAAf,EAAyB;AAC/D,gBAAIW,IAAJ,EAAUC,QAAV,EAAoBzJ,MAApB,EAA4BP,CAA5B;;AAEA,gBAAI,CAACgJ,WAAWI,QAAX,CAAL,EACE,MAAMd,UAAU,6BAAV,CAAN;;AAEF,gBAAI,CAAC,KAAKP,OAAN,IAAiB,CAAC,KAAKA,OAAL,CAAahE,IAAb,CAAtB,EACE,OAAO,IAAP;;AAEFgG,mBAAO,KAAKhC,OAAL,CAAahE,IAAb,CAAP;AACAxD,qBAASwJ,KAAKxJ,MAAd;AACAyJ,uBAAW,CAAC,CAAZ;;AAEA,gBAAID,SAASX,QAAT,IACCJ,WAAWe,KAAKX,QAAhB,KAA6BW,KAAKX,QAAL,KAAkBA,QADpD,EAC+D;AAC7D,uBAAO,KAAKrB,OAAL,CAAahE,IAAb,CAAP;AACA,oBAAI,KAAKgE,OAAL,CAAa+B,cAAjB,EACE,KAAKtE,IAAL,CAAU,gBAAV,EAA4BzB,IAA5B,EAAkCqF,QAAlC;AAEH,aAND,MAMO,IAAIR,SAASmB,IAAT,CAAJ,EAAoB;AACzB,qBAAK/J,IAAIO,MAAT,EAAiBP,MAAM,CAAvB,GAA2B;AACzB,wBAAI+J,KAAK/J,CAAL,MAAYoJ,QAAZ,IACCW,KAAK/J,CAAL,EAAQoJ,QAAR,IAAoBW,KAAK/J,CAAL,EAAQoJ,QAAR,KAAqBA,QAD9C,EACyD;AACvDY,mCAAWhK,CAAX;AACA;AACD;AACF;;AAED,oBAAIgK,WAAW,CAAf,EACE,OAAO,IAAP;;AAEF,oBAAID,KAAKxJ,MAAL,KAAgB,CAApB,EAAuB;AACrBwJ,yBAAKxJ,MAAL,GAAc,CAAd;AACA,2BAAO,KAAKwH,OAAL,CAAahE,IAAb,CAAP;AACD,iBAHD,MAGO;AACLgG,yBAAKE,MAAL,CAAYD,QAAZ,EAAsB,CAAtB;AACD;;AAED,oBAAI,KAAKjC,OAAL,CAAa+B,cAAjB,EACE,KAAKtE,IAAL,CAAU,gBAAV,EAA4BzB,IAA5B,EAAkCqF,QAAlC;AACH;;AAED,mBAAO,IAAP;AACD,SA3CD;;AA6CAzG,qBAAasF,SAAb,CAAuBiC,kBAAvB,GAA4C,UAASnG,IAAT,EAAe;AACzD,gBAAIoG,GAAJ,EAASzB,SAAT;;AAEA,gBAAI,CAAC,KAAKX,OAAV,EACE,OAAO,IAAP;;AAEF;AACA,gBAAI,CAAC,KAAKA,OAAL,CAAa+B,cAAlB,EAAkC;AAChC,oBAAIjB,UAAUtI,MAAV,KAAqB,CAAzB,EACE,KAAKwH,OAAL,GAAe,EAAf,CADF,KAEK,IAAI,KAAKA,OAAL,CAAahE,IAAb,CAAJ,EACH,OAAO,KAAKgE,OAAL,CAAahE,IAAb,CAAP;AACF,uBAAO,IAAP;AACD;;AAED;AACA,gBAAI8E,UAAUtI,MAAV,KAAqB,CAAzB,EAA4B;AAC1B,qBAAK4J,GAAL,IAAY,KAAKpC,OAAjB,EAA0B;AACxB,wBAAIoC,QAAQ,gBAAZ,EAA8B;AAC9B,yBAAKD,kBAAL,CAAwBC,GAAxB;AACD;AACD,qBAAKD,kBAAL,CAAwB,gBAAxB;AACA,qBAAKnC,OAAL,GAAe,EAAf;AACA,uBAAO,IAAP;AACD;;AAEDW,wBAAY,KAAKX,OAAL,CAAahE,IAAb,CAAZ;;AAEA,gBAAIiF,WAAWN,SAAX,CAAJ,EAA2B;AACzB,qBAAKoB,cAAL,CAAoB/F,IAApB,EAA0B2E,SAA1B;AACD,aAFD,MAEO,IAAIA,SAAJ,EAAe;AACpB;AACA,uBAAOA,UAAUnI,MAAjB;AACE,yBAAKuJ,cAAL,CAAoB/F,IAApB,EAA0B2E,UAAUA,UAAUnI,MAAV,GAAmB,CAA7B,CAA1B;AADF;AAED;AACD,mBAAO,KAAKwH,OAAL,CAAahE,IAAb,CAAP;;AAEA,mBAAO,IAAP;AACD,SAtCD;;AAwCApB,qBAAasF,SAAb,CAAuBS,SAAvB,GAAmC,UAAS3E,IAAT,EAAe;AAChD,gBAAIqG,GAAJ;AACA,gBAAI,CAAC,KAAKrC,OAAN,IAAiB,CAAC,KAAKA,OAAL,CAAahE,IAAb,CAAtB,EACEqG,MAAM,EAAN,CADF,KAEK,IAAIpB,WAAW,KAAKjB,OAAL,CAAahE,IAAb,CAAX,CAAJ,EACHqG,MAAM,CAAC,KAAKrC,OAAL,CAAahE,IAAb,CAAD,CAAN,CADG,KAGHqG,MAAM,KAAKrC,OAAL,CAAahE,IAAb,EAAmBkF,KAAnB,EAAN;AACF,mBAAOmB,GAAP;AACD,SATD;;AAWAzH,qBAAasF,SAAb,CAAuBoC,aAAvB,GAAuC,UAAStG,IAAT,EAAe;AACpD,gBAAI,KAAKgE,OAAT,EAAkB;AAChB,oBAAIuC,aAAa,KAAKvC,OAAL,CAAahE,IAAb,CAAjB;;AAEA,oBAAIiF,WAAWsB,UAAX,CAAJ,EACE,OAAO,CAAP,CADF,KAEK,IAAIA,UAAJ,EACH,OAAOA,WAAW/J,MAAlB;AACH;AACD,mBAAO,CAAP;AACD,SAVD;;AAYAoC,qBAAa0H,aAAb,GAA6B,UAASE,OAAT,EAAkBxG,IAAlB,EAAwB;AACnD,mBAAOwG,QAAQF,aAAR,CAAsBtG,IAAtB,CAAP;AACD,SAFD;;AAIA,iBAASiF,UAAT,CAAoBwB,GAApB,EAAyB;AACvB,mBAAO,OAAOA,GAAP,KAAe,UAAtB;AACD;;AAED,iBAASpC,QAAT,CAAkBoC,GAAlB,EAAuB;AACrB,mBAAO,OAAOA,GAAP,KAAe,QAAtB;AACD;;AAED,iBAAS5B,QAAT,CAAkB4B,GAAlB,EAAuB;AACrB,mBAAO,QAAOA,GAAP,yCAAOA,GAAP,OAAe,QAAf,IAA2BA,QAAQ,IAA1C;AACD;;AAED,iBAASzB,WAAT,CAAqByB,GAArB,EAA0B;AACxB,mBAAOA,QAAQ,KAAK,CAApB;AACD;AAEA,KAhT0B,EAgTzB,EAhTyB,CAlWga,EAkpBrb,GAAE,CAAC,UAASzK,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACzC;;AAEA,YAAIoK,SAASvD,OAAOe,SAAP,CAAiByC,cAA9B;AACA,YAAIC,QAAQzD,OAAOe,SAAP,CAAiB2C,QAA7B;;AAEA,YAAIzE,UAAU,SAASA,OAAT,CAAiB0E,GAAjB,EAAsB;AACnC,gBAAI,OAAO3E,MAAMC,OAAb,KAAyB,UAA7B,EAAyC;AACxC,uBAAOD,MAAMC,OAAN,CAAc0E,GAAd,CAAP;AACA;;AAED,mBAAOF,MAAMrK,IAAN,CAAWuK,GAAX,MAAoB,gBAA3B;AACA,SAND;;AAQA,YAAIC,gBAAgB,SAASA,aAAT,CAAuBC,GAAvB,EAA4B;AAC/C,gBAAI,CAACA,GAAD,IAAQJ,MAAMrK,IAAN,CAAWyK,GAAX,MAAoB,iBAAhC,EAAmD;AAClD,uBAAO,KAAP;AACA;;AAED,gBAAIC,oBAAoBP,OAAOnK,IAAP,CAAYyK,GAAZ,EAAiB,aAAjB,CAAxB;AACA,gBAAIE,mBAAmBF,IAAIG,WAAJ,IAAmBH,IAAIG,WAAJ,CAAgBjD,SAAnC,IAAgDwC,OAAOnK,IAAP,CAAYyK,IAAIG,WAAJ,CAAgBjD,SAA5B,EAAuC,eAAvC,CAAvE;AACA;AACA,gBAAI8C,IAAIG,WAAJ,IAAmB,CAACF,iBAApB,IAAyC,CAACC,gBAA9C,EAAgE;AAC/D,uBAAO,KAAP;AACA;;AAED;AACA;AACA,gBAAId,GAAJ;AACA,iBAAKA,GAAL,IAAYY,GAAZ,EAAiB,CAAE,IAAM;;AAEzB,mBAAO,OAAOZ,GAAP,KAAe,WAAf,IAA8BM,OAAOnK,IAAP,CAAYyK,GAAZ,EAAiBZ,GAAjB,CAArC;AACA,SAlBD;;AAoBA3J,eAAOH,OAAP,GAAiB,SAASqC,MAAT,GAAkB;AAClC,gBAAIR,OAAJ,EAAaiJ,IAAb,EAAmBtE,GAAnB,EAAwBuE,IAAxB,EAA8BC,WAA9B,EAA2CC,KAA3C;AACA,gBAAIlE,SAASyB,UAAU,CAAV,CAAb;AACA,gBAAI7I,IAAI,CAAR;AACA,gBAAIO,SAASsI,UAAUtI,MAAvB;AACA,gBAAIgL,OAAO,KAAX;;AAEA;AACA,gBAAI,OAAOnE,MAAP,KAAkB,SAAtB,EAAiC;AAChCmE,uBAAOnE,MAAP;AACAA,yBAASyB,UAAU,CAAV,KAAgB,EAAzB;AACA;AACA7I,oBAAI,CAAJ;AACA;AACD,gBAAIoH,UAAU,IAAV,IAAmB,QAAOA,MAAP,yCAAOA,MAAP,OAAkB,QAAlB,IAA8B,OAAOA,MAAP,KAAkB,UAAvE,EAAoF;AACnFA,yBAAS,EAAT;AACA;;AAED,mBAAOpH,IAAIO,MAAX,EAAmB,EAAEP,CAArB,EAAwB;AACvBkC,0BAAU2G,UAAU7I,CAAV,CAAV;AACA;AACA,oBAAIkC,WAAW,IAAf,EAAqB;AACpB;AACA,yBAAKiJ,IAAL,IAAajJ,OAAb,EAAsB;AACrB2E,8BAAMO,OAAO+D,IAAP,CAAN;AACAC,+BAAOlJ,QAAQiJ,IAAR,CAAP;;AAEA;AACA,4BAAI/D,WAAWgE,IAAf,EAAqB;AACpB;AACA,gCAAIG,QAAQH,IAAR,KAAiBN,cAAcM,IAAd,MAAwBC,cAAclF,QAAQiF,IAAR,CAAtC,CAAjB,CAAJ,EAA4E;AAC3E,oCAAIC,WAAJ,EAAiB;AAChBA,kDAAc,KAAd;AACAC,4CAAQzE,OAAOV,QAAQU,GAAR,CAAP,GAAsBA,GAAtB,GAA4B,EAApC;AACA,iCAHD,MAGO;AACNyE,4CAAQzE,OAAOiE,cAAcjE,GAAd,CAAP,GAA4BA,GAA5B,GAAkC,EAA1C;AACA;;AAED;AACAO,uCAAO+D,IAAP,IAAezI,OAAO6I,IAAP,EAAaD,KAAb,EAAoBF,IAApB,CAAf;;AAED;AACC,6BAZD,MAYO,IAAI,OAAOA,IAAP,KAAgB,WAApB,EAAiC;AACvChE,uCAAO+D,IAAP,IAAeC,IAAf;AACA;AACD;AACD;AACD;AACD;;AAED;AACA,mBAAOhE,MAAP;AACA,SApDD;AAsDC,KAxFO,EAwFN,EAxFM,CAlpBmb,EA0uBrb,GAAE,CAAC,UAASrH,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACzC;AACA;AACA;;AAEA,YAAImL,MAAMzL,QAAQ,WAAR,CAAV;AACA,YAAI0L,QAAQ1L,QAAQ,aAAR,CAAZ;AACA,YAAIoE,QAAQpE,QAAQ,iBAAR,CAAZ;AACA,YAAI2L,UAAU3L,QAAQ,eAAR,CAAd;AACA,YAAI4L,cAAc5L,QAAQ,mBAAR,CAAlB;AACA,YAAI6L,gBAAgBD,YAAYC,aAAhC;;AAEAvL,gBAAQiC,IAAR,GAAeA,IAAf;AACAjC,gBAAQ8D,KAAR,GAAgBA,MAAM+E,KAAtB;AACA7I,gBAAQuH,YAAR,GAAuBzD,MAAM0H,YAA7B;AACAxL,gBAAQqL,OAAR,GAAkBA,OAAlB;AACArL,gBAAQiL,KAAR,GAAgBnH,MAAMmH,KAAtB;;AAEA;AACAjL,gBAAQyL,0BAAR,GAAqC/L,QAAQ,kCAAR,CAArC;AACAM,gBAAQ0L,eAAR,GAA0BhM,QAAQ,uBAAR,CAA1B;AACAM,gBAAQ2L,uBAAR,GAAkCjM,QAAQ,+BAAR,CAAlC;;AAEA,YAAIkM,gBAAgB9H,MAAM8H,aAA1B;AACA,YAAIC,cAAc/H,MAAM+H,WAAxB;;AAEA;;;;;;;;;;;AAWA,iBAAS5J,IAAT,CAAcxC,CAAd,EAAiB6G,CAAjB,EAAoBzE,OAApB,EAA6B;AAC5B,mBAAOiK,cAAcrM,CAAd,EAAiB6G,CAAjB,EAAoB,EAApB,EAAwByF,UAAUlK,OAAV,EAAmB,EAAnB,CAAxB,EAAgDiC,KAAvD;AACA;;AAED;;;;;;;AAOA,iBAASiI,SAAT,CAAmBlK,OAAnB,EAA4BiC,KAA5B,EAAmC;AAClC,gBAAG,QAAOjC,OAAP,yCAAOA,OAAP,OAAmB,QAAtB,EAAgC;AAC/B,uBAAO;AACNiC,2BAAOA,KADD;AAENkI,0BAAMC,OAAOtD,UAAP,EAAmB9G,QAAQmK,IAA3B,EAAiCH,WAAjC,CAFA;AAGNK,iCAAaD,OAAOtD,UAAP,EAAmB9G,QAAQqK,WAA3B,EAAwCC,cAAxC,CAHP;AAINC,gCAAY,EAAEvK,QAAQuK,UAAR,KAAuB,KAAzB;AAJN,iBAAP;AAMA,aAPD,MAOO;AACN,uBAAO;AACNtI,2BAAOA,KADD;AAENkI,0BAAMC,OAAOtD,UAAP,EAAmB9G,OAAnB,EAA4BgK,WAA5B,CAFA;AAGNK,iCAAaC,cAHP;AAINC,gCAAY;AAJN,iBAAP;AAMA;AACD;;AAED;;;;;;;;;AASA,iBAASN,aAAT,CAAuBrM,CAAvB,EAA0B6G,CAA1B,EAA6B1E,IAA7B,EAAmCyK,KAAnC,EAA0C;AACzC,gBAAGxG,MAAMC,OAAN,CAAcrG,CAAd,KAAoBoG,MAAMC,OAAN,CAAcQ,CAAd,CAAvB,EAAyC;AACxC,uBAAOgG,mBAAmB7M,CAAnB,EAAsB6G,CAAtB,EAAyB1E,IAAzB,EAA+ByK,KAA/B,CAAP;AACA;;AAED,gBAAGT,cAAcnM,CAAd,KAAoBmM,cAActF,CAAd,CAAvB,EAAyC;AACxC,uBAAOiG,oBAAoB9M,CAApB,EAAuB6G,CAAvB,EAA0B1E,IAA1B,EAAgCyK,KAAhC,CAAP;AACA;;AAED,mBAAOG,mBAAmB/M,CAAnB,EAAsB6G,CAAtB,EAAyB1E,IAAzB,EAA+ByK,KAA/B,CAAP;AACA;;AAED;;;;;;;;AAQA,iBAASE,mBAAT,CAA6BE,EAA7B,EAAiCC,EAAjC,EAAqC9K,IAArC,EAA2CyK,KAA3C,EAAkD;AACjD,gBAAIvF,OAAOD,OAAOC,IAAP,CAAY4F,EAAZ,CAAX;AACA,gBAAI5I,QAAQuI,MAAMvI,KAAlB;AACA,gBAAInE,CAAJ,EAAOmK,GAAP;;AAEA,iBAAInK,IAAEmH,KAAK5G,MAAL,GAAY,CAAlB,EAAqBP,KAAG,CAAxB,EAA2B,EAAEA,CAA7B,EAAgC;AAC/BmK,sBAAMhD,KAAKnH,CAAL,CAAN;AACA,oBAAIgN,UAAU/K,OAAO,GAAP,GAAa2J,cAAczB,GAAd,CAA3B;AACA,oBAAG2C,GAAG3C,GAAH,MAAY,KAAK,CAApB,EAAuB;AACtBgC,kCAAcW,GAAG3C,GAAH,CAAd,EAAuB4C,GAAG5C,GAAH,CAAvB,EAAgC6C,OAAhC,EAAyCN,KAAzC;AACA,iBAFD,MAEO;AACNvI,0BAAMoF,IAAN,CAAW,EAAEzD,IAAI,KAAN,EAAa7D,MAAM+K,OAAnB,EAA4BC,OAAOF,GAAG5C,GAAH,CAAnC,EAAX;AACA;AACD;;AAEDhD,mBAAOD,OAAOC,IAAP,CAAY2F,EAAZ,CAAP;AACA,iBAAI9M,IAAEmH,KAAK5G,MAAL,GAAY,CAAlB,EAAqBP,KAAG,CAAxB,EAA2B,EAAEA,CAA7B,EAAgC;AAC/BmK,sBAAMhD,KAAKnH,CAAL,CAAN;AACA,oBAAG+M,GAAG5C,GAAH,MAAY,KAAK,CAApB,EAAuB;AACtB,wBAAI3C,IAAIvF,OAAO,GAAP,GAAa2J,cAAczB,GAAd,CAArB;AACA,wBAAGuC,MAAMD,UAAT,EAAqB;AACpBtI,8BAAMoF,IAAN,CAAW,EAAEzD,IAAI,MAAN,EAAc7D,MAAMuF,CAApB,EAAuByF,OAAOH,GAAG3C,GAAH,CAA9B,EAAX;AACA;AACDhG,0BAAMoF,IAAN,CAAW,EAAEzD,IAAI,QAAN,EAAgB7D,MAAMuF,CAAtB,EAAX;AACA;AACD;;AAED,mBAAOkF,KAAP;AACA;;AAED;;;;;;;;AAQA,iBAASC,kBAAT,CAA4BO,EAA5B,EAAgCC,EAAhC,EAAoClL,IAApC,EAA0CyK,KAA1C,EAAiD;AAChD,gBAAIU,SAAS3B,MAAM4B,GAAN,CAAUX,MAAML,IAAhB,EAAsBa,EAAtB,CAAb;AACA,gBAAII,SAAS7B,MAAM4B,GAAN,CAAUX,MAAML,IAAhB,EAAsBc,EAAtB,CAAb;;AAEA,gBAAII,YAAY/B,IAAIgC,OAAJ,CAAYJ,MAAZ,EAAoBE,MAApB,CAAhB;;AAEA,mBAAOG,eAAeP,EAAf,EAAmBC,EAAnB,EAAuBlL,IAAvB,EAA6ByK,KAA7B,EAAoCa,SAApC,CAAP;AACA;;AAED;;;;;;;;;;;AAWA,iBAASE,cAAT,CAAwBP,EAAxB,EAA4BC,EAA5B,EAAgClL,IAAhC,EAAsCyK,KAAtC,EAA6Ca,SAA7C,EAAwD;AACvD,gBAAIG,SAAS,CAAb;AACA,mBAAOlC,IAAImC,MAAJ,CAAW,UAASjB,KAAT,EAAgB5G,EAAhB,EAAoB9F,CAApB,EAAuB4N,CAAvB,EAA0B;AAC3C,oBAAIC,IAAJ,EAAU/E,OAAV;AACA,oBAAI3E,QAAQuI,MAAMvI,KAAlB;AACA,oBAAIqD,IAAIvF,OAAO,GAAP,IAAc2L,IAAIF,MAAlB,CAAR;;AAEA,oBAAI5H,OAAO0F,IAAIsC,MAAf,EAAuB;AACtB;AACAD,2BAAO1J,MAAMA,MAAM5D,MAAN,GAAa,CAAnB,CAAP;AACAuI,8BAAU4D,MAAMH,WAAN,CAAkBqB,CAAlB,EAAqBV,EAArB,CAAV;;AAEA,wBAAGR,MAAMD,UAAT,EAAqB;AACpBtI,8BAAMoF,IAAN,CAAW,EAAEzD,IAAI,MAAN,EAAc7D,MAAMuF,CAApB,EAAuByF,OAAOC,GAAGU,CAAH,CAA9B,EAAqC9E,SAASA,OAA9C,EAAX;AACA;;AAED,wBAAG+E,SAAS,KAAK,CAAd,IAAmBA,KAAK/H,EAAL,KAAY,KAA/B,IAAwC+H,KAAK5L,IAAL,KAAcuF,CAAzD,EAA4D;AAC3DqG,6BAAK/H,EAAL,GAAU,SAAV;AACA+H,6BAAK/E,OAAL,GAAeA,OAAf;AACA,qBAHD,MAGO;AACN3E,8BAAMoF,IAAN,CAAW,EAAEzD,IAAI,QAAN,EAAgB7D,MAAMuF,CAAtB,EAAyBsB,SAASA,OAAlC,EAAX;AACA;;AAED4E,8BAAU,CAAV;AAEA,iBAlBD,MAkBO,IAAI5H,OAAO0F,IAAIuC,GAAf,EAAoB;AAC1B;AACA;AACA5J,0BAAMoF,IAAN,CAAW,EAAEzD,IAAI,KAAN,EAAa7D,MAAMuF,CAAnB,EAAsByF,OAAOE,GAAGnN,CAAH,CAA7B;AACV8I,iCAAS4D,MAAMH,WAAN,CAAkBqB,CAAlB,EAAqBV,EAArB;AADC,qBAAX;;AAIAQ,8BAAU,CAAV;AAEA,iBATM,MASA;AACNvB,kCAAce,GAAGU,CAAH,CAAd,EAAqBT,GAAGnN,CAAH,CAArB,EAA4BwH,CAA5B,EAA+BkF,KAA/B;AACA;;AAED,uBAAOA,KAAP;AAEA,aAtCM,EAsCJA,KAtCI,EAsCGa,SAtCH,CAAP;AAuCA;;AAED;;;;;;;;AAQA,iBAASV,kBAAT,CAA4B/M,CAA5B,EAA+B6G,CAA/B,EAAkC1E,IAAlC,EAAwCyK,KAAxC,EAA+C;AAC9C,gBAAG5M,MAAM6G,CAAT,EAAY;AACX,oBAAG+F,MAAMD,UAAT,EAAqB;AACpBC,0BAAMvI,KAAN,CAAYoF,IAAZ,CAAiB,EAAEzD,IAAI,MAAN,EAAc7D,MAAMA,IAApB,EAA0BgL,OAAOnN,CAAjC,EAAjB;AACA;;AAED4M,sBAAMvI,KAAN,CAAYoF,IAAZ,CAAiB,EAAEzD,IAAI,SAAN,EAAiB7D,MAAMA,IAAvB,EAA6BgL,OAAOtG,CAApC,EAAjB;AACA;;AAED,mBAAO+F,KAAP;AACA;;AAED;;;;;;AAMA,iBAASJ,MAAT,CAAgB0B,SAAhB,EAA2BC,CAA3B,EAA8BC,CAA9B,EAAiC;AAChC,mBAAOF,UAAUC,CAAV,IAAeA,CAAf,GAAmBC,CAA1B;AACA;;AAED;;;;AAIA,iBAAS1B,cAAT,GAA0B;AACzB,mBAAO,KAAK,CAAZ;AACA;;AAED;;;;AAIA,iBAASxD,UAAT,CAAoBiF,CAApB,EAAuB;AACtB,mBAAO,OAAOA,CAAP,KAAa,UAApB;AACA;AAEA,KAlPO,EAkPN,EAAC,oCAAmC,CAApC,EAAsC,iCAAgC,CAAtE,EAAwE,yBAAwB,CAAhG,EAAkG,eAAc,EAAhH,EAAmH,iBAAgB,EAAnI,EAAsI,mBAAkB,EAAxJ,EAA2J,qBAAoB,EAA/K,EAAkL,aAAY,EAA9L,EAlPM,CA1uBmb,EA49BtP,GAAE,CAAC,UAASlO,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACxOG,eAAOH,OAAP,GAAiByL,0BAAjB;;AAEA,iBAASA,0BAAT,CAAoCqC,OAApC,EAA6C;AAC5CjO,kBAAMI,IAAN,CAAW,IAAX;AACA,iBAAK6K,IAAL,GAAY,KAAKD,WAAL,CAAiBC,IAA7B;AACA,iBAAKgD,OAAL,GAAeA,OAAf;AACA,gBAAG,OAAOjO,MAAMkO,iBAAb,KAAmC,UAAtC,EAAkD;AACjDlO,sBAAMkO,iBAAN,CAAwB,IAAxB,EAA8B,KAAKlD,WAAnC;AACA;AACD;;AAEDY,mCAA2B7D,SAA3B,GAAuCf,OAAON,MAAP,CAAc1G,MAAM+H,SAApB,CAAvC;AACA6D,mCAA2B7D,SAA3B,CAAqCiD,WAArC,GAAmDY,0BAAnD;AACC,KAdsM,EAcrM,EAdqM,CA59BoP,EA0+Brb,GAAE,CAAC,UAAS/L,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACzCG,eAAOH,OAAP,GAAiB2L,uBAAjB;;AAEA,iBAASA,uBAAT,CAAiCmC,OAAjC,EAA0C;AACzCjO,kBAAMI,IAAN,CAAW,IAAX;AACA,iBAAK6K,IAAL,GAAY,KAAKD,WAAL,CAAiBC,IAA7B;AACA,iBAAKgD,OAAL,GAAeA,OAAf;AACA,gBAAG,OAAOjO,MAAMkO,iBAAb,KAAmC,UAAtC,EAAkD;AACjDlO,sBAAMkO,iBAAN,CAAwB,IAAxB,EAA8B,KAAKlD,WAAnC;AACA;AACD;;AAEDc,gCAAwB/D,SAAxB,GAAoCf,OAAON,MAAP,CAAc1G,MAAM+H,SAApB,CAApC;AACA+D,gCAAwB/D,SAAxB,CAAkCiD,WAAlC,GAAgDc,uBAAhD;AACC,KAdO,EAcN,EAdM,CA1+Bmb,EAw/Brb,GAAE,CAAC,UAASjM,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACzCG,eAAOH,OAAP,GAAiB0L,eAAjB;;AAEA,iBAASA,eAAT,CAAyBoC,OAAzB,EAAkC;AACjCjO,kBAAMI,IAAN,CAAW,IAAX;AACA,iBAAK6K,IAAL,GAAY,KAAKD,WAAL,CAAiBC,IAA7B;AACA,iBAAKgD,OAAL,GAAeA,OAAf;AACA,gBAAG,OAAOjO,MAAMkO,iBAAb,KAAmC,UAAtC,EAAkD;AACjDlO,sBAAMkO,iBAAN,CAAwB,IAAxB,EAA8B,KAAKlD,WAAnC;AACA;AACD;;AAEDa,wBAAgB9D,SAAhB,GAA4Bf,OAAON,MAAP,CAAc1G,MAAM+H,SAApB,CAA5B;AACA8D,wBAAgB9D,SAAhB,CAA0BiD,WAA1B,GAAwCa,eAAxC;AACC,KAdO,EAcN,EAdM,CAx/Bmb,EAsgCrb,IAAG,CAAC,UAAShM,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC1C;AACA;AACA;;AAEAA,gBAAQgO,IAAR,GAAeA,IAAf;AACAhO,gBAAQiO,IAAR,GAAeA,IAAf;AACAjO,gBAAQgN,GAAR,GAAcA,GAAd;;AAEA;;;;;;AAMA,iBAASgB,IAAT,CAAcJ,CAAd,EAAiBnO,CAAjB,EAAoB;AACnB,gBAAIM,IAAIN,EAAES,MAAV;AACA,gBAAIoG,IAAI,IAAIT,KAAJ,CAAU9F,IAAE,CAAZ,CAAR;AACAuG,cAAE,CAAF,IAAOsH,CAAP;AACA,iBAAI,IAAIjO,IAAE,CAAV,EAAaA,IAAEI,CAAf,EAAkB,EAAEJ,CAApB,EAAuB;AACtB2G,kBAAE3G,IAAE,CAAJ,IAASF,EAAEE,CAAF,CAAT;AACA;;AAED,mBAAO2G,CAAP;AACA;;AAED;;;;;;AAMA,iBAAS2H,IAAT,CAAcxO,CAAd,EAAiB;AAChB,gBAAIM,IAAIN,EAAES,MAAF,GAAS,CAAjB;AACA,gBAAIoG,IAAI,IAAIT,KAAJ,CAAU9F,CAAV,CAAR;AACA,iBAAI,IAAIJ,IAAE,CAAV,EAAaA,IAAEI,CAAf,EAAkB,EAAEJ,CAApB,EAAuB;AACtB2G,kBAAE3G,CAAF,IAAOF,EAAEE,IAAE,CAAJ,CAAP;AACA;;AAED,mBAAO2G,CAAP;AACA;;AAED;;;;;;AAMA,iBAAS0G,GAAT,CAAapN,CAAb,EAAgBH,CAAhB,EAAmB;AAClB,gBAAI6G,IAAI,IAAIT,KAAJ,CAAUpG,EAAES,MAAZ,CAAR;AACA,iBAAI,IAAIP,IAAE,CAAV,EAAaA,IAAGF,EAAES,MAAlB,EAA0B,EAAEP,CAA5B,EAA+B;AAC9B2G,kBAAE3G,CAAF,IAAOC,EAAEH,EAAEE,CAAF,CAAF,CAAP;AACA;AACD,mBAAO2G,CAAP;AACA;AACA,KAvDQ,EAuDP,EAvDO,CAtgCkb,EA6jCrb,IAAG,CAAC,UAAS5G,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC1C;AACA;AACA;;AAEA;;;;;AAKAG,eAAOH,OAAP,GAAiBiL,KAAjB;;AAEA,iBAASA,KAAT,CAAe2C,CAAf,EAAkB;AACjB,gBAAGA,KAAK,IAAL,IAAa,QAAOA,CAAP,yCAAOA,CAAP,OAAa,QAA7B,EAAuC;AACtC,uBAAOA,CAAP;AACA;;AAED,gBAAG/H,MAAMC,OAAN,CAAc8H,CAAd,CAAH,EAAqB;AACpB,uBAAOM,WAAWN,CAAX,CAAP;AACA;;AAED,mBAAOO,YAAYP,CAAZ,CAAP;AACA;;AAED,iBAASM,UAAT,CAAqBN,CAArB,EAAwB;AACvB,gBAAI7N,IAAI6N,EAAE1N,MAAV;AACA,gBAAI2N,IAAI,IAAIhI,KAAJ,CAAU9F,CAAV,CAAR;;AAEA,iBAAK,IAAIJ,IAAI,CAAb,EAAgBA,IAAII,CAApB,EAAuB,EAAEJ,CAAzB,EAA4B;AAC3BkO,kBAAElO,CAAF,IAAOsL,MAAM2C,EAAEjO,CAAF,CAAN,CAAP;AACA;;AAED,mBAAOkO,CAAP;AACA;;AAED,iBAASM,WAAT,CAAsBP,CAAtB,EAAyB;AACxB,gBAAI9G,OAAOD,OAAOC,IAAP,CAAY8G,CAAZ,CAAX;AACA,gBAAIC,IAAI,EAAR;;AAEA,iBAAK,IAAIO,CAAJ,EAAOzO,IAAI,CAAX,EAAcI,IAAI+G,KAAK5G,MAA5B,EAAoCP,IAAII,CAAxC,EAA2C,EAAEJ,CAA7C,EAAgD;AAC/CyO,oBAAItH,KAAKnH,CAAL,CAAJ;AACAkO,kBAAEO,CAAF,IAAOnD,MAAM2C,EAAEQ,CAAF,CAAN,CAAP;AACA;;AAED,mBAAOP,CAAP;AACA;AAEA,KA/CQ,EA+CP,EA/CO,CA7jCkb,EA4mCrb,IAAG,CAAC,UAASnO,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC1C,YAAIsL,cAAc5L,QAAQ,eAAR,CAAlB;;AAEA;;;;;AAKAS,eAAOH,OAAP,GAAiB,SAASqO,YAAT,CAAsB5O,CAAtB,EAAyB6G,CAAzB,EAA4B;AAC5C;AACA,gBAAIgI,OAAOhD,YAAY9H,KAAZ,CAAkB/D,EAAEmC,IAApB,CAAX;AACA,gBAAI2M,QAAQjD,YAAY9H,KAAZ,CAAkB8C,EAAE1E,IAApB,CAAZ;AACA,gBAAI4M,SAASC,oBAAoBH,IAApB,EAA0BC,KAA1B,CAAb;AACA,gBAAIzI,UAAU4I,YAAYJ,IAAZ,EAAkBC,KAAlB,EAAyBC,OAAOtO,MAAhC,CAAd;;AAEA;AACA,gBAAIyO,KAAKC,UAAUnP,CAAV,CAAT;AACA,gBAAIoP,KAAKD,UAAUtI,CAAV,CAAT;;AAEA,gBAAGkI,OAAOtO,MAAP,KAAkB,CAAlB,IAAuB,CAAC4F,OAA3B,EAAoC;AACnC;AACA,uBAAO,CAAC+I,EAAD,EAAKF,EAAL,CAAP;AACA;;AAED,gBAAG7I,OAAH,EAAY;AACX,uBAAOgJ,kBAAkBH,EAAlB,EAAsBL,IAAtB,EAA4BO,EAA5B,EAAgCN,KAAhC,CAAP;AACA,aAFD,MAEO;AACN,uBAAOQ,iBAAiBJ,EAAjB,EAAqBL,IAArB,EAA2BO,EAA3B,EAA+BN,KAA/B,CAAP;AACA;AACD,SArBD;;AAuBA,iBAASQ,gBAAT,CAA0BtP,CAA1B,EAA6B6O,IAA7B,EAAmChI,CAAnC,EAAsCiI,KAAtC,EAA6C;AAC5C,gBAAG9O,EAAEmC,IAAF,KAAW0E,EAAE1E,IAAhB,EAAsB;AACrB,sBAAM,IAAIqG,SAAJ,CAAc,oBAAoBxI,EAAEgG,EAAtB,GAA2B,GAA3B,GAAiCa,EAAEb,EAAnC,GAAwC,8BAAtD,CAAN;AACA;AACD;AACA,mBAAO,CAACa,CAAD,EAAI7G,CAAJ,CAAP;AACA;;AAED;;;;;;;;;AASA,iBAASqP,iBAAT,CAA2BrP,CAA3B,EAA8B6O,IAA9B,EAAoChI,CAApC,EAAuCiI,KAAvC,EAA8C;AAC7C,gBAAGD,KAAKpO,MAAL,KAAgBqO,MAAMrO,MAAzB,EAAiC;AAChC,uBAAO8O,qBAAqBvP,CAArB,EAAwB6O,IAAxB,EAA8BhI,CAA9B,EAAiCiI,KAAjC,CAAP;AACA;;AAED,gBAAID,KAAKpO,MAAL,GAAcqO,MAAMrO,MAAxB,EAAgC;AAC/B;AACAoO,uBAAOW,qBAAqB3I,CAArB,EAAwBiI,KAAxB,EAA+B9O,CAA/B,EAAkC6O,IAAlC,EAAwC,CAAC,CAAzC,CAAP;AACA7O,kBAAEmC,IAAF,GAAS0J,YAAY4D,QAAZ,CAAqB5D,YAAYnF,IAAZ,CAAiBmI,IAAjB,CAArB,CAAT;AACA,aAJD,MAIO;AACN;AACAC,wBAAQU,qBAAqBxP,CAArB,EAAwB6O,IAAxB,EAA8BhI,CAA9B,EAAiCiI,KAAjC,EAAwC,CAAxC,CAAR;AACAjI,kBAAE1E,IAAF,GAAS0J,YAAY4D,QAAZ,CAAqB5D,YAAYnF,IAAZ,CAAiBoI,KAAjB,CAArB,CAAT;AACA;;AAED,mBAAO,CAACjI,CAAD,EAAI7G,CAAJ,CAAP;AACA;;AAED,iBAASiP,WAAT,CAAqBJ,IAArB,EAA2BC,KAA3B,EAAkCY,KAAlC,EAAyC;AACxC,mBAAO7D,YAAY8D,iBAAZ,CAA8Bd,KAAKa,KAAL,CAA9B,KACH7D,YAAY8D,iBAAZ,CAA8Bb,MAAMY,KAAN,CAA9B,CADJ;AAEA;;AAED;;;;;;;;AAQA,iBAASH,oBAAT,CAA8BjP,CAA9B,EAAiCsP,KAAjC,EAAwChQ,CAAxC,EAA2CiQ,KAA3C,EAAkD;;AAEjD,gBAAIvI,SAASsI,MAAMnP,MAAN,GAAa,CAA1B;AACA,gBAAIqP,SAAS,CAACF,MAAMtI,MAAN,CAAd;AACA,gBAAIyI,SAAS,CAACF,MAAMvI,MAAN,CAAd;;AAEA,gBAAI0I,QAAJ;;AAEA,gBAAGF,SAASC,MAAZ,EAAoB;AACnB;AACA,oBAAGzP,EAAE0F,EAAF,KAAS,KAAT,IAAkB1F,EAAE0F,EAAF,KAAS,MAA9B,EAAsC;AACrCgK,+BAAWH,MAAM1G,KAAN,EAAX;AACA6G,6BAAS1I,MAAT,IAAmBnC,KAAK8K,GAAL,CAAS,CAAT,EAAYF,SAAS,CAArB,CAAnB;AACAnQ,sBAAEuC,IAAF,GAAS0J,YAAY4D,QAAZ,CAAqB5D,YAAYnF,IAAZ,CAAiBsJ,QAAjB,CAArB,CAAT;AACA,iBAJD,MAIO,IAAG1P,EAAE0F,EAAF,KAAS,QAAZ,EAAsB;AAC5BgK,+BAAWH,MAAM1G,KAAN,EAAX;AACA6G,6BAAS1I,MAAT,IAAmByI,SAAS,CAA5B;AACAnQ,sBAAEuC,IAAF,GAAS0J,YAAY4D,QAAZ,CAAqB5D,YAAYnF,IAAZ,CAAiBsJ,QAAjB,CAArB,CAAT;AACA;AACD,aAXD,MAWO,IAAGpQ,EAAEoG,EAAF,KAAS,KAAT,IAAkBpG,EAAEoG,EAAF,KAAS,MAA9B,EAAsC;AAC5C;AACAgK,2BAAWJ,MAAMzG,KAAN,EAAX;AACA6G,yBAAS1I,MAAT,IAAmBwI,SAAS,CAA5B;AACAxP,kBAAE6B,IAAF,GAAS0J,YAAY4D,QAAZ,CAAqB5D,YAAYnF,IAAZ,CAAiBsJ,QAAjB,CAArB,CAAT;AACA,aALM,MAKA,IAAIF,SAASC,MAAT,IAAmBnQ,EAAEoG,EAAF,KAAS,QAAhC,EAA0C;AAChD;AACAgK,2BAAWJ,MAAMzG,KAAN,EAAX;AACA6G,yBAAS1I,MAAT,IAAmBnC,KAAK8K,GAAL,CAAS,CAAT,EAAYH,SAAS,CAArB,CAAnB;AACAxP,kBAAE6B,IAAF,GAAS0J,YAAY4D,QAAZ,CAAqB5D,YAAYnF,IAAZ,CAAiBsJ,QAAjB,CAArB,CAAT;AACA;;AAED,mBAAO,CAACpQ,CAAD,EAAIU,CAAJ,CAAP;AACA;;AAED;;;;;;;;;AASA,iBAASkP,oBAAT,CAA8BlP,CAA9B,EAAiCsP,KAAjC,EAAwChQ,CAAxC,EAA2CiQ,KAA3C,EAAkDK,SAAlD,EAA6D;AAC5D;;AAEA,gBAAI5I,SAASsI,MAAMnP,MAAN,GAAa,CAA1B;AACA,gBAAIqP,SAAS,CAACF,MAAMtI,MAAN,CAAd;AACA,gBAAIyI,SAAS,CAACF,MAAMvI,MAAN,CAAd;;AAEA;AACA,gBAAI6I,KAAKN,MAAM1G,KAAN,EAAT;;AAEA,gBAAG2G,SAASC,MAAZ,EAAoB;AACnB,uBAAOI,EAAP;AACA;;AAED,gBAAG7P,EAAE0F,EAAF,KAAS,KAAT,IAAkB1F,EAAE0F,EAAF,KAAS,MAA9B,EAAsC;AACrCmK,mBAAG7I,MAAH,IAAanC,KAAK8K,GAAL,CAAS,CAAT,EAAYF,SAASG,SAArB,CAAb;AACA,aAFD,MAEO,IAAG5P,EAAE0F,EAAF,KAAS,QAAZ,EAAsB;AAC5BmK,mBAAG7I,MAAH,IAAanC,KAAK8K,GAAL,CAAS,CAAT,EAAYF,SAASG,SAArB,CAAb;AACA;;AAED,mBAAOC,EAAP;AACA;;AAED,iBAASnB,mBAAT,CAA6BoB,EAA7B,EAAiCC,EAAjC,EAAqC;AACpC,gBAAIC,MAAMF,GAAG3P,MAAb;AACA,gBAAI8P,MAAMF,GAAG5P,MAAb;AACA,gBAAG6P,QAAQ,CAAR,IAAaC,QAAQ,CAArB,IAA2BD,MAAM,CAAN,IAAWC,MAAM,CAA/C,EAAmD;AAClD,uBAAO,EAAP;AACA;;AAED;AACA;AACA;AACA,gBAAIjQ,IAAIgQ,QAAQC,GAAR,GACLD,MAAM,CADD,GAELnL,KAAKqL,GAAL,CAASF,GAAT,EAAcC,GAAd,CAFH;;AAIA,gBAAIrQ,IAAI,CAAR;AACA,mBAAMA,IAAII,CAAJ,IAAS8P,GAAGlQ,CAAH,MAAUmQ,GAAGnQ,CAAH,CAAzB,EAAgC;AAC/B,kBAAEA,CAAF;AACA;;AAED,mBAAOkQ,GAAGjH,KAAH,CAAS,CAAT,EAAYjJ,CAAZ,CAAP;AACA;;AAED,iBAASiP,SAAT,CAAmBzH,CAAnB,EAAsB;AACrB,gBAAGA,EAAE1B,EAAF,KAAS,QAAZ,EAAsB;AACrB,uBAAO,EAAEA,IAAI0B,EAAE1B,EAAR,EAAY7D,MAAMuF,EAAEvF,IAApB,EAAP;AACA;;AAED,gBAAGuF,EAAE1B,EAAF,KAAS,MAAT,IAAmB0B,EAAE1B,EAAF,KAAS,MAA/B,EAAuC;AACtC,uBAAO,EAAEA,IAAI0B,EAAE1B,EAAR,EAAY7D,MAAMuF,EAAEvF,IAApB,EAA0BsO,MAAM/I,EAAE+I,IAAlC,EAAP;AACA;;AAED;AACA,mBAAO,EAAEzK,IAAI0B,EAAE1B,EAAR,EAAY7D,MAAMuF,EAAEvF,IAApB,EAA0BgL,OAAOzF,EAAEyF,KAAnC,EAAP;AACA;AACA,KAnLQ,EAmLP,EAAC,iBAAgB,EAAjB,EAnLO,CA5mCkb,EA+xCna,IAAG,CAAC,UAASlN,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC5DG,eAAOH,OAAP,GAAiBmQ,UAAjB;;AAEA;;;;;;AAMA,iBAASA,UAAT,CAAoB1Q,CAApB,EAAuB6G,CAAvB,EAA0B;AACzB,gBAAG7G,MAAM6G,CAAT,EAAY;AACX,uBAAO,IAAP;AACA;;AAED,gBAAGT,MAAMC,OAAN,CAAcrG,CAAd,KAAoBoG,MAAMC,OAAN,CAAcQ,CAAd,CAAvB,EAAyC;AACxC,uBAAO8J,cAAc3Q,CAAd,EAAiB6G,CAAjB,CAAP;AACA;;AAED,gBAAG,QAAO7G,CAAP,yCAAOA,CAAP,OAAa,QAAb,IAAyB,QAAO6G,CAAP,yCAAOA,CAAP,OAAa,QAAzC,EAAmD;AAClD,uBAAO+J,eAAe5Q,CAAf,EAAkB6G,CAAlB,CAAP;AACA;;AAED,mBAAO,KAAP;AACA;;AAED,iBAAS8J,aAAT,CAAuB3Q,CAAvB,EAA0B6G,CAA1B,EAA6B;AAC5B,gBAAG7G,EAAES,MAAF,KAAaoG,EAAEpG,MAAlB,EAA0B;AACzB,uBAAO,KAAP;AACA;;AAED,iBAAI,IAAIP,IAAI,CAAZ,EAAeA,IAAEF,EAAES,MAAnB,EAA2B,EAAEP,CAA7B,EAAgC;AAC/B,oBAAG,CAACwQ,WAAW1Q,EAAEE,CAAF,CAAX,EAAiB2G,EAAE3G,CAAF,CAAjB,CAAJ,EAA4B;AAC3B,2BAAO,KAAP;AACA;AACD;;AAED,mBAAO,IAAP;AACA;;AAED,iBAAS0Q,cAAT,CAAwB5Q,CAAxB,EAA2B6G,CAA3B,EAA8B;AAC7B,gBAAI7G,MAAM,IAAN,IAAc6G,MAAM,IAArB,IAA+B7G,MAAM,IAAN,IAAc6G,MAAM,IAAtD,EAA6D;AAC5D,uBAAO,KAAP;AACA;;AAED,gBAAIgK,QAAQzJ,OAAOC,IAAP,CAAYrH,CAAZ,CAAZ;AACA,gBAAI8Q,QAAQ1J,OAAOC,IAAP,CAAYR,CAAZ,CAAZ;;AAEA,gBAAGgK,MAAMpQ,MAAN,KAAiBqQ,MAAMrQ,MAA1B,EAAkC;AACjC,uBAAO,KAAP;AACA;;AAED,iBAAI,IAAIP,IAAI,CAAR,EAAWyO,CAAf,EAAkBzO,IAAE2Q,MAAMpQ,MAA1B,EAAkC,EAAEP,CAApC,EAAuC;AACtCyO,oBAAIkC,MAAM3Q,CAAN,CAAJ;AACA,oBAAG,EAAEyO,KAAK9H,CAAL,IAAU6J,WAAW1Q,EAAE2O,CAAF,CAAX,EAAiB9H,EAAE8H,CAAF,CAAjB,CAAZ,CAAH,EAAwC;AACvC,2BAAO,KAAP;AACA;AACD;;AAED,mBAAO,IAAP;AACA;AACA,KA5D0B,EA4DzB,EA5DyB,CA/xCga,EA21Crb,IAAG,CAAC,UAAS1O,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC1C,YAAIwQ,UAAU9Q,QAAQ,WAAR,CAAd;;AAEAS,eAAOH,OAAP,GAAiB,SAASqL,OAAT,CAAiBlE,CAAjB,EAAoB;AACpC,gBAAIsJ,KAAK,EAAT;AACA,gBAAI9Q,CAAJ,EAAO+Q,IAAP;AACA,iBAAI/Q,IAAIwH,EAAEjH,MAAF,GAAS,CAAjB,EAAoBP,KAAI,CAAxB,EAA2BA,KAAK+Q,IAAhC,EAAsC;AACrCA,uBAAOC,SAASF,EAAT,EAAatJ,EAAExH,CAAF,CAAb,EAAmBA,CAAnB,EAAsBwH,CAAtB,CAAP;AACA;;AAED,mBAAOsJ,EAAP;AACA,SARD;;AAUA,iBAASE,QAAT,CAAkB7M,KAAlB,EAAyB8M,CAAzB,EAA4BjR,CAA5B,EAA+B8I,OAA/B,EAAwC;AACvC,gBAAIhD,KAAK+K,QAAQI,EAAEnL,EAAV,CAAT;AACA,mBAAOA,OAAO,KAAK,CAAZ,IAAiB,OAAOA,GAAG4F,OAAV,KAAsB,UAAvC,GACJ5F,GAAG4F,OAAH,CAAWvH,KAAX,EAAkB8M,CAAlB,EAAqBjR,CAArB,EAAwB8I,OAAxB,CADI,GAEJ,CAFH;AAGA;AAEA,KApBQ,EAoBP,EAAC,aAAY,EAAb,EApBO,CA31Ckb,EA+2Cva,IAAG,CAAC,UAAS/I,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACxD;AACA;AACA;;AAEA,YAAIwQ,UAAU9Q,QAAQ,WAAR,CAAd;AACA,YAAIuL,QAAQvL,QAAQ,SAAR,CAAZ;AACA,YAAI+L,6BAA6B/L,QAAQ,8BAAR,CAAjC;;AAEAM,gBAAQ6I,KAAR,GAAgB/E,KAAhB;AACA9D,gBAAQwL,YAAR,GAAuBjE,YAAvB;AACAvH,gBAAQiL,KAAR,GAAgBA,KAAhB;AACAjL,gBAAQ4L,aAAR,GAAwBA,aAAxB;AACA5L,gBAAQ6L,WAAR,GAAsBA,WAAtB;;AAEA,YAAIgF,iBAAiB,EAArB;;AAEA;;;;;;;;;;;;AAYA,iBAAS/M,KAAT,CAAe5B,OAAf,EAAwB0L,CAAxB,EAA2B/L,OAA3B,EAAoC;AACnC,mBAAO0F,aAAarF,OAAb,EAAsB+I,MAAM2C,CAAN,CAAtB,EAAgC/L,OAAhC,CAAP;AACA;;AAED,iBAAS0F,YAAT,CAAsBrF,OAAtB,EAA+B0L,CAA/B,EAAkC/L,OAAlC,EAA2C;AAC1C,gBAAG,CAACA,OAAJ,EAAa;AACZA,0BAAUgP,cAAV;AACA;;AAED;AACA,gBAAG,CAAChL,MAAMC,OAAN,CAAc5D,OAAd,CAAJ,EAA4B;AAC3B,uBAAO0L,CAAP;AACA;;AAED,gBAAI9J,KAAJ,EAAWqD,CAAX;AACA,iBAAI,IAAIxH,IAAE,CAAV,EAAaA,IAAEuC,QAAQhC,MAAvB,EAA+B,EAAEP,CAAjC,EAAoC;AACnCwH,oBAAIjF,QAAQvC,CAAR,CAAJ;AACAmE,wBAAQ0M,QAAQrJ,EAAE1B,EAAV,CAAR;;AAEA,oBAAG3B,UAAU,KAAK,CAAlB,EAAqB;AACpB,0BAAM,IAAI2H,0BAAJ,CAA+B,gBAAgBlI,KAAKyB,SAAL,CAAemC,CAAf,CAA/C,CAAN;AACA;;AAEDyG,oBAAI9J,MAAM+E,KAAN,CAAY+E,CAAZ,EAAezG,CAAf,EAAkBtF,OAAlB,CAAJ;AACA;;AAED,mBAAO+L,CAAP;AACA;;AAED,iBAAS/B,WAAT,CAAqB+B,CAArB,EAAwB;AACvB,mBAAOhC,cAAcgC,CAAd,KAAoB9H,QAAQ8H,CAAR,CAApB,GAAiCrK,KAAKyB,SAAL,CAAe4I,CAAf,CAAjC,GAAqDA,CAA5D;AACA;;AAED,iBAAShC,aAAT,CAAwBgC,CAAxB,EAA2B;AAC1B,mBAAOA,MAAM,IAAN,IAAc/G,OAAOe,SAAP,CAAiB2C,QAAjB,CAA0BtK,IAA1B,CAA+B2N,CAA/B,MAAsC,iBAA3D;AACA;;AAED,iBAAS9H,OAAT,CAAkB8H,CAAlB,EAAqB;AACpB,mBAAO/G,OAAOe,SAAP,CAAiB2C,QAAjB,CAA0BtK,IAA1B,CAA+B2N,CAA/B,MAAsC,gBAA7C;AACA;AAEA,KAtEsB,EAsErB,EAAC,gCAA+B,CAAhC,EAAkC,WAAU,EAA5C,EAA+C,aAAY,EAA3D,EAtEqB,CA/2Coa,EAq7CzX,IAAG,CAAC,UAASlO,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACtG;AACA;AACA;;AAEA,YAAI8Q,SAASpR,QAAQ,oBAAR,CAAb;;AAEAM,gBAAQ+Q,IAAR,GAAeA,IAAf;AACA/Q,gBAAQmG,IAAR,GAAeA,IAAf;AACAnG,gBAAQkP,QAAR,GAAmBA,QAAnB;AACAlP,gBAAQwD,KAAR,GAAgBA,KAAhB;AACAxD,gBAAQgR,QAAR,GAAmBA,QAAnB;AACAhR,gBAAQuL,aAAR,GAAwBA,aAAxB;AACAvL,gBAAQiR,aAAR,GAAwBA,aAAxB;AACAjR,gBAAQkR,eAAR,GAA0BA,eAA1B;AACAlR,gBAAQoP,iBAAR,GAA4BA,iBAA5B;;AAEA;AACA,YAAI+B,YAAY,GAAhB;AACA,YAAIC,cAAc,KAAlB;AACA,YAAIC,mBAAmB,IAAvB;AACA,YAAIC,qBAAqB,KAAzB;;AAEA,YAAIC,aAAa,GAAjB;AACA,YAAIC,WAAW,IAAf;AACA,YAAIC,gBAAgB,IAApB;AACA,YAAIC,kBAAkB,KAAtB;;AAEA;;;;;;;;;;;;;;AAcA,iBAASX,IAAT,CAAcnD,CAAd,EAAiBhM,IAAjB,EAAuB+P,WAAvB,EAAoClJ,OAApC,EAA6C;AAC5C,gBAAG,OAAO7G,IAAP,KAAgB,QAAnB,EAA6B;AAC5B;AACA;;AAED,gBAAGA,SAAS,EAAZ,EAAgB;AACf;AACA,uBAAO,EAAEmF,QAAQ6G,CAAV,EAAa9D,KAAK,KAAK,CAAvB,EAAP;AACA;;AAED,gBAAGlI,SAASuP,SAAZ,EAAuB;AACtB,uBAAO,EAAEpK,QAAQ6G,CAAV,EAAa9D,KAAK,EAAlB,EAAP;AACA;;AAED,gBAAI8H,SAAShE,CAAb;AAAA,gBAAgB9D,GAAhB;AACA,gBAAI+H,aAAapJ,YAAY,KAAK,CAAlC;;AAEAqI,mBAAOlP,IAAP,EAAa,UAASkQ,OAAT,EAAkB;AAC9B;AACA,oBAAGlE,KAAK,IAAR,EAAc;AACb;AACAgE,6BAAS,IAAT;AACA,2BAAO,KAAP;AACA;;AAED,oBAAG/L,MAAMC,OAAN,CAAc8H,CAAd,CAAH,EAAqB;AACpB9D,0BAAM+H,aACHE,UAAUJ,WAAV,EAAuBT,gBAAgBY,OAAhB,CAAvB,EAAiDlE,CAAjD,EAAoDnF,OAApD,CADG,GAEHqJ,YAAY,GAAZ,GAAkBA,OAAlB,GAA4BZ,gBAAgBY,OAAhB,CAF/B;AAGA,iBAJD,MAIO;AACNhI,0BAAMgI,OAAN;AACA;;AAEDF,yBAAShE,CAAT;AACAA,oBAAIA,EAAE9D,GAAF,CAAJ;AACA,aAlBD;;AAoBA,mBAAO8H,WAAW,IAAX,GACJ,KAAK,CADD,GAEJ,EAAE7K,QAAQ6K,MAAV,EAAkB9H,KAAKA,GAAvB,EAFH;AAGA;;AAED,iBAASoF,QAAT,CAAkBtN,IAAlB,EAAwB;AACvB,mBAAOA,KAAK,CAAL,MAAYuP,SAAZ,GAAwBvP,IAAxB,GAA+BuP,YAAYvP,IAAlD;AACA;;AAED,iBAASuE,IAAT,CAAc6L,QAAd,EAAwB;AACvB,mBAAOA,SAAS7L,IAAT,CAAcgL,SAAd,CAAP;AACA;;AAED,iBAAS3N,KAAT,CAAe5B,IAAf,EAAqB;AACpB,gBAAIoQ,WAAW,EAAf;AACAlB,mBAAOlP,IAAP,EAAaoQ,SAAS9I,IAAT,CAAc+I,IAAd,CAAmBD,QAAnB,CAAb;AACA,mBAAOA,QAAP;AACA;;AAED,iBAAShB,QAAT,CAAkBvR,CAAlB,EAAqB6G,CAArB,EAAwB;AACvB,mBAAOA,EAAE4L,OAAF,CAAUzS,CAAV,MAAiB,CAAjB,IAAsB6G,EAAE7G,EAAES,MAAJ,MAAgBiR,SAA7C;AACA;;AAED;;;;;;AAMA,iBAASF,aAAT,CAAuB3R,CAAvB,EAA0B;AACzB;AACA,mBAAOA,EAAEyG,OAAF,CAAUuL,kBAAV,EAA8BH,SAA9B,EAAyCpL,OAAzC,CAAiD2L,eAAjD,EAAkEH,UAAlE,CAAP;AACA;;AAED;;;;;;AAMA,iBAAShG,aAAT,CAAuBjM,CAAvB,EAA0B;AACzB,mBAAOA,EAAEyG,OAAF,CAAUyL,QAAV,EAAoBC,aAApB,EAAmC1L,OAAnC,CAA2CqL,WAA3C,EAAwDC,gBAAxD,CAAP;AACA;;AAED,YAAIc,eAAe,gBAAnB;;AAEA;;;;;AAKA,iBAAS/C,iBAAT,CAA2B9P,CAA3B,EAA8B;AAC7B,mBAAO6S,aAAaC,IAAb,CAAkB9S,CAAlB,CAAP;AACA;;AAED;;;;;AAKA,iBAAS4R,eAAT,CAA0B5R,CAA1B,EAA6B;AAC5B,gBAAG8P,kBAAkB9P,CAAlB,CAAH,EAAyB;AACxB,uBAAO,CAACA,CAAR;AACA;;AAED,kBAAM,IAAI+S,WAAJ,CAAgB,yBAAyB/S,CAAzC,CAAN;AACA;;AAED,iBAASyS,SAAT,CAAoBJ,WAApB,EAAiCW,KAAjC,EAAwClH,KAAxC,EAA+C3C,OAA/C,EAAwD;AACvD,gBAAI0G,QAAQmD,KAAZ;;AAEA,gBAAGnD,QAAQ,CAAX,EAAc;AACb,sBAAM,IAAItP,KAAJ,CAAU,+BAA+BsP,KAAzC,CAAN;AACA;;AAED,gBAAG1G,YAAY,KAAK,CAAjB,IAAsB,OAAOkJ,WAAP,KAAuB,UAAhD,EAA4D;AAC3DxC,wBAAQwC,YAAYW,KAAZ,EAAmBlH,KAAnB,EAA0B3C,OAA1B,CAAR;AACA,oBAAG0G,QAAQ,CAAX,EAAc;AACb,0BAAM,IAAItP,KAAJ,CAAU,kCAAkC4I,OAA5C,CAAN;AACA;AACD;;AAED,mBAAO0G,KAAP;AACA;AACA,KAnKoE,EAmKnE,EAAC,sBAAqB,EAAtB,EAnKmE,CAr7CsX,EAwlD9Z,IAAG,CAAC,UAASzP,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACjE;AACA;AACA;;AAEAG,eAAOH,OAAP,GAAiBuS,gBAAjB;;AAEA,YAAIC,UAAU,WAAd;AACA,YAAIrB,YAAY,GAAhB;AACA,YAAII,aAAa,GAAjB;AACA,YAAIF,mBAAmB,IAAvB;;AAEA;;;;;;;;AAQA,iBAASkB,gBAAT,CAA0B3Q,IAA1B,EAAgC6Q,SAAhC,EAA2C;AAC1C,gBAAIC,GAAJ,EAASC,KAAT,EAAgBC,OAAhB,EAAyBC,KAAzB;;AAEAH,kBAAM9Q,KAAKkR,MAAL,CAAY,CAAZ,MAAmB3B,SAAnB,GAA+B,CAA/B,GAAmC,CAAzC;AACAwB,oBAAQ,EAAR;AACAH,oBAAQO,SAAR,GAAoBL,GAApB;;AAEA,mBAAME,UAAUJ,QAAQQ,IAAR,CAAapR,IAAb,CAAhB,EAAoC;;AAEnCiR,wBAAQD,QAAQ,CAAR,CAAR;AACAD,yBAAS/Q,KAAKgH,KAAL,CAAW8J,GAAX,EAAgBF,QAAQO,SAAR,GAAoBF,MAAM3S,MAA1C,CAAT;AACAwS,sBAAMF,QAAQO,SAAd;;AAEA,oBAAGF,UAAU1B,SAAb,EAAwB;AACvB,wBAAIsB,UAAUE,KAAV,MAAqB,KAAzB,EAAgC,OAAO/Q,IAAP;AAChC+Q,4BAAQ,EAAR;AACA,iBAHD,MAGO;AACNA,6BAASE,UAAUxB,gBAAV,GAA6BF,SAA7B,GAAyCI,UAAlD;AACA;AACD;;AAEDoB,qBAAS/Q,KAAKgH,KAAL,CAAW8J,GAAX,CAAT;AACAD,sBAAUE,KAAV;;AAEA,mBAAO/Q,IAAP;AACA;AAEA,KA/C+B,EA+C9B,EA/C8B,CAxlD2Z,EAuoDrb,IAAG,CAAC,UAASlC,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC1C;AACA;AACA;;AAEAA,gBAAQmN,OAAR,GAAkBA,OAAlB;AACAnN,gBAAQsN,MAAR,GAAiBA,MAAjB;;AAEA,YAAIG,MAAJ,EAAYwF,KAAZ,EAAmBvF,GAAnB,EAAwBwF,IAAxB,EAA8BC,IAA9B;;AAEAnT,gBAAQyN,MAAR,GAAiBA,SAASwF,QAAQ,CAAC,CAAnC;AACAjT,gBAAQ0N,GAAR,GAAiBA,MAASwF,OAAS,CAAnC;AACAlT,gBAAQoT,KAAR,GAAiBD,OAAS,CAA1B;;AAEA;;;;;;;AAOA,iBAAShG,OAAT,CAAiB1N,CAAjB,EAAoB6G,CAApB,EAAuB;AACtB,gBAAI+M,OAAO5T,EAAES,MAAb;AACA,gBAAIoT,OAAOhN,EAAEpG,MAAb;;AAEA,gBAAIsO,SAAS+E,WAAW9T,CAAX,EAAc6G,CAAd,CAAb;AACA,gBAAIkN,SAAShF,SAAS6E,IAAT,IAAiB7E,SAAS8E,IAA1B,GACVG,WAAWhU,CAAX,EAAc6G,CAAd,EAAiBkI,MAAjB,CADU,GAEV,CAFH;;AAIA,gBAAIkF,SAASF,SAAShF,MAAT,GAAkB,CAA/B;AACA6E,oBAAQK,MAAR;AACAJ,oBAAQI,MAAR;AACA,gBAAIC,SAASC,aAAaP,IAAb,EAAmBC,IAAnB,CAAb;;AAEA,iBAAK,IAAI/F,IAAI8F,OAAO,CAApB,EAAuB9F,KAAK,CAA5B,EAA+B,EAAEA,CAAjC,EAAoC;AACnC,qBAAK,IAAI5N,IAAI2T,OAAO,CAApB,EAAuB3T,KAAK,CAA5B,EAA+B,EAAEA,CAAjC,EAAoC;AACnCgU,2BAAOhU,CAAP,EAAU4N,CAAV,IAAesG,UAAUF,MAAV,EAAkBlU,CAAlB,EAAqB6G,CAArB,EAAwBkI,MAAxB,EAAgCjB,CAAhC,EAAmC5N,CAAnC,CAAf;AACA;AACD;;AAED,mBAAO;AACN6O,wBAAQA,MADF;AAENmF,wBAAQA,MAFF;AAGNH,wBAAQA;AAHF,aAAP;AAKA;;AAED;;;;;;;;;;;;AAYA,iBAASlG,MAAT,CAAgB1N,CAAhB,EAAmBP,CAAnB,EAAsB8L,GAAtB,EAA2B;AAC1B,gBAAIxL,CAAJ,EAAO4N,CAAP,EAAUa,CAAV,EAAa3I,EAAb;;AAEA,gBAAIuD,IAAImC,IAAIwI,MAAZ;;AAEA;AACA,gBAAI5T,IAAIoL,IAAIqD,MAAZ;AACA,iBAAI7O,IAAI,CAAR,EAAUA,IAAII,CAAd,EAAiB,EAAEJ,CAAnB,EAAsB;AACrBN,oBAAIO,EAAEP,CAAF,EAAK8T,IAAL,EAAWxT,CAAX,EAAcA,CAAd,CAAJ;AACA;;AAED;AACAyO,gBAAIzO,CAAJ;AACAI,gBAAIiJ,EAAE9I,MAAN;AACAP,gBAAI,CAAJ;AACA4N,gBAAI,CAAJ;AACA,mBAAM5N,IAAII,CAAV,EAAa;AACZ0F,qBAAKuD,EAAErJ,CAAF,EAAK4N,CAAL,EAAQ7J,IAAb;AACArE,oBAAIO,EAAEP,CAAF,EAAKoG,EAAL,EAAS9F,IAAEyO,CAAX,EAAcb,IAAEa,CAAhB,CAAJ;;AAEA,wBAAO3I,EAAP;AACC,yBAAK0N,IAAL;AAAY,0BAAExT,CAAF,CAAK,EAAE4N,CAAF,CAAK;AACtB,yBAAK0F,KAAL;AAAY,0BAAE1F,CAAF,CAAK;AACjB,yBAAK2F,IAAL;AAAY,0BAAEvT,CAAF,CAAK;AAHlB;AAKA;;AAED;AACAA,iBAAKyO,CAAL;AACAb,iBAAKa,CAAL;AACArO,gBAAIoL,IAAIqI,MAAR;AACA,iBAAIpF,IAAI,CAAR,EAAUA,IAAIrO,CAAd,EAAiB,EAAEqO,CAAnB,EAAsB;AACrB/O,oBAAIO,EAAEP,CAAF,EAAK8T,IAAL,EAAWxT,IAAEyO,CAAb,EAAgBb,IAAEa,CAAlB,CAAJ;AACA;;AAED,mBAAO/O,CAAP;AACA;;AAED,iBAASkU,UAAT,CAAoB9T,CAApB,EAAuB6G,CAAvB,EAA0B;AACzB,gBAAI3G,IAAI,CAAR;AACA,gBAAII,IAAI6E,KAAKqL,GAAL,CAASxQ,EAAES,MAAX,EAAmBoG,EAAEpG,MAArB,CAAR;AACA,mBAAMP,IAAII,CAAJ,IAASN,EAAEE,CAAF,MAAS2G,EAAE3G,CAAF,CAAxB,EAA8B;AAC7B,kBAAEA,CAAF;AACA;AACD,mBAAOA,CAAP;AACA;;AAED,iBAAS8T,UAAT,CAAoBhU,CAApB,EAAuB6G,CAAvB,EAA0B;AACzB,gBAAIwN,KAAKrU,EAAES,MAAF,GAAW,CAApB;AACA,gBAAI6T,KAAKzN,EAAEpG,MAAF,GAAW,CAApB;AACA,gBAAIH,IAAI6E,KAAKqL,GAAL,CAAS6D,EAAT,EAAaC,EAAb,CAAR;AACA,gBAAIpU,IAAI,CAAR;AACA,mBAAMA,IAAII,CAAJ,IAASN,EAAEqU,KAAGnU,CAAL,MAAY2G,EAAEyN,KAAGpU,CAAL,CAA3B,EAAoC;AACnC,kBAAEA,CAAF;AACA;AACD,mBAAOA,CAAP;AACA;;AAED,iBAASkU,SAAT,CAAmBF,MAAnB,EAA2BlU,CAA3B,EAA8B6G,CAA9B,EAAiCgM,KAAjC,EAAwC/E,CAAxC,EAA2C5N,CAA3C,EAA8C;AAC7C,gBAAIF,EAAE8N,IAAE+E,KAAJ,MAAehM,EAAE3G,IAAE2S,KAAJ,CAAnB,EAA+B;AAC9B,uBAAO,EAAE1F,OAAO+G,OAAOhU,IAAI,CAAX,EAAc4N,IAAI,CAAlB,EAAqBX,KAA9B,EAAqClJ,MAAMyP,IAA3C,EAAP;AACA;AACD,gBAAIQ,OAAOhU,CAAP,EAAU4N,IAAI,CAAd,EAAiBX,KAAjB,GAAyB+G,OAAOhU,IAAI,CAAX,EAAc4N,CAAd,EAAiBX,KAA9C,EAAqD;AACpD,uBAAO,EAAEA,OAAO+G,OAAOhU,CAAP,EAAU4N,IAAI,CAAd,EAAiBX,KAAjB,GAAyB,CAAlC,EAAqClJ,MAAMuP,KAA3C,EAAP;AACA;;AAED,mBAAO,EAAErG,OAAO+G,OAAOhU,IAAI,CAAX,EAAc4N,CAAd,EAAiBX,KAAjB,GAAyB,CAAlC,EAAqClJ,MAAMwP,IAA3C,EAAP;AACA;;AAED,iBAASU,YAAT,CAAuBP,IAAvB,EAA6BC,IAA7B,EAAmC;AAClC,gBAAItK,IAAI,EAAR;AAAA,gBAAYrJ,CAAZ;AAAA,gBAAe4N,CAAf;AAAA,gBAAkByG,OAAlB;;AAEA;AACAA,sBAAUhL,EAAEsK,IAAF,IAAU,EAApB;AACA,iBAAK/F,IAAI,CAAT,EAAYA,IAAE8F,IAAd,EAAoB,EAAE9F,CAAtB,EAAyB;AACxByG,wBAAQzG,CAAR,IAAa,EAAEX,OAAOyG,OAAO9F,CAAhB,EAAmB7J,MAAMuP,KAAzB,EAAb;AACA;;AAED;AACA,iBAAKtT,IAAI,CAAT,EAAYA,IAAE2T,IAAd,EAAoB,EAAE3T,CAAtB,EAAyB;AACxBqJ,kBAAErJ,CAAF,IAAO,EAAP;AACAqJ,kBAAErJ,CAAF,EAAK0T,IAAL,IAAa,EAAEzG,OAAO0G,OAAO3T,CAAhB,EAAmB+D,MAAMwP,IAAzB,EAAb;AACA;;AAED;AACAlK,cAAEsK,IAAF,EAAQD,IAAR,IAAgB,EAAEzG,OAAO,CAAT,EAAYlJ,MAAMyP,IAAlB,EAAhB;;AAEA,mBAAOnK,CAAP;AACA;AAEA,KAtJQ,EAsJP,EAtJO,CAvoDkb,EA6xDrb,IAAG,CAAC,UAAStJ,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC1C,YAAIsL,cAAc5L,QAAQ,eAAR,CAAlB;AACA,YAAIuL,QAAQvL,QAAQ,SAAR,CAAZ;AACA,YAAIyQ,aAAazQ,QAAQ,cAAR,CAAjB;AACA,YAAI2O,eAAe3O,QAAQ,gBAAR,CAAnB;;AAEA,YAAI0L,QAAQ1L,QAAQ,SAAR,CAAZ;;AAEA,YAAIgM,kBAAkBhM,QAAQ,mBAAR,CAAtB;AACA,YAAI+L,6BAA6B/L,QAAQ,8BAAR,CAAjC;AACA,YAAIiM,0BAA0BjM,QAAQ,2BAAR,CAA9B;;AAEA,YAAIqR,OAAOzF,YAAYyF,IAAvB;AACA,YAAIG,kBAAkB5F,YAAY4F,eAAlC;;AAEAlR,gBAAQoS,IAAR,GAAe;AACdvJ,mBAAOoL,SADO;AAEd5I,qBAAS6I,UAFK;AAGdC,qBAASC;AAHK,SAAf;;AAMApU,gBAAQqU,GAAR,GAAc;AACbxL,mBAAOyL,QADM;AAEbjJ,qBAASkJ,SAFI;AAGbJ,qBAASK;AAHI,SAAd;;AAMAxU,gBAAQ0T,MAAR,GAAiB;AAChB7K,mBAAO4L,WADS;AAEhBpJ,qBAASqJ,YAFO;AAGhBP,qBAASQ;AAHO,SAAjB;;AAMA3U,gBAAQ+F,OAAR,GAAkB;AACjB8C,mBAAO+L,YADU;AAEjBvJ,qBAASwJ,aAFQ;AAGjBV,qBAASW;AAHQ,SAAlB;;AAMA9U,gBAAQ+U,IAAR,GAAe;AACdlM,mBAAOmM,SADO;AAEd3J,qBAAS4J,UAFK;AAGdd,qBAASe;AAHK,SAAf;;AAMAlV,gBAAQ+K,IAAR,GAAe;AACdlC,mBAAOsM,SADO;AAEd9J,qBAAS+J,aAFK;AAGdjB,qBAASK;AAHK,SAAf;;AAMA;;;;;;;AAOA,iBAASP,SAAT,CAAmBrG,CAAnB,EAAsBwE,IAAtB,EAA4BvQ,OAA5B,EAAqC;AACpC,gBAAIwT,UAAUtE,KAAKnD,CAAL,EAAQwE,KAAKxQ,IAAb,EAAmBC,QAAQ8P,WAA3B,EAAwCS,KAAK3J,OAA7C,CAAd;AACA,gBAAI1B,SAASsO,QAAQtO,MAArB;AACA,gBAAIoI,KAAJ,EAAWvC,KAAX;;AAEA,gBAAG/G,MAAMC,OAAN,CAAciB,MAAd,CAAH,EAA0B;AACzBoI,wBAAQ+B,gBAAgBmE,QAAQvL,GAAxB,CAAR;AACA;AACA8C,wBAAQ7F,OAAOoI,KAAP,CAAR;AACA,aAJD,MAIO;AACNvC,wBAAQyI,QAAQvL,GAAR,KAAgB,KAAK,CAArB,GAAyBuL,QAAQtO,MAAjC,GAA0CsO,QAAQtO,MAAR,CAAesO,QAAQvL,GAAvB,CAAlD;AACA;;AAED,gBAAG,CAACqG,WAAWvD,KAAX,EAAkBwF,KAAKxF,KAAvB,CAAJ,EAAmC;AAClC,sBAAM,IAAIlB,eAAJ,CAAoB,iBAAiBnI,KAAKyB,SAAL,CAAeoN,IAAf,CAArC,CAAN;AACA;;AAED,mBAAOxE,CAAP;AACA;;AAED;;;;;;AAMA,iBAASsG,UAAT,CAAoBzD,EAApB,EAAwB2B,IAAxB,EAA8B;AAC7B3B,eAAGvH,IAAH,CAAQkJ,IAAR;AACA,mBAAO,CAAP;AACA;;AAED,iBAASgC,WAAT,CAAqBhC,IAArB,EAA2B9L,CAA3B,EAA8B;AAC7B,gBAAG8L,KAAKxQ,IAAL,KAAc0E,EAAE1E,IAAhB,IAAwB0E,EAAEb,EAAF,KAAS,QAApC,EAA8C;AAC7C,sBAAM,IAAIwC,SAAJ,CAAc,yDAAd,CAAN;AACA;;AAED,gBAAG3B,EAAEb,EAAF,KAAS,MAAT,IAAmBa,EAAEb,EAAF,KAAS,SAA/B,EAA0C;AACzC,uBAAO,CAACa,CAAD,EAAI8L,IAAJ,CAAP;AACA;;AAED,mBAAO/D,aAAa+D,IAAb,EAAmB9L,CAAnB,CAAP;AACA;;AAED;;;;;AAKA,iBAASgO,QAAT,CAAkB1G,CAAlB,EAAqBnG,MAArB,EAA6B5F,OAA7B,EAAsC;AACrC,gBAAIwT,UAAUtE,KAAKnD,CAAL,EAAQnG,OAAO7F,IAAf,EAAqBC,QAAQ8P,WAA7B,EAA0ClK,OAAOgB,OAAjD,CAAd;;AAEA,gBAAG6M,SAASD,OAAT,CAAH,EAAsB;AACrB,sBAAM,IAAI5J,0BAAJ,CAA+B,yBAAyBhE,OAAO7F,IAA/D,CAAN;AACA;;AAED,gBAAG6F,OAAOmF,KAAP,KAAiB,KAAK,CAAzB,EAA4B;AAC3B,sBAAM,IAAInB,0BAAJ,CAA+B,eAA/B,CAAN;AACA;;AAED,gBAAIhF,MAAMwE,MAAMxD,OAAOmF,KAAb,CAAV;;AAEA;AACA,gBAAGyI,QAAQvL,GAAR,KAAgB,KAAK,CAAxB,EAA2B;AAC1B,uBAAOrD,GAAP;AACA;;AAED8O,iBAAKF,OAAL,EAAc5O,GAAd;AACA,mBAAOmH,CAAP;AACA;;AAED,iBAAS2H,IAAT,CAAcF,OAAd,EAAuBzI,KAAvB,EAA8B;AAC7B,gBAAI7F,SAASsO,QAAQtO,MAArB;;AAEA,gBAAGlB,MAAMC,OAAN,CAAciB,MAAd,CAAH,EAA0B;AACzB;AACA,oBAAGsO,QAAQvL,GAAR,KAAgB,GAAnB,EAAwB;AACvB/C,2BAAOmC,IAAP,CAAY0D,KAAZ;AACA,iBAFD,MAEO,IAAIyI,QAAQvL,GAAR,GAAc/C,OAAO7G,MAAzB,EAAiC;AACvC,0BAAM,IAAIuL,0BAAJ,CAA+B,uCAA/B,CAAN;AACA,iBAFM,MAEA;AACN1E,2BAAO6C,MAAP,CAAcyL,QAAQvL,GAAtB,EAA2B,CAA3B,EAA8B8C,KAA9B;AACA;AACD,aATD,MASO,IAAGhB,cAAc7E,MAAd,CAAH,EAA0B;AAChCA,uBAAOsO,QAAQvL,GAAf,IAAsB8C,KAAtB;AACA,aAFM,MAEA;AACN,sBAAM,IAAInB,0BAAJ,CAA+B,8CAA8C4J,QAAQvL,GAArF,CAAN;AACA;AACD;;AAED,iBAASyK,SAAT,CAAmB9D,EAAnB,EAAuB4D,GAAvB,EAA4B;AAC3B,gBAAI5L,UAAU4L,IAAI5L,OAAlB;AACA,gBAAGA,YAAY,KAAK,CAApB,EAAuB;AACtBA,0BAAU;AACT+M,4BAAQ/M,QAAQ+M,MADP;AAETC,2BAAOrK,MAAM4C,IAAN,CAAWqG,IAAIzH,KAAf,EAAsBnE,QAAQgN,KAA9B;AAFE,iBAAV;AAIA;AACDhF,eAAGvH,IAAH,CAAQ,EAAEzD,IAAI,MAAN,EAAc7D,MAAMyS,IAAIzS,IAAxB,EAA8BgL,OAAOyH,IAAIzH,KAAzC,EAAgDnE,SAASA,OAAzD,EAAR;AACAgI,eAAGvH,IAAH,CAAQ,EAAEzD,IAAI,QAAN,EAAgB7D,MAAMyS,IAAIzS,IAA1B,EAAgC6G,SAASA,OAAzC,EAAR;AACA,mBAAO,CAAP;AACA;;AAED,iBAAS+L,gBAAT,CAA0BH,GAA1B,EAA+B/N,CAA/B,EAAkC;AACjC,gBAAG+N,IAAIzS,IAAJ,KAAa0E,EAAE1E,IAAf,IAAuB0E,EAAEb,EAAF,KAAS,QAAnC,EAA6C;AAC5C,sBAAM,IAAIwC,SAAJ,CAAc,uDAAd,CAAN;AACA;;AAED,mBAAOoG,aAAagG,GAAb,EAAkB/N,CAAlB,CAAP;AACA;;AAED;;;;;AAKA,iBAASsO,YAAT,CAAsBhH,CAAtB,EAAyBnG,MAAzB,EAAiC5F,OAAjC,EAA0C;AACzC,gBAAIwT,UAAUtE,KAAKnD,CAAL,EAAQnG,OAAO7F,IAAf,EAAqBC,QAAQ8P,WAA7B,EAA0ClK,OAAOgB,OAAjD,CAAd;;AAEA,gBAAG6M,SAASD,OAAT,KAAqBK,aAAaL,OAAb,CAAxB,EAA+C;AAC9C,sBAAM,IAAI5J,0BAAJ,CAA+B,yBAAyBhE,OAAO7F,IAA/D,CAAN;AACA;;AAED,gBAAG6F,OAAOmF,KAAP,KAAiB,KAAK,CAAzB,EAA4B;AAC3B,sBAAM,IAAInB,0BAAJ,CAA+B,eAA/B,CAAN;AACA;;AAED,gBAAImB,QAAQ3B,MAAMxD,OAAOmF,KAAb,CAAZ;;AAEA;AACA,gBAAGyI,QAAQvL,GAAR,KAAgB,KAAK,CAAxB,EAA2B;AAC1B,uBAAO8C,KAAP;AACA;;AAED,gBAAI7F,SAASsO,QAAQtO,MAArB;;AAEA,gBAAGlB,MAAMC,OAAN,CAAciB,MAAd,CAAH,EAA0B;AACzBA,uBAAOmK,gBAAgBmE,QAAQvL,GAAxB,CAAP,IAAuC8C,KAAvC;AACA,aAFD,MAEO;AACN7F,uBAAOsO,QAAQvL,GAAf,IAAsB8C,KAAtB;AACA;;AAED,mBAAOgB,CAAP;AACA;;AAED,iBAASiH,aAAT,CAAuBpE,EAAvB,EAA2BG,CAA3B,EAA8BjR,CAA9B,EAAiCmE,KAAjC,EAAwC;AACvC,gBAAI6R,OAAO7R,MAAMnE,IAAE,CAAR,CAAX;AACA,gBAAGgW,SAAS,KAAK,CAAd,IAAmBA,KAAKlQ,EAAL,KAAY,MAA/B,IAAyCkQ,KAAK/T,IAAL,KAAcgP,EAAEhP,IAA5D,EAAkE;AACjE,sBAAM,IAAI+J,uBAAJ,CAA4B,gCAA5B,CAAN;AACA;;AAED,gBAAIlD,UAAUkN,KAAKlN,OAAnB;AACA,gBAAGA,YAAY,KAAK,CAApB,EAAuB;AACtBA,0BAAU;AACT+M,4BAAQ/M,QAAQ+M,MADP;AAETC,2BAAOrK,MAAM4C,IAAN,CAAW2H,KAAK/I,KAAhB,EAAuBxB,MAAM6C,IAAN,CAAWxF,QAAQgN,KAAnB,CAAvB;AAFE,iBAAV;AAIA;;AAEDhF,eAAGvH,IAAH,CAAQ,EAAEzD,IAAI,MAAN,EAAc7D,MAAM+T,KAAK/T,IAAzB,EAA+BgL,OAAOgE,EAAEhE,KAAxC,EAAR;AACA6D,eAAGvH,IAAH,CAAQ,EAAEzD,IAAI,SAAN,EAAiB7D,MAAM+T,KAAK/T,IAA5B,EAAkCgL,OAAO+I,KAAK/I,KAA9C,EAAR;AACA,mBAAO,CAAP;AACA;;AAED,iBAASkI,cAAT,CAAwB/O,OAAxB,EAAiCO,CAAjC,EAAoC;AACnC,gBAAGP,QAAQnE,IAAR,KAAiB0E,EAAE1E,IAAnB,IAA2B0E,EAAEb,EAAF,KAAS,QAAvC,EAAiD;AAChD,sBAAM,IAAIwC,SAAJ,CAAc,+DAAd,CAAN;AACA;;AAED,gBAAG3B,EAAEb,EAAF,KAAS,MAAT,IAAmBa,EAAEb,EAAF,KAAS,SAA/B,EAA0C;AACzC,uBAAO,CAACa,CAAD,EAAIP,OAAJ,CAAP;AACA;;AAED,mBAAOsI,aAAatI,OAAb,EAAsBO,CAAtB,CAAP;AACA;;AAED;;;;;AAKA,iBAASmO,WAAT,CAAqB7G,CAArB,EAAwBnG,MAAxB,EAAgC5F,OAAhC,EAAyC;AACxC,gBAAIwT,UAAUtE,KAAKnD,CAAL,EAAQnG,OAAO7F,IAAf,EAAqBC,QAAQ8P,WAA7B,EAA0ClK,OAAOgB,OAAjD,CAAd;;AAEA;AACA,gBAAG6M,SAASD,OAAT,KAAqBA,QAAQtO,MAAR,CAAesO,QAAQvL,GAAvB,MAAgC,KAAK,CAA7D,EAAgE;AAC/D,sBAAM,IAAI2B,0BAAJ,CAA+B,yBAAyBhE,OAAO7F,IAA/D,CAAN;AACA;;AAEDgU,oBAAQP,OAAR;AACA,mBAAOzH,CAAP;AACA;;AAED,iBAASgI,OAAT,CAAkBP,OAAlB,EAA2B;AAC1B,gBAAItO,SAASsO,QAAQtO,MAArB;;AAEA,gBAAI8O,OAAJ;AACA,gBAAIhQ,MAAMC,OAAN,CAAciB,MAAd,CAAJ,EAA2B;AAC1B8O,0BAAU9O,OAAO6C,MAAP,CAAcsH,gBAAgBmE,QAAQvL,GAAxB,CAAd,EAA4C,CAA5C,CAAV;AACA,uBAAO+L,QAAQ,CAAR,CAAP;AAEA,aAJD,MAIO,IAAIjK,cAAc7E,MAAd,CAAJ,EAA2B;AACjC8O,0BAAU9O,OAAOsO,QAAQvL,GAAf,CAAV;AACA,uBAAO/C,OAAOsO,QAAQvL,GAAf,CAAP;AACA,uBAAO+L,OAAP;AAEA,aALM,MAKA;AACN,sBAAM,IAAIpK,0BAAJ,CAA+B,6CAA/B,CAAN;AACA;AACD;;AAED,iBAASiJ,YAAT,CAAsBjE,EAAtB,EAA0BG,CAA1B,EAA6BjR,CAA7B,EAAgCmE,KAAhC,EAAuC;AACtC,gBAAI6R,OAAO7R,MAAMnE,IAAE,CAAR,CAAX;AACA,gBAAGgW,SAAS,KAAK,CAAd,IAAmBA,KAAKlQ,EAAL,KAAY,MAA/B,IAAyCkQ,KAAK/T,IAAL,KAAcgP,EAAEhP,IAA5D,EAAkE;AACjE,sBAAM,IAAI+J,uBAAJ,CAA4B,+BAA5B,CAAN;AACA;;AAED,gBAAIlD,UAAUkN,KAAKlN,OAAnB;AACA,gBAAGA,YAAY,KAAK,CAApB,EAAuB;AACtBA,0BAAU;AACT+M,4BAAQ/M,QAAQ+M,MADP;AAETC,2BAAOrK,MAAM6C,IAAN,CAAWxF,QAAQgN,KAAnB;AAFE,iBAAV;AAIA;;AAEDhF,eAAGvH,IAAH,CAAQ,EAAEzD,IAAI,KAAN,EAAa7D,MAAM+T,KAAK/T,IAAxB,EAA8BgL,OAAO+I,KAAK/I,KAA1C,EAAiDnE,SAASA,OAA1D,EAAR;AACA,mBAAO,CAAP;AACA;;AAED,iBAASkM,aAAT,CAAuBjB,MAAvB,EAA+BpN,CAA/B,EAAkC;AACjC,gBAAGoN,OAAO9R,IAAP,KAAgB0E,EAAE1E,IAAlB,IAA0B0E,EAAEb,EAAF,KAAS,QAAtC,EAAgD;AAC/C,uBAAO,CAACa,CAAD,EAAIoN,MAAJ,CAAP;AACA;;AAED,mBAAOrF,aAAaqF,MAAb,EAAqBpN,CAArB,CAAP;AACA;;AAED;;;;;AAKA,iBAAS0O,SAAT,CAAmBpH,CAAnB,EAAsBnG,MAAtB,EAA8B5F,OAA9B,EAAuC;AACtC,gBAAGyJ,YAAY0F,QAAZ,CAAqBvJ,OAAO7F,IAA5B,EAAkC6F,OAAOyI,IAAzC,CAAH,EAAmD;AAClD,sBAAM,IAAIzE,0BAAJ,CAA+B,2CAA/B,CAAN;AACA;;AAED,gBAAIqK,MAAM/E,KAAKnD,CAAL,EAAQnG,OAAO7F,IAAf,EAAqBC,QAAQ8P,WAA7B,EAA0ClK,OAAOgB,OAAjD,CAAV;AACA,gBAAIsN,QAAQhF,KAAKnD,CAAL,EAAQnG,OAAOyI,IAAf,EAAqBrO,QAAQ8P,WAA7B,EAA0ClK,OAAOuO,WAAjD,CAAZ;;AAEAT,iBAAKO,GAAL,EAAUF,QAAQG,KAAR,CAAV;AACA,mBAAOnI,CAAP;AACA;;AAED,iBAASqH,UAAT,CAAoBxE,EAApB,EAAwBG,CAAxB,EAA2B;AAC1BH,eAAGvH,IAAH,CAAQ,EAAEzD,IAAI,MAAN;AACP7D,sBAAMgP,EAAEV,IADD,EACOzH,SAASmI,EAAEoF,WADlB;AAEP9F,sBAAMU,EAAEhP,IAFD,EAEOoU,aAAapF,EAAEnI,OAFtB,EAAR;AAGA,mBAAO,CAAP;AACA;;AAED,iBAASyM,WAAT,CAAqBH,IAArB,EAA2BzO,CAA3B,EAA8B;AAC7B,gBAAGyO,KAAKnT,IAAL,KAAc0E,EAAE1E,IAAhB,IAAwB0E,EAAEb,EAAF,KAAS,QAApC,EAA8C;AAC7C,sBAAM,IAAIwC,SAAJ,CAAc,0DAAd,CAAN;AACA;;AAED,mBAAOoG,aAAa0G,IAAb,EAAmBzO,CAAnB,CAAP;AACA;;AAED;;;;;AAKA,iBAAS6O,SAAT,CAAmBvH,CAAnB,EAAsBnG,MAAtB,EAA8B5F,OAA9B,EAAuC;AACtC,gBAAIiU,MAAM/E,KAAKnD,CAAL,EAAQnG,OAAO7F,IAAf,EAAqBC,QAAQ8P,WAA7B,EAA0ClK,OAAOgB,OAAjD,CAAV;AACA,gBAAIsN,QAAQhF,KAAKnD,CAAL,EAAQnG,OAAOyI,IAAf,EAAqBrO,QAAQ8P,WAA7B,EAA0ClK,OAAOuO,WAAjD,CAAZ;;AAEA,gBAAGV,SAASS,KAAT,KAAmBL,aAAaK,KAAb,CAAtB,EAA2C;AAC1C,sBAAM,IAAItK,0BAAJ,CAA+B,sBAA/B,CAAN;AACA;;AAED,gBAAI1E,SAASgP,MAAMhP,MAAnB;AACA,gBAAI6F,KAAJ;;AAEA,gBAAG/G,MAAMC,OAAN,CAAciB,MAAd,CAAH,EAA0B;AACzB6F,wBAAQ7F,OAAOmK,gBAAgB6E,MAAMjM,GAAtB,CAAP,CAAR;AACA,aAFD,MAEO;AACN8C,wBAAQ7F,OAAOgP,MAAMjM,GAAb,CAAR;AACA;;AAEDyL,iBAAKO,GAAL,EAAU7K,MAAM2B,KAAN,CAAV;AACA,mBAAOgB,CAAP;AACA;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAASwH,aAAT,CAAuBa,CAAvB,EAA0BrF,CAA1B,EAA6B;AAC5B,kBAAM,IAAIjF,uBAAJ,CAA4B,mBAAmBiF,EAAEnL,EAAjD,CAAN;AACA;;AAED,iBAAS6P,QAAT,CAAmBD,OAAnB,EAA4B;AAC3B,mBAAOA,YAAY,KAAK,CAAjB,IAAuBA,QAAQtO,MAAR,IAAkB,IAAlB,IAA0BsO,QAAQvL,GAAR,KAAgB,KAAK,CAA7E;AACA;;AAED,iBAAS4L,YAAT,CAAsBL,OAAtB,EAA+B;AAC9B,mBAAOA,QAAQvL,GAAR,KAAgB,KAAK,CAArB,IAA0BuL,QAAQtO,MAAR,CAAesO,QAAQvL,GAAvB,MAAgC,KAAK,CAAtE;AACA;;AAED;;;;;AAKA,iBAAS8B,aAAT,CAAwBgC,CAAxB,EAA2B;AAC1B,mBAAOA,MAAM,IAAN,IAAc,QAAOA,CAAP,yCAAOA,CAAP,OAAa,QAAlC;AACA;AAEA,KA/XQ,EA+XP,EAAC,gCAA+B,CAAhC,EAAkC,6BAA4B,CAA9D,EAAgE,qBAAoB,CAApF,EAAsF,WAAU,EAAhG,EAAmG,WAAU,EAA7G,EAAgH,kBAAiB,EAAjI,EAAoI,gBAAe,EAAnJ,EAAsJ,iBAAgB,EAAtK,EA/XO,CA7xDkb,EA4pE9Q,IAAG,CAAC,UAASlO,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACjN;AACA,YAAIkW,UAAU/V,OAAOH,OAAP,GAAiB,EAA/B;;AAEA;AACA;AACA;AACA;;AAEA,YAAImW,gBAAJ;AACA,YAAIC,kBAAJ;;AAEA,iBAASC,gBAAT,GAA4B;AACxB,kBAAM,IAAIxW,KAAJ,CAAU,iCAAV,CAAN;AACH;AACD,iBAASyW,mBAAT,GAAgC;AAC5B,kBAAM,IAAIzW,KAAJ,CAAU,mCAAV,CAAN;AACH;AACA,qBAAY;AACT,gBAAI;AACA,oBAAI,OAAO0W,UAAP,KAAsB,UAA1B,EAAsC;AAClCJ,uCAAmBI,UAAnB;AACH,iBAFD,MAEO;AACHJ,uCAAmBE,gBAAnB;AACH;AACJ,aAND,CAME,OAAOnX,CAAP,EAAU;AACRiX,mCAAmBE,gBAAnB;AACH;AACD,gBAAI;AACA,oBAAI,OAAOG,YAAP,KAAwB,UAA5B,EAAwC;AACpCJ,yCAAqBI,YAArB;AACH,iBAFD,MAEO;AACHJ,yCAAqBE,mBAArB;AACH;AACJ,aAND,CAME,OAAOpX,CAAP,EAAU;AACRkX,qCAAqBE,mBAArB;AACH;AACJ,SAnBA,GAAD;AAoBA,iBAASG,UAAT,CAAoBC,GAApB,EAAyB;AACrB,gBAAIP,qBAAqBI,UAAzB,EAAqC;AACjC;AACA,uBAAOA,WAAWG,GAAX,EAAgB,CAAhB,CAAP;AACH;AACD;AACA,gBAAI,CAACP,qBAAqBE,gBAArB,IAAyC,CAACF,gBAA3C,KAAgEI,UAApE,EAAgF;AAC5EJ,mCAAmBI,UAAnB;AACA,uBAAOA,WAAWG,GAAX,EAAgB,CAAhB,CAAP;AACH;AACD,gBAAI;AACA;AACA,uBAAOP,iBAAiBO,GAAjB,EAAsB,CAAtB,CAAP;AACH,aAHD,CAGE,OAAMxX,CAAN,EAAQ;AACN,oBAAI;AACA;AACA,2BAAOiX,iBAAiBlW,IAAjB,CAAsB,IAAtB,EAA4ByW,GAA5B,EAAiC,CAAjC,CAAP;AACH,iBAHD,CAGE,OAAMxX,CAAN,EAAQ;AACN;AACA,2BAAOiX,iBAAiBlW,IAAjB,CAAsB,IAAtB,EAA4ByW,GAA5B,EAAiC,CAAjC,CAAP;AACH;AACJ;AAGJ;AACD,iBAASC,eAAT,CAAyBC,MAAzB,EAAiC;AAC7B,gBAAIR,uBAAuBI,YAA3B,EAAyC;AACrC;AACA,uBAAOA,aAAaI,MAAb,CAAP;AACH;AACD;AACA,gBAAI,CAACR,uBAAuBE,mBAAvB,IAA8C,CAACF,kBAAhD,KAAuEI,YAA3E,EAAyF;AACrFJ,qCAAqBI,YAArB;AACA,uBAAOA,aAAaI,MAAb,CAAP;AACH;AACD,gBAAI;AACA;AACA,uBAAOR,mBAAmBQ,MAAnB,CAAP;AACH,aAHD,CAGE,OAAO1X,CAAP,EAAS;AACP,oBAAI;AACA;AACA,2BAAOkX,mBAAmBnW,IAAnB,CAAwB,IAAxB,EAA8B2W,MAA9B,CAAP;AACH,iBAHD,CAGE,OAAO1X,CAAP,EAAS;AACP;AACA;AACA,2BAAOkX,mBAAmBnW,IAAnB,CAAwB,IAAxB,EAA8B2W,MAA9B,CAAP;AACH;AACJ;AAIJ;AACD,YAAIC,QAAQ,EAAZ;AACA,YAAIC,WAAW,KAAf;AACA,YAAIC,YAAJ;AACA,YAAIC,aAAa,CAAC,CAAlB;;AAEA,iBAASC,eAAT,GAA2B;AACvB,gBAAI,CAACH,QAAD,IAAa,CAACC,YAAlB,EAAgC;AAC5B;AACH;AACDD,uBAAW,KAAX;AACA,gBAAIC,aAAa7W,MAAjB,EAAyB;AACrB2W,wBAAQE,aAAa1Q,MAAb,CAAoBwQ,KAApB,CAAR;AACH,aAFD,MAEO;AACHG,6BAAa,CAAC,CAAd;AACH;AACD,gBAAIH,MAAM3W,MAAV,EAAkB;AACdgX;AACH;AACJ;;AAED,iBAASA,UAAT,GAAsB;AAClB,gBAAIJ,QAAJ,EAAc;AACV;AACH;AACD,gBAAIK,UAAUV,WAAWQ,eAAX,CAAd;AACAH,uBAAW,IAAX;;AAEA,gBAAI1O,MAAMyO,MAAM3W,MAAhB;AACA,mBAAMkI,GAAN,EAAW;AACP2O,+BAAeF,KAAf;AACAA,wBAAQ,EAAR;AACA,uBAAO,EAAEG,UAAF,GAAe5O,GAAtB,EAA2B;AACvB,wBAAI2O,YAAJ,EAAkB;AACdA,qCAAaC,UAAb,EAAyBI,GAAzB;AACH;AACJ;AACDJ,6BAAa,CAAC,CAAd;AACA5O,sBAAMyO,MAAM3W,MAAZ;AACH;AACD6W,2BAAe,IAAf;AACAD,uBAAW,KAAX;AACAH,4BAAgBQ,OAAhB;AACH;;AAEDjB,gBAAQmB,QAAR,GAAmB,UAAUX,GAAV,EAAe;AAC9B,gBAAI7S,OAAO,IAAIgC,KAAJ,CAAU2C,UAAUtI,MAAV,GAAmB,CAA7B,CAAX;AACA,gBAAIsI,UAAUtI,MAAV,GAAmB,CAAvB,EAA0B;AACtB,qBAAK,IAAIP,IAAI,CAAb,EAAgBA,IAAI6I,UAAUtI,MAA9B,EAAsCP,GAAtC,EAA2C;AACvCkE,yBAAKlE,IAAI,CAAT,IAAc6I,UAAU7I,CAAV,CAAd;AACH;AACJ;AACDkX,kBAAM3N,IAAN,CAAW,IAAIoO,IAAJ,CAASZ,GAAT,EAAc7S,IAAd,CAAX;AACA,gBAAIgT,MAAM3W,MAAN,KAAiB,CAAjB,IAAsB,CAAC4W,QAA3B,EAAqC;AACjCL,2BAAWS,UAAX;AACH;AACJ,SAXD;;AAaA;AACA,iBAASI,IAAT,CAAcZ,GAAd,EAAmBtL,KAAnB,EAA0B;AACtB,iBAAKsL,GAAL,GAAWA,GAAX;AACA,iBAAKtL,KAAL,GAAaA,KAAb;AACH;AACDkM,aAAK1P,SAAL,CAAewP,GAAf,GAAqB,YAAY;AAC7B,iBAAKV,GAAL,CAAS7N,KAAT,CAAe,IAAf,EAAqB,KAAKuC,KAA1B;AACH,SAFD;AAGA8K,gBAAQqB,KAAR,GAAgB,SAAhB;AACArB,gBAAQsB,OAAR,GAAkB,IAAlB;AACAtB,gBAAQuB,GAAR,GAAc,EAAd;AACAvB,gBAAQwB,IAAR,GAAe,EAAf;AACAxB,gBAAQyB,OAAR,GAAkB,EAAlB,CA/JiN,CA+J3L;AACtBzB,gBAAQ0B,QAAR,GAAmB,EAAnB;;AAEA,iBAASC,IAAT,GAAgB,CAAE;;AAElB3B,gBAAQ9U,EAAR,GAAayW,IAAb;AACA3B,gBAAQpN,WAAR,GAAsB+O,IAAtB;AACA3B,gBAAQ5M,IAAR,GAAeuO,IAAf;AACA3B,gBAAQ4B,GAAR,GAAcD,IAAd;AACA3B,gBAAQzM,cAAR,GAAyBoO,IAAzB;AACA3B,gBAAQrM,kBAAR,GAA6BgO,IAA7B;AACA3B,gBAAQ/Q,IAAR,GAAe0S,IAAf;AACA3B,gBAAQ6B,eAAR,GAA0BF,IAA1B;AACA3B,gBAAQ8B,mBAAR,GAA8BH,IAA9B;;AAEA3B,gBAAQ7N,SAAR,GAAoB,UAAUyC,IAAV,EAAgB;AAAE,mBAAO,EAAP;AAAW,SAAjD;;AAEAoL,gBAAQ+B,OAAR,GAAkB,UAAUnN,IAAV,EAAgB;AAC9B,kBAAM,IAAIjL,KAAJ,CAAU,kCAAV,CAAN;AACH,SAFD;;AAIAqW,gBAAQgC,GAAR,GAAc,YAAY;AAAE,mBAAO,GAAP;AAAY,SAAxC;AACAhC,gBAAQiC,KAAR,GAAgB,UAAUC,GAAV,EAAe;AAC3B,kBAAM,IAAIvY,KAAJ,CAAU,gCAAV,CAAN;AACH,SAFD;AAGAqW,gBAAQmC,KAAR,GAAgB,YAAW;AAAE,mBAAO,CAAP;AAAW,SAAxC;AAEC,KA1L+K,EA0L9K,EA1L8K,CA5pE2Q,EAs1Erb,IAAG,CAAC,UAAS3Y,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC1C,SAAC,UAAUkW,OAAV,EAAkB;AACnB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA,aAAC,UAAUoC,UAAV,EAAsB;AACnB;;AAEA;AACA;AACA;AACA;;AAEA;;AACA,oBAAI,OAAOC,SAAP,KAAqB,UAAzB,EAAqC;AACjCA,8BAAU,SAAV,EAAqBD,UAArB;;AAEJ;AACC,iBAJD,MAIO,IAAI,QAAOtY,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,QAAOG,MAAP,yCAAOA,MAAP,OAAkB,QAArD,EAA+D;AAClEA,2BAAOH,OAAP,GAAiBsY,YAAjB;;AAEJ;AACC,iBAJM,MAIA,IAAI,OAAOE,MAAP,KAAkB,UAAlB,IAAgCA,OAAOC,GAA3C,EAAgD;AACnDD,2BAAOF,UAAP;;AAEJ;AACC,iBAJM,MAIA,IAAI,OAAOI,GAAP,KAAe,WAAnB,EAAgC;AACnC,wBAAI,CAACA,IAAIC,EAAJ,EAAL,EAAe;AACX;AACH,qBAFD,MAEO;AACHD,4BAAIE,KAAJ,GAAYN,UAAZ;AACH;;AAEL;AACC,iBARM,MAQA,IAAI,OAAOlY,MAAP,KAAkB,WAAlB,IAAiC,OAAOK,IAAP,KAAgB,WAArD,EAAkE;AACrE;AACA;AACA,wBAAIoY,SAAS,OAAOzY,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyCK,IAAtD;;AAEA;AACA;AACA,wBAAIqY,YAAYD,OAAOE,CAAvB;AACAF,2BAAOE,CAAP,GAAWT,YAAX;;AAEA;AACA;AACAO,2BAAOE,CAAP,CAASC,UAAT,GAAsB,YAAY;AAC9BH,+BAAOE,CAAP,GAAWD,SAAX;AACA,+BAAO,IAAP;AACH,qBAHD;AAKH,iBAjBM,MAiBA;AACH,0BAAM,IAAIjZ,KAAJ,CAAU,+DAAV,CAAN;AACH;AAEJ,aAlDD,EAkDG,YAAY;AACf;;AAEA,oBAAIoZ,YAAY,KAAhB;AACA,oBAAI;AACA,0BAAM,IAAIpZ,KAAJ,EAAN;AACH,iBAFD,CAEE,OAAOX,CAAP,EAAU;AACR+Z,gCAAY,CAAC,CAAC/Z,EAAEga,KAAhB;AACH;;AAED;AACA;AACA,oBAAIC,gBAAgBC,aAApB;AACA,oBAAIC,SAAJ;;AAEA;;AAEA;AACA,oBAAIxB,OAAO,SAAPA,IAAO,GAAY,CAAE,CAAzB;;AAEA;AACA;AACA,oBAAIR,WAAW,YAAY;AACvB;AACA,wBAAIiC,OAAO,EAACC,MAAM,KAAK,CAAZ,EAAeC,MAAM,IAArB,EAAX;AACA,wBAAIvL,OAAOqL,IAAX;AACA,wBAAIG,WAAW,KAAf;AACA,wBAAIC,cAAc,KAAK,CAAvB;AACA,wBAAIC,WAAW,KAAf;AACA;AACA,wBAAIC,aAAa,EAAjB;;AAEA,6BAASC,KAAT,GAAiB;AACb;AACA,4BAAIN,IAAJ,EAAUO,MAAV;;AAEA,+BAAOR,KAAKE,IAAZ,EAAkB;AACdF,mCAAOA,KAAKE,IAAZ;AACAD,mCAAOD,KAAKC,IAAZ;AACAD,iCAAKC,IAAL,GAAY,KAAK,CAAjB;AACAO,qCAASR,KAAKQ,MAAd;;AAEA,gCAAIA,MAAJ,EAAY;AACRR,qCAAKQ,MAAL,GAAc,KAAK,CAAnB;AACAA,uCAAOC,KAAP;AACH;AACDC,sCAAUT,IAAV,EAAgBO,MAAhB;AAEH;AACD,+BAAOF,WAAW1Z,MAAlB,EAA0B;AACtBqZ,mCAAOK,WAAWtS,GAAX,EAAP;AACA0S,sCAAUT,IAAV;AACH;AACDE,mCAAW,KAAX;AACH;AACD;AACA,6BAASO,SAAT,CAAmBT,IAAnB,EAAyBO,MAAzB,EAAiC;AAC7B,4BAAI;AACAP;AAEH,yBAHD,CAGE,OAAOra,CAAP,EAAU;AACR,gCAAIya,QAAJ,EAAc;AACV;AACA;;AAEA;AACA;AACA;AACA,oCAAIG,MAAJ,EAAY;AACRA,2CAAOG,IAAP;AACH;AACD1D,2CAAWsD,KAAX,EAAkB,CAAlB;AACA,oCAAIC,MAAJ,EAAY;AACRA,2CAAOC,KAAP;AACH;;AAED,sCAAM7a,CAAN;AAEH,6BAjBD,MAiBO;AACH;AACA;AACAqX,2CAAW,YAAY;AACnB,0CAAMrX,CAAN;AACH,iCAFD,EAEG,CAFH;AAGH;AACJ;;AAED,4BAAI4a,MAAJ,EAAY;AACRA,mCAAOG,IAAP;AACH;AACJ;;AAED5C,+BAAW,kBAAUkC,IAAV,EAAgB;AACvBtL,+BAAOA,KAAKuL,IAAL,GAAY;AACfD,kCAAMA,IADS;AAEfO,oCAAQH,YAAYzD,QAAQ4D,MAFb;AAGfN,kCAAM;AAHS,yBAAnB;;AAMA,4BAAI,CAACC,QAAL,EAAe;AACXA,uCAAW,IAAX;AACAC;AACH;AACJ,qBAXD;;AAaA,wBAAI,QAAOxD,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IACAA,QAAQ3L,QAAR,OAAuB,kBADvB,IAC6C2L,QAAQmB,QADzD,EACmE;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAsC,mCAAW,IAAX;;AAEAD,sCAAc,uBAAY;AACtBxD,oCAAQmB,QAAR,CAAiBwC,KAAjB;AACH,yBAFD;AAIH,qBAhBD,MAgBO,IAAI,OAAOK,YAAP,KAAwB,UAA5B,EAAwC;AAC3C;AACA,4BAAI,OAAO9Z,MAAP,KAAkB,WAAtB,EAAmC;AAC/BsZ,0CAAcQ,aAAajI,IAAb,CAAkB7R,MAAlB,EAA0ByZ,KAA1B,CAAd;AACH,yBAFD,MAEO;AACHH,0CAAc,uBAAY;AACtBQ,6CAAaL,KAAb;AACH,6BAFD;AAGH;AAEJ,qBAVM,MAUA,IAAI,OAAOM,cAAP,KAA0B,WAA9B,EAA2C;AAC9C;AACA;AACA,4BAAI1W,UAAU,IAAI0W,cAAJ,EAAd;AACA;AACA;AACA1W,gCAAQ2W,KAAR,CAAc9U,SAAd,GAA0B,YAAY;AAClCoU,0CAAcW,eAAd;AACA5W,oCAAQ2W,KAAR,CAAc9U,SAAd,GAA0BuU,KAA1B;AACAA;AACH,yBAJD;AAKA,4BAAIQ,kBAAkB,SAAlBA,eAAkB,GAAY;AAC9B;AACA;AACA5W,oCAAQ6W,KAAR,CAAcC,WAAd,CAA0B,CAA1B;AACH,yBAJD;AAKAb,sCAAc,uBAAY;AACtBnD,uCAAWsD,KAAX,EAAkB,CAAlB;AACAQ;AACH,yBAHD;AAKH,qBArBM,MAqBA;AACH;AACAX,sCAAc,uBAAY;AACtBnD,uCAAWsD,KAAX,EAAkB,CAAlB;AACH,yBAFD;AAGH;AACD;AACA;AACA;AACAxC,6BAASmD,QAAT,GAAoB,UAAUjB,IAAV,EAAgB;AAChCK,mCAAW1Q,IAAX,CAAgBqQ,IAAhB;AACA,4BAAI,CAACE,QAAL,EAAe;AACXA,uCAAW,IAAX;AACAC;AACH;AACJ,qBAND;AAOA,2BAAOrC,QAAP;AACH,iBAnJa,EAAd;;AAqJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAIpX,OAAOwa,SAASxa,IAApB;AACA,yBAASya,WAAT,CAAqB9a,CAArB,EAAwB;AACpB,2BAAO,YAAY;AACf,+BAAOK,KAAK4I,KAAL,CAAWjJ,CAAX,EAAc4I,SAAd,CAAP;AACH,qBAFD;AAGH;AACD;AACA;AACA;;AAEA,oBAAImS,cAAcD,YAAY7U,MAAM+B,SAAN,CAAgBgB,KAA5B,CAAlB;;AAEA,oBAAIgS,eAAeF,YACf7U,MAAM+B,SAAN,CAAgB0F,MAAhB,IAA0B,UAAU3I,QAAV,EAAoBkW,KAApB,EAA2B;AACjD,wBAAI1L,QAAQ,CAAZ;AAAA,wBACIjP,SAAS,KAAKA,MADlB;AAEA;AACA,wBAAIsI,UAAUtI,MAAV,KAAqB,CAAzB,EAA4B;AACxB;AACA;AACA,2BAAG;AACC,gCAAIiP,SAAS,IAAb,EAAmB;AACf0L,wCAAQ,KAAK1L,OAAL,CAAR;AACA;AACH;AACD,gCAAI,EAAEA,KAAF,IAAWjP,MAAf,EAAuB;AACnB,sCAAM,IAAI+H,SAAJ,EAAN;AACH;AACJ,yBARD,QAQS,CART;AASH;AACD;AACA,2BAAOkH,QAAQjP,MAAf,EAAuBiP,OAAvB,EAAgC;AAC5B;AACA,4BAAIA,SAAS,IAAb,EAAmB;AACf0L,oCAAQlW,SAASkW,KAAT,EAAgB,KAAK1L,KAAL,CAAhB,EAA6BA,KAA7B,CAAR;AACH;AACJ;AACD,2BAAO0L,KAAP;AACH,iBA1Bc,CAAnB;;AA6BA,oBAAIC,gBAAgBJ,YAChB7U,MAAM+B,SAAN,CAAgBsK,OAAhB,IAA2B,UAAUtF,KAAV,EAAiB;AACxC;AACA,yBAAK,IAAIjN,IAAI,CAAb,EAAgBA,IAAI,KAAKO,MAAzB,EAAiCP,GAAjC,EAAsC;AAClC,4BAAI,KAAKA,CAAL,MAAYiN,KAAhB,EAAuB;AACnB,mCAAOjN,CAAP;AACH;AACJ;AACD,2BAAO,CAAC,CAAR;AACH,iBATe,CAApB;;AAYA,oBAAIob,YAAYL,YACZ7U,MAAM+B,SAAN,CAAgBoF,GAAhB,IAAuB,UAAUrI,QAAV,EAAoBqW,KAApB,EAA2B;AAC9C,wBAAIva,OAAO,IAAX;AACA,wBAAIwa,UAAU,EAAd;AACAL,iCAAana,IAAb,EAAmB,UAAUiF,SAAV,EAAqBkH,KAArB,EAA4BuC,KAA5B,EAAmC;AAClD8L,gCAAQ/R,IAAR,CAAavE,SAAS1E,IAAT,CAAc+a,KAAd,EAAqBpO,KAArB,EAA4BuC,KAA5B,EAAmC1O,IAAnC,CAAb;AACH,qBAFD,EAEG,KAAK,CAFR;AAGA,2BAAOwa,OAAP;AACH,iBARW,CAAhB;;AAWA,oBAAIC,gBAAgBrU,OAAON,MAAP,IAAiB,UAAUqB,SAAV,EAAqB;AACtD,6BAASuT,IAAT,GAAgB,CAAG;AACnBA,yBAAKvT,SAAL,GAAiBA,SAAjB;AACA,2BAAO,IAAIuT,IAAJ,EAAP;AACH,iBAJD;;AAMA,oBAAIC,wBAAwBvU,OAAOwU,cAAP,IAAyB,UAAU3Q,GAAV,EAAe4Q,IAAf,EAAqBC,UAArB,EAAiC;AAClF7Q,wBAAI4Q,IAAJ,IAAYC,WAAW3O,KAAvB;AACA,2BAAOlC,GAAP;AACH,iBAHD;;AAKA,oBAAI8Q,wBAAwBd,YAAY7T,OAAOe,SAAP,CAAiByC,cAA7B,CAA5B;;AAEA,oBAAIoR,cAAc5U,OAAOC,IAAP,IAAe,UAAU4U,MAAV,EAAkB;AAC/C,wBAAI5U,OAAO,EAAX;AACA,yBAAK,IAAIgD,GAAT,IAAgB4R,MAAhB,EAAwB;AACpB,4BAAIF,sBAAsBE,MAAtB,EAA8B5R,GAA9B,CAAJ,EAAwC;AACpChD,iCAAKoC,IAAL,CAAUY,GAAV;AACH;AACJ;AACD,2BAAOhD,IAAP;AACH,iBARD;;AAUA,oBAAI6U,kBAAkBjB,YAAY7T,OAAOe,SAAP,CAAiB2C,QAA7B,CAAtB;;AAEA,yBAAShC,QAAT,CAAkBqE,KAAlB,EAAyB;AACrB,2BAAOA,UAAU/F,OAAO+F,KAAP,CAAjB;AACH;;AAED;;AAEA;AACA,yBAASgP,eAAT,CAAyBC,SAAzB,EAAoC;AAChC,2BACIF,gBAAgBE,SAAhB,MAA+B,wBAA/B,IACAA,qBAAqBC,YAFzB;AAIH;;AAED;AACA;AACA,oBAAIA,YAAJ;AACA,oBAAI,OAAOC,WAAP,KAAuB,WAA3B,EAAwC;AACpCD,mCAAeC,WAAf;AACH,iBAFD,MAEO;AACHD,mCAAe,sBAAUlP,KAAV,EAAiB;AAC5B,6BAAKA,KAAL,GAAaA,KAAb;AACH,qBAFD;AAGH;;AAED;;AAEA,oBAAIoP,uBAAuB,sBAA3B;;AAEA,yBAASC,kBAAT,CAA4B3T,KAA5B,EAAmC5G,OAAnC,EAA4C;AACxC;AACA;AACA,wBAAIuX,aACAvX,QAAQwX,KADR,IAEA,QAAO5Q,KAAP,yCAAOA,KAAP,OAAiB,QAFjB,IAGAA,UAAU,IAHV,IAIAA,MAAM4Q,KAJV,EAKE;AACE,4BAAIgD,SAAS,EAAb;AACA,6BAAK,IAAI/U,IAAIzF,OAAb,EAAsB,CAAC,CAACyF,CAAxB,EAA2BA,IAAIA,EAAEH,MAAjC,EAAyC;AACrC,gCAAIG,EAAE+R,KAAF,KAAY,CAAC5Q,MAAM6T,uBAAP,IAAkC7T,MAAM6T,uBAAN,GAAgChV,EAAEiV,YAAhF,CAAJ,EAAmG;AAC/FhB,sDAAsB9S,KAAtB,EAA6B,yBAA7B,EAAwD,EAACsE,OAAOzF,EAAEiV,YAAV,EAAwBC,cAAc,IAAtC,EAAxD;AACAH,uCAAOI,OAAP,CAAenV,EAAE+R,KAAjB;AACH;AACJ;AACDgD,+BAAOI,OAAP,CAAehU,MAAM4Q,KAArB;;AAEA,4BAAIqD,iBAAiBL,OAAO/V,IAAP,CAAY,OAAO6V,oBAAP,GAA8B,IAA1C,CAArB;AACA,4BAAI9C,QAAQsD,kBAAkBD,cAAlB,CAAZ;AACAnB,8CAAsB9S,KAAtB,EAA6B,OAA7B,EAAsC,EAACsE,OAAOsM,KAAR,EAAemD,cAAc,IAA7B,EAAtC;AACH;AACJ;;AAED,yBAASG,iBAAT,CAA2BC,WAA3B,EAAwC;AACpC,wBAAIC,QAAQD,YAAYzW,KAAZ,CAAkB,IAAlB,CAAZ;AACA,wBAAI2W,eAAe,EAAnB;AACA,yBAAK,IAAIhd,IAAI,CAAb,EAAgBA,IAAI+c,MAAMxc,MAA1B,EAAkC,EAAEP,CAApC,EAAuC;AACnC,4BAAIid,OAAOF,MAAM/c,CAAN,CAAX;;AAEA,4BAAI,CAACkd,gBAAgBD,IAAhB,CAAD,IAA0B,CAACE,YAAYF,IAAZ,CAA3B,IAAgDA,IAApD,EAA0D;AACtDD,yCAAazT,IAAb,CAAkB0T,IAAlB;AACH;AACJ;AACD,2BAAOD,aAAaxW,IAAb,CAAkB,IAAlB,CAAP;AACH;;AAED,yBAAS2W,WAAT,CAAqBC,SAArB,EAAgC;AAC5B,2BAAOA,UAAU7K,OAAV,CAAkB,aAAlB,MAAqC,CAAC,CAAtC,IACA6K,UAAU7K,OAAV,CAAkB,WAAlB,MAAmC,CAAC,CAD3C;AAEH;;AAED,yBAAS8K,wBAAT,CAAkCD,SAAlC,EAA6C;AACzC;AACA;AACA,wBAAIE,WAAW,gCAAgCjK,IAAhC,CAAqC+J,SAArC,CAAf;AACA,wBAAIE,QAAJ,EAAc;AACV,+BAAO,CAACA,SAAS,CAAT,CAAD,EAAcC,OAAOD,SAAS,CAAT,CAAP,CAAd,CAAP;AACH;;AAED;AACA,wBAAIE,WAAW,4BAA4BnK,IAA5B,CAAiC+J,SAAjC,CAAf;AACA,wBAAII,QAAJ,EAAc;AACV,+BAAO,CAACA,SAAS,CAAT,CAAD,EAAcD,OAAOC,SAAS,CAAT,CAAP,CAAd,CAAP;AACH;;AAED;AACA,wBAAIC,WAAW,iBAAiBpK,IAAjB,CAAsB+J,SAAtB,CAAf;AACA,wBAAIK,QAAJ,EAAc;AACV,+BAAO,CAACA,SAAS,CAAT,CAAD,EAAcF,OAAOE,SAAS,CAAT,CAAP,CAAd,CAAP;AACH;AACJ;;AAED,yBAASP,eAAT,CAAyBE,SAAzB,EAAoC;AAChC,wBAAIM,wBAAwBL,yBAAyBD,SAAzB,CAA5B;;AAEA,wBAAI,CAACM,qBAAL,EAA4B;AACxB,+BAAO,KAAP;AACH;;AAED,wBAAIC,WAAWD,sBAAsB,CAAtB,CAAf;AACA,wBAAIE,aAAaF,sBAAsB,CAAtB,CAAjB;;AAEA,2BAAOC,aAAajE,SAAb,IACHkE,cAAcpE,aADX,IAEHoE,cAAcC,WAFlB;AAGH;;AAED;AACA;AACA,yBAASpE,WAAT,GAAuB;AACnB,wBAAI,CAACH,SAAL,EAAgB;AACZ;AACH;;AAED,wBAAI;AACA,8BAAM,IAAIpZ,KAAJ,EAAN;AACH,qBAFD,CAEE,OAAOX,CAAP,EAAU;AACR,4BAAIwd,QAAQxd,EAAEga,KAAF,CAAQlT,KAAR,CAAc,IAAd,CAAZ;AACA,4BAAIyX,YAAYf,MAAM,CAAN,EAASxK,OAAT,CAAiB,GAAjB,IAAwB,CAAxB,GAA4BwK,MAAM,CAAN,CAA5B,GAAuCA,MAAM,CAAN,CAAvD;AACA,4BAAIW,wBAAwBL,yBAAyBS,SAAzB,CAA5B;AACA,4BAAI,CAACJ,qBAAL,EAA4B;AACxB;AACH;;AAEDhE,oCAAYgE,sBAAsB,CAAtB,CAAZ;AACA,+BAAOA,sBAAsB,CAAtB,CAAP;AACH;AACJ;;AAED,yBAASK,SAAT,CAAmB/Y,QAAnB,EAA6BmG,IAA7B,EAAmC6S,WAAnC,EAAgD;AAC5C,2BAAO,YAAY;AACf,4BAAI,OAAOvU,OAAP,KAAmB,WAAnB,IACA,OAAOA,QAAQwU,IAAf,KAAwB,UAD5B,EACwC;AACpCxU,oCAAQwU,IAAR,CAAa9S,OAAO,sBAAP,GAAgC6S,WAAhC,GACA,WADb,EAC0B,IAAI9d,KAAJ,CAAU,EAAV,EAAcqZ,KADxC;AAEH;AACD,+BAAOvU,SAASkE,KAAT,CAAelE,QAAf,EAAyB6D,SAAzB,CAAP;AACH,qBAPD;AAQH;;AAED;AACA;;AAEA;;;;;AAKA,yBAASuQ,CAAT,CAAWnM,KAAX,EAAkB;AACd;AACA;AACA;AACA,wBAAIA,iBAAiBiR,OAArB,EAA8B;AAC1B,+BAAOjR,KAAP;AACH;;AAED;AACA,wBAAIkR,eAAelR,KAAf,CAAJ,EAA2B;AACvB,+BAAOmR,OAAOnR,KAAP,CAAP;AACH,qBAFD,MAEO;AACH,+BAAOoR,QAAQpR,KAAR,CAAP;AACH;AACJ;AACDmM,kBAAEzX,OAAF,GAAYyX,CAAZ;;AAEA;;;;AAIAA,kBAAE1B,QAAF,GAAaA,QAAb;;AAEA;;;AAGA0B,kBAAEkF,gBAAF,GAAqB,KAArB;;AAEA;;;;;;AAMA,oBAAIC,mBAAmB,CAAvB;;AAEA;AACA,oBAAI,QAAOhI,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+BA,OAA/B,IAA0CA,QAAQuB,GAAlD,IAAyDvB,QAAQuB,GAAR,CAAY0G,OAAzE,EAAkF;AAC9EpF,sBAAEkF,gBAAF,GAAqB,IAArB;AACH;;AAED;;;;;;;;;;AAUAlF,kBAAEtX,KAAF,GAAUA,KAAV;AACA,yBAASA,KAAT,GAAiB;AACb;AACA;AACA;AACA;AACA;AACA;AACA,wBAAI2c,WAAW,EAAf;AAAA,wBAAmBC,oBAAoB,EAAvC;AAAA,wBAA2CC,eAA3C;;AAEA,wBAAIC,WAAWrD,cAAczZ,MAAMmG,SAApB,CAAf;AACA,wBAAIlG,UAAUwZ,cAAc2C,QAAQjW,SAAtB,CAAd;;AAEAlG,4BAAQ8c,eAAR,GAA0B,UAAUld,OAAV,EAAmBmE,EAAnB,EAAuBgZ,QAAvB,EAAiC;AACvD,4BAAI5a,OAAO8W,YAAYnS,SAAZ,CAAX;AACA,4BAAI4V,QAAJ,EAAc;AACVA,qCAASlV,IAAT,CAAcrF,IAAd;AACA,gCAAI4B,OAAO,MAAP,IAAiBgZ,SAAS,CAAT,CAArB,EAAkC;AAAE;AAChCJ,kDAAkBnV,IAAlB,CAAuBuV,SAAS,CAAT,CAAvB;AACH;AACJ,yBALD,MAKO;AACH1F,8BAAE1B,QAAF,CAAW,YAAY;AACnBiH,gDAAgBE,eAAhB,CAAgC3V,KAAhC,CAAsCyV,eAAtC,EAAuDza,IAAvD;AACH,6BAFD;AAGH;AACJ,qBAZD;;AAcA;AACAnC,4BAAQgd,OAAR,GAAkB,YAAY;AAC1B,4BAAIN,QAAJ,EAAc;AACV,mCAAO1c,OAAP;AACH;AACD,4BAAIid,cAAcC,OAAON,eAAP,CAAlB;AACA,4BAAIO,UAAUF,WAAV,CAAJ,EAA4B;AACxBL,8CAAkBK,WAAlB,CADwB,CACO;AAClC;AACD,+BAAOA,WAAP;AACH,qBATD;;AAWAjd,4BAAQod,OAAR,GAAkB,YAAY;AAC1B,4BAAI,CAACR,eAAL,EAAsB;AAClB,mCAAO,EAAEjS,OAAO,SAAT,EAAP;AACH;AACD,+BAAOiS,gBAAgBQ,OAAhB,EAAP;AACH,qBALD;;AAOA,wBAAI/F,EAAEkF,gBAAF,IAAsBhF,SAA1B,EAAqC;AACjC,4BAAI;AACA,kCAAM,IAAIpZ,KAAJ,EAAN;AACH,yBAFD,CAEE,OAAOX,CAAP,EAAU;AACR;AACA;AACA;AACA;AACA;AACA;AACAwC,oCAAQwX,KAAR,GAAgBha,EAAEga,KAAF,CAAQ6F,SAAR,CAAkB7f,EAAEga,KAAF,CAAQhH,OAAR,CAAgB,IAAhB,IAAwB,CAA1C,CAAhB;AACAxQ,oCAAQ0a,YAAR,GAAuB8B,kBAAvB;AACH;AACJ;;AAED;AACA;AACA;;AAEA,6BAASc,MAAT,CAAgBC,UAAhB,EAA4B;AACxBX,0CAAkBW,UAAlB;;AAEA,4BAAIlG,EAAEkF,gBAAF,IAAsBhF,SAA1B,EAAqC;AACjC;AACA;AACAvX,oCAAQsF,MAAR,GAAiBiY,UAAjB;AACH;;AAEDrE,qCAAawD,QAAb,EAAuB,UAAU1Y,SAAV,EAAqBoI,OAArB,EAA8B;AACjDiL,8BAAE1B,QAAF,CAAW,YAAY;AACnB4H,2CAAWT,eAAX,CAA2B3V,KAA3B,CAAiCoW,UAAjC,EAA6CnR,OAA7C;AACH,6BAFD;AAGH,yBAJD,EAIG,KAAK,CAJR;;AAMAsQ,mCAAW,KAAK,CAAhB;AACAC,4CAAoB,KAAK,CAAzB;AACH;;AAEDE,6BAAS7c,OAAT,GAAmBA,OAAnB;AACA6c,6BAASjd,OAAT,GAAmB,UAAUsL,KAAV,EAAiB;AAChC,4BAAI0R,eAAJ,EAAqB;AACjB;AACH;;AAEDU,+BAAOjG,EAAEnM,KAAF,CAAP;AACH,qBAND;;AAQA2R,6BAASP,OAAT,GAAmB,UAAUpR,KAAV,EAAiB;AAChC,4BAAI0R,eAAJ,EAAqB;AACjB;AACH;;AAEDU,+BAAOhB,QAAQpR,KAAR,CAAP;AACH,qBAND;AAOA2R,6BAASnZ,MAAT,GAAkB,UAAU8Z,MAAV,EAAkB;AAChC,4BAAIZ,eAAJ,EAAqB;AACjB;AACH;;AAEDU,+BAAO5Z,OAAO8Z,MAAP,CAAP;AACH,qBAND;AAOAX,6BAASY,MAAT,GAAkB,UAAUC,QAAV,EAAoB;AAClC,4BAAId,eAAJ,EAAqB;AACjB;AACH;;AAED1D,qCAAayD,iBAAb,EAAgC,UAAU3Y,SAAV,EAAqB2Z,gBAArB,EAAuC;AACnEtG,8BAAE1B,QAAF,CAAW,YAAY;AACnBgI,iDAAiBD,QAAjB;AACH,6BAFD;AAGH,yBAJD,EAIG,KAAK,CAJR;AAKH,qBAVD;;AAYA,2BAAOb,QAAP;AACH;;AAED;;;;;AAKA9c,sBAAMmG,SAAN,CAAgB0X,gBAAhB,GAAmC,YAAY;AAC3C,wBAAI7e,OAAO,IAAX;AACA,2BAAO,UAAU6H,KAAV,EAAiBsE,KAAjB,EAAwB;AAC3B,4BAAItE,KAAJ,EAAW;AACP7H,iCAAK2E,MAAL,CAAYkD,KAAZ;AACH,yBAFD,MAEO,IAAIE,UAAUtI,MAAV,GAAmB,CAAvB,EAA0B;AAC7BO,iCAAKa,OAAL,CAAaqZ,YAAYnS,SAAZ,EAAuB,CAAvB,CAAb;AACH,yBAFM,MAEA;AACH/H,iCAAKa,OAAL,CAAasL,KAAb;AACH;AACJ,qBARD;AASH,iBAXD;;AAaA;;;;;;AAMAmM,kBAAE8E,OAAF,GAAYnc,OAAZ,CAvmBe,CAumBM;AACrBqX,kBAAErX,OAAF,GAAYA,OAAZ;AACA,yBAASA,OAAT,CAAiB6d,QAAjB,EAA2B;AACvB,wBAAI,OAAOA,QAAP,KAAoB,UAAxB,EAAoC;AAChC,8BAAM,IAAItX,SAAJ,CAAc,8BAAd,CAAN;AACH;AACD,wBAAIsW,WAAW9c,OAAf;AACA,wBAAI;AACA8d,iCAAShB,SAASjd,OAAlB,EAA2Bid,SAASnZ,MAApC,EAA4CmZ,SAASY,MAArD;AACH,qBAFD,CAEE,OAAOD,MAAP,EAAe;AACbX,iCAASnZ,MAAT,CAAgB8Z,MAAhB;AACH;AACD,2BAAOX,SAAS7c,OAAhB;AACH;;AAEDA,wBAAQ8d,IAAR,GAAeA,IAAf,CAtnBe,CAsnBM;AACrB9d,wBAAQ+d,GAAR,GAAcA,GAAd,CAvnBe,CAunBI;AACnB/d,wBAAQ0D,MAAR,GAAiBA,MAAjB,CAxnBe,CAwnBU;AACzB1D,wBAAQJ,OAAR,GAAkByX,CAAlB,CAznBe,CAynBM;;AAErB;AACA;AACA;AACAA,kBAAE2G,UAAF,GAAe,UAAUhE,MAAV,EAAkB;AAC7B;AACA;AACA,2BAAOA,MAAP;AACH,iBAJD;;AAMAmC,wBAAQjW,SAAR,CAAkB8X,UAAlB,GAA+B,YAAY;AACvC;AACA;AACA,2BAAO,IAAP;AACH,iBAJD;;AAMA;;;;;;;;;AASA3G,kBAAE5S,IAAF,GAAS,UAAUyH,CAAV,EAAaC,CAAb,EAAgB;AACrB,2BAAOkL,EAAEnL,CAAF,EAAKzH,IAAL,CAAU0H,CAAV,CAAP;AACH,iBAFD;;AAIAgQ,wBAAQjW,SAAR,CAAkBzB,IAAlB,GAAyB,UAAUwZ,IAAV,EAAgB;AACrC,2BAAO5G,EAAE,CAAC,IAAD,EAAO4G,IAAP,CAAF,EAAgBC,MAAhB,CAAuB,UAAUhS,CAAV,EAAaC,CAAb,EAAgB;AAC1C,4BAAID,MAAMC,CAAV,EAAa;AACT;AACA,mCAAOD,CAAP;AACH,yBAHD,MAGO;AACH,kCAAM,IAAI/N,KAAJ,CAAU,iCAAiC+N,CAAjC,GAAqC,GAArC,GAA2CC,CAArD,CAAN;AACH;AACJ,qBAPM,CAAP;AAQH,iBATD;;AAWA;;;;;AAKAkL,kBAAEyG,IAAF,GAASA,IAAT;AACA,yBAASA,IAAT,CAAcK,QAAd,EAAwB;AACpB,2BAAOne,QAAQ,UAAUJ,OAAV,EAAmB8D,MAAnB,EAA2B;AACtC;AACA;AACA;AACA;AACA;AACA,6BAAK,IAAIzF,IAAI,CAAR,EAAWyI,MAAMyX,SAAS3f,MAA/B,EAAuCP,IAAIyI,GAA3C,EAAgDzI,GAAhD,EAAqD;AACjDoZ,8BAAE8G,SAASlgB,CAAT,CAAF,EAAemC,IAAf,CAAoBR,OAApB,EAA6B8D,MAA7B;AACH;AACJ,qBATM,CAAP;AAUH;;AAEDyY,wBAAQjW,SAAR,CAAkB4X,IAAlB,GAAyB,YAAY;AACjC,2BAAO,KAAK1d,IAAL,CAAUiX,EAAEyG,IAAZ,CAAP;AACH,iBAFD;;AAIA;;;;;;;;;;;AAWAzG,kBAAE+G,WAAF,GAAgBjC,OAAhB;AACA,yBAASA,OAAT,CAAiBtC,UAAjB,EAA6BwE,QAA7B,EAAuCjB,OAAvC,EAAgD;AAC5C,wBAAIiB,aAAa,KAAK,CAAtB,EAAyB;AACrBA,mCAAW,kBAAUta,EAAV,EAAc;AACrB,mCAAOL,OAAO,IAAIvF,KAAJ,CACV,yCAAyC4F,EAD/B,CAAP,CAAP;AAGH,yBAJD;AAKH;AACD,wBAAIqZ,YAAY,KAAK,CAArB,EAAwB;AACpBA,kCAAU,mBAAY;AAClB,mCAAO,EAACzS,OAAO,SAAR,EAAP;AACH,yBAFD;AAGH;;AAED,wBAAI3K,UAAUwZ,cAAc2C,QAAQjW,SAAtB,CAAd;;AAEAlG,4BAAQ8c,eAAR,GAA0B,UAAUld,OAAV,EAAmBmE,EAAnB,EAAuB5B,IAAvB,EAA6B;AACnD,4BAAImc,MAAJ;AACA,4BAAI;AACA,gCAAIzE,WAAW9V,EAAX,CAAJ,EAAoB;AAChBua,yCAASzE,WAAW9V,EAAX,EAAeoD,KAAf,CAAqBnH,OAArB,EAA8BmC,IAA9B,CAAT;AACH,6BAFD,MAEO;AACHmc,yCAASD,SAAS9f,IAAT,CAAcyB,OAAd,EAAuB+D,EAAvB,EAA2B5B,IAA3B,CAAT;AACH;AACJ,yBAND,CAME,OAAOgY,SAAP,EAAkB;AAChBmE,qCAAS5a,OAAOyW,SAAP,CAAT;AACH;AACD,4BAAIva,OAAJ,EAAa;AACTA,oCAAQ0e,MAAR;AACH;AACJ,qBAdD;;AAgBAte,4BAAQod,OAAR,GAAkBA,OAAlB;;AAEA;AACA,wBAAIA,OAAJ,EAAa;AACT,4BAAImB,YAAYnB,SAAhB;AACA,4BAAImB,UAAU5T,KAAV,KAAoB,UAAxB,EAAoC;AAChC3K,oCAAQma,SAAR,GAAoBoE,UAAUf,MAA9B;AACH;;AAEDxd,gCAAQgd,OAAR,GAAkB,YAAY;AAC1B,gCAAIuB,YAAYnB,SAAhB;AACA,gCAAImB,UAAU5T,KAAV,KAAoB,SAApB,IACA4T,UAAU5T,KAAV,KAAoB,UADxB,EACoC;AAChC,uCAAO3K,OAAP;AACH;AACD,mCAAOue,UAAUrT,KAAjB;AACH,yBAPD;AAQH;;AAED,2BAAOlL,OAAP;AACH;;AAEDmc,wBAAQjW,SAAR,CAAkB2C,QAAlB,GAA6B,YAAY;AACrC,2BAAO,kBAAP;AACH,iBAFD;;AAIAsT,wBAAQjW,SAAR,CAAkB9F,IAAlB,GAAyB,UAAUoe,SAAV,EAAqBC,QAArB,EAA+BC,UAA/B,EAA2C;AAChE,wBAAI3f,OAAO,IAAX;AACA,wBAAI8d,WAAW9c,OAAf;AACA,wBAAI4e,OAAO,KAAX,CAHgE,CAG5C;AACA;;AAEpB,6BAASC,UAAT,CAAoB1T,KAApB,EAA2B;AACvB,4BAAI;AACA,mCAAO,OAAOsT,SAAP,KAAqB,UAArB,GAAkCA,UAAUtT,KAAV,CAAlC,GAAqDA,KAA5D;AACH,yBAFD,CAEE,OAAOiP,SAAP,EAAkB;AAChB,mCAAOzW,OAAOyW,SAAP,CAAP;AACH;AACJ;;AAED,6BAAS0E,SAAT,CAAmB1E,SAAnB,EAA8B;AAC1B,4BAAI,OAAOsE,QAAP,KAAoB,UAAxB,EAAoC;AAChClE,+CAAmBJ,SAAnB,EAA8Bpb,IAA9B;AACA,gCAAI;AACA,uCAAO0f,SAAStE,SAAT,CAAP;AACH,6BAFD,CAEE,OAAO2E,YAAP,EAAqB;AACnB,uCAAOpb,OAAOob,YAAP,CAAP;AACH;AACJ;AACD,+BAAOpb,OAAOyW,SAAP,CAAP;AACH;;AAED,6BAAS4E,WAAT,CAAqB7T,KAArB,EAA4B;AACxB,+BAAO,OAAOwT,UAAP,KAAsB,UAAtB,GAAmCA,WAAWxT,KAAX,CAAnC,GAAuDA,KAA9D;AACH;;AAEDmM,sBAAE1B,QAAF,CAAW,YAAY;AACnB5W,6BAAK+d,eAAL,CAAqB,UAAU5R,KAAV,EAAiB;AAClC,gCAAIyT,IAAJ,EAAU;AACN;AACH;AACDA,mCAAO,IAAP;;AAEA9B,qCAASjd,OAAT,CAAiBgf,WAAW1T,KAAX,CAAjB;AACH,yBAPD,EAOG,MAPH,EAOW,CAAC,UAAUiP,SAAV,EAAqB;AAC7B,gCAAIwE,IAAJ,EAAU;AACN;AACH;AACDA,mCAAO,IAAP;;AAEA9B,qCAASjd,OAAT,CAAiBif,UAAU1E,SAAV,CAAjB;AACH,yBAPU,CAPX;AAeH,qBAhBD;;AAkBA;AACApb,yBAAK+d,eAAL,CAAqB,KAAK,CAA1B,EAA6B,MAA7B,EAAqC,CAAC,KAAK,CAAN,EAAS,UAAU5R,KAAV,EAAiB;AAC3D,4BAAI8T,QAAJ;AACA,4BAAIC,QAAQ,KAAZ;AACA,4BAAI;AACAD,uCAAWD,YAAY7T,KAAZ,CAAX;AACH,yBAFD,CAEE,OAAO1N,CAAP,EAAU;AACRyhB,oCAAQ,IAAR;AACA,gCAAI5H,EAAE7T,OAAN,EAAe;AACX6T,kCAAE7T,OAAF,CAAUhG,CAAV;AACH,6BAFD,MAEO;AACH,sCAAMA,CAAN;AACH;AACJ;;AAED,4BAAI,CAACyhB,KAAL,EAAY;AACRpC,qCAASY,MAAT,CAAgBuB,QAAhB;AACH;AACJ,qBAjBoC,CAArC;;AAmBA,2BAAOnC,SAAS7c,OAAhB;AACH,iBArED;;AAuEAqX,kBAAE6H,GAAF,GAAQ,UAAUlf,OAAV,EAAmBiD,QAAnB,EAA6B;AACjC,2BAAOoU,EAAErX,OAAF,EAAWkf,GAAX,CAAejc,QAAf,CAAP;AACH,iBAFD;;AAIA;;;;;;;;;;;;AAYAkZ,wBAAQjW,SAAR,CAAkBgZ,GAAlB,GAAwB,UAAUjc,QAAV,EAAoB;AACxCA,+BAAWoU,EAAEpU,QAAF,CAAX;;AAEA,2BAAO,KAAK7C,IAAL,CAAU,UAAU8K,KAAV,EAAiB;AAC9B,+BAAOjI,SAASkc,KAAT,CAAejU,KAAf,EAAsBkU,WAAtB,CAAkClU,KAAlC,CAAP;AACH,qBAFM,CAAP;AAGH,iBAND;;AAQA;;;;;;;;;;;;;;;;AAgBAmM,kBAAEgI,IAAF,GAASA,IAAT;AACA,yBAASA,IAAT,CAAcnU,KAAd,EAAqBsT,SAArB,EAAgCC,QAAhC,EAA0CC,UAA1C,EAAsD;AAClD,2BAAOrH,EAAEnM,KAAF,EAAS9K,IAAT,CAAcoe,SAAd,EAAyBC,QAAzB,EAAmCC,UAAnC,CAAP;AACH;;AAEDvC,wBAAQjW,SAAR,CAAkBkZ,WAAlB,GAAgC,UAAUlU,KAAV,EAAiB;AAC7C,2BAAO,KAAK9K,IAAL,CAAU,YAAY;AAAE,+BAAO8K,KAAP;AAAe,qBAAvC,CAAP;AACH,iBAFD;;AAIAmM,kBAAE+H,WAAF,GAAgB,UAAUpf,OAAV,EAAmBkL,KAAnB,EAA0B;AACtC,2BAAOmM,EAAErX,OAAF,EAAWof,WAAX,CAAuBlU,KAAvB,CAAP;AACH,iBAFD;;AAIAiR,wBAAQjW,SAAR,CAAkBoZ,UAAlB,GAA+B,UAAU9B,MAAV,EAAkB;AAC7C,2BAAO,KAAKpd,IAAL,CAAU,YAAY;AAAE,8BAAMod,MAAN;AAAe,qBAAvC,CAAP;AACH,iBAFD;;AAIAnG,kBAAEiI,UAAF,GAAe,UAAUtf,OAAV,EAAmBwd,MAAnB,EAA2B;AACtC,2BAAOnG,EAAErX,OAAF,EAAWsf,UAAX,CAAsB9B,MAAtB,CAAP;AACH,iBAFD;;AAIA;;;;;;;;;;AAUA;AACAnG,kBAAE6F,MAAF,GAAWA,MAAX;AACA,yBAASA,MAAT,CAAgBhS,KAAhB,EAAuB;AACnB,wBAAIiS,UAAUjS,KAAV,CAAJ,EAAsB;AAClB,4BAAIqT,YAAYrT,MAAMkS,OAAN,EAAhB;AACA,4BAAImB,UAAU5T,KAAV,KAAoB,WAAxB,EAAqC;AACjC,mCAAO4T,UAAUrT,KAAjB;AACH;AACJ;AACD,2BAAOA,KAAP;AACH;;AAED;;;;AAIAmM,kBAAE8F,SAAF,GAAcA,SAAd;AACA,yBAASA,SAAT,CAAmBnD,MAAnB,EAA2B;AACvB,2BAAOA,kBAAkBmC,OAAzB;AACH;;AAED9E,kBAAE+E,cAAF,GAAmBA,cAAnB;AACA,yBAASA,cAAT,CAAwBpC,MAAxB,EAAgC;AAC5B,2BAAOnT,SAASmT,MAAT,KAAoB,OAAOA,OAAO5Z,IAAd,KAAuB,UAAlD;AACH;;AAED;;;;AAIAiX,kBAAEkI,SAAF,GAAcA,SAAd;AACA,yBAASA,SAAT,CAAmBvF,MAAnB,EAA2B;AACvB,2BAAOmD,UAAUnD,MAAV,KAAqBA,OAAOoD,OAAP,GAAiBzS,KAAjB,KAA2B,SAAvD;AACH;;AAEDwR,wBAAQjW,SAAR,CAAkBqZ,SAAlB,GAA8B,YAAY;AACtC,2BAAO,KAAKnC,OAAL,GAAezS,KAAf,KAAyB,SAAhC;AACH,iBAFD;;AAIA;;;;AAIA0M,kBAAEmI,WAAF,GAAgBA,WAAhB;AACA,yBAASA,WAAT,CAAqBxF,MAArB,EAA6B;AACzB,2BAAO,CAACmD,UAAUnD,MAAV,CAAD,IAAsBA,OAAOoD,OAAP,GAAiBzS,KAAjB,KAA2B,WAAxD;AACH;;AAEDwR,wBAAQjW,SAAR,CAAkBsZ,WAAlB,GAAgC,YAAY;AACxC,2BAAO,KAAKpC,OAAL,GAAezS,KAAf,KAAyB,WAAhC;AACH,iBAFD;;AAIA;;;AAGA0M,kBAAEoI,UAAF,GAAeA,UAAf;AACA,yBAASA,UAAT,CAAoBzF,MAApB,EAA4B;AACxB,2BAAOmD,UAAUnD,MAAV,KAAqBA,OAAOoD,OAAP,GAAiBzS,KAAjB,KAA2B,UAAvD;AACH;;AAEDwR,wBAAQjW,SAAR,CAAkBuZ,UAAlB,GAA+B,YAAY;AACvC,2BAAO,KAAKrC,OAAL,GAAezS,KAAf,KAAyB,UAAhC;AACH,iBAFD;;AAIA;;AAEA;AACA;AACA;AACA;AACA,oBAAI+U,mBAAmB,EAAvB;AACA,oBAAIC,sBAAsB,EAA1B;AACA,oBAAIC,8BAA8B,EAAlC;AACA,oBAAIC,2BAA2B,IAA/B;;AAEA,yBAASC,wBAAT,GAAoC;AAChCJ,qCAAiBlhB,MAAjB,GAA0B,CAA1B;AACAmhB,wCAAoBnhB,MAApB,GAA6B,CAA7B;;AAEA,wBAAI,CAACqhB,wBAAL,EAA+B;AAC3BA,mDAA2B,IAA3B;AACH;AACJ;;AAED,yBAASE,cAAT,CAAwB/f,OAAxB,EAAiCwd,MAAjC,EAAyC;AACrC,wBAAI,CAACqC,wBAAL,EAA+B;AAC3B;AACH;AACD,wBAAI,QAAOrL,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOA,QAAQ/Q,IAAf,KAAwB,UAA3D,EAAuE;AACnE4T,0BAAE1B,QAAF,CAAWmD,QAAX,CAAoB,YAAY;AAC5B,gCAAIM,cAAcuG,mBAAd,EAAmC3f,OAAnC,MAAgD,CAAC,CAArD,EAAwD;AACpDwU,wCAAQ/Q,IAAR,CAAa,oBAAb,EAAmC+Z,MAAnC,EAA2Cxd,OAA3C;AACA4f,4DAA4BpY,IAA5B,CAAiCxH,OAAjC;AACH;AACJ,yBALD;AAMH;;AAED2f,wCAAoBnY,IAApB,CAAyBxH,OAAzB;AACA,wBAAIwd,UAAU,OAAOA,OAAOhG,KAAd,KAAwB,WAAtC,EAAmD;AAC/CkI,yCAAiBlY,IAAjB,CAAsBgW,OAAOhG,KAA7B;AACH,qBAFD,MAEO;AACHkI,yCAAiBlY,IAAjB,CAAsB,gBAAgBgW,MAAtC;AACH;AACJ;;AAED,yBAASwC,gBAAT,CAA0BhgB,OAA1B,EAAmC;AAC/B,wBAAI,CAAC6f,wBAAL,EAA+B;AAC3B;AACH;;AAED,wBAAII,KAAK7G,cAAcuG,mBAAd,EAAmC3f,OAAnC,CAAT;AACA,wBAAIigB,OAAO,CAAC,CAAZ,EAAe;AACX,4BAAI,QAAOzL,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+B,OAAOA,QAAQ/Q,IAAf,KAAwB,UAA3D,EAAuE;AACnE4T,8BAAE1B,QAAF,CAAWmD,QAAX,CAAoB,YAAY;AAC5B,oCAAIoH,WAAW9G,cAAcwG,2BAAd,EAA2C5f,OAA3C,CAAf;AACA,oCAAIkgB,aAAa,CAAC,CAAlB,EAAqB;AACjB1L,4CAAQ/Q,IAAR,CAAa,kBAAb,EAAiCic,iBAAiBO,EAAjB,CAAjC,EAAuDjgB,OAAvD;AACA4f,gEAA4B1X,MAA5B,CAAmCgY,QAAnC,EAA6C,CAA7C;AACH;AACJ,6BAND;AAOH;AACDP,4CAAoBzX,MAApB,CAA2B+X,EAA3B,EAA+B,CAA/B;AACAP,yCAAiBxX,MAAjB,CAAwB+X,EAAxB,EAA4B,CAA5B;AACH;AACJ;;AAED5I,kBAAEyI,wBAAF,GAA6BA,wBAA7B;;AAEAzI,kBAAE8I,mBAAF,GAAwB,YAAY;AAChC;AACA,2BAAOT,iBAAiBxY,KAAjB,EAAP;AACH,iBAHD;;AAKAmQ,kBAAE+I,8BAAF,GAAmC,YAAY;AAC3CN;AACAD,+CAA2B,KAA3B;AACH,iBAHD;;AAKAC;;AAEA;;AAEA;;;;AAIAzI,kBAAE3T,MAAF,GAAWA,MAAX;AACA,yBAASA,MAAT,CAAgB8Z,MAAhB,EAAwB;AACpB,wBAAI6C,YAAYlE,QAAQ;AACpB,gCAAQ,cAAUsC,QAAV,EAAoB;AACxB;AACA,gCAAIA,QAAJ,EAAc;AACVuB,iDAAiB,IAAjB;AACH;AACD,mCAAOvB,WAAWA,SAASjB,MAAT,CAAX,GAA8B,IAArC;AACH;AAPmB,qBAAR,EAQb,SAASa,QAAT,GAAoB;AACnB,+BAAO,IAAP;AACH,qBAVe,EAUb,SAASjB,OAAT,GAAmB;AAClB,+BAAO,EAAEzS,OAAO,UAAT,EAAqB6S,QAAQA,MAA7B,EAAP;AACH,qBAZe,CAAhB;;AAcA;AACAuC,mCAAeM,SAAf,EAA0B7C,MAA1B;;AAEA,2BAAO6C,SAAP;AACH;;AAED;;;;AAIAhJ,kBAAEiF,OAAF,GAAYA,OAAZ;AACA,yBAASA,OAAT,CAAiBpR,KAAjB,EAAwB;AACpB,2BAAOiR,QAAQ;AACX,gCAAQ,gBAAY;AAChB,mCAAOjR,KAAP;AACH,yBAHU;AAIX,+BAAO,aAAU9B,IAAV,EAAgB;AACnB,mCAAO8B,MAAM9B,IAAN,CAAP;AACH,yBANU;AAOX,+BAAO,aAAUA,IAAV,EAAgBkX,GAAhB,EAAqB;AACxBpV,kCAAM9B,IAAN,IAAckX,GAAd;AACH,yBATU;AAUX,kCAAU,iBAAUlX,IAAV,EAAgB;AACtB,mCAAO8B,MAAM9B,IAAN,CAAP;AACH,yBAZU;AAaX,gCAAQ,cAAUA,IAAV,EAAgBjH,IAAhB,EAAsB;AAC1B;AACA;AACA,gCAAIiH,SAAS,IAAT,IAAiBA,SAAS,KAAK,CAAnC,EAAsC;AAClC,uCAAO8B,MAAM/D,KAAN,CAAY,KAAK,CAAjB,EAAoBhF,IAApB,CAAP;AACH,6BAFD,MAEO;AACH,uCAAO+I,MAAM9B,IAAN,EAAYjC,KAAZ,CAAkB+D,KAAlB,EAAyB/I,IAAzB,CAAP;AACH;AACJ,yBArBU;AAsBX,iCAAS,eAAUmX,KAAV,EAAiBnX,IAAjB,EAAuB;AAC5B,mCAAO+I,MAAM/D,KAAN,CAAYmS,KAAZ,EAAmBnX,IAAnB,CAAP;AACH,yBAxBU;AAyBX,gCAAQ,gBAAY;AAChB,mCAAO4X,YAAY7O,KAAZ,CAAP;AACH;AA3BU,qBAAR,EA4BJ,KAAK,CA5BD,EA4BI,SAASkS,OAAT,GAAmB;AAC1B,+BAAO,EAAEzS,OAAO,WAAT,EAAsBO,OAAOA,KAA7B,EAAP;AACH,qBA9BM,CAAP;AA+BH;;AAED;;;;;AAKA,yBAASmR,MAAT,CAAgBrc,OAAhB,EAAyB;AACrB,wBAAI6c,WAAW9c,OAAf;AACAsX,sBAAE1B,QAAF,CAAW,YAAY;AACnB,4BAAI;AACA3V,oCAAQI,IAAR,CAAayc,SAASjd,OAAtB,EAA+Bid,SAASnZ,MAAxC,EAAgDmZ,SAASY,MAAzD;AACH,yBAFD,CAEE,OAAOtD,SAAP,EAAkB;AAChB0C,qCAASnZ,MAAT,CAAgByW,SAAhB;AACH;AACJ,qBAND;AAOA,2BAAO0C,SAAS7c,OAAhB;AACH;;AAED;;;;;;;;;AASAqX,kBAAEkJ,MAAF,GAAWA,MAAX;AACA,yBAASA,MAAT,CAAgBvG,MAAhB,EAAwB;AACpB,2BAAOmC,QAAQ;AACX,iCAAS,iBAAY,CAAE;AADZ,qBAAR,EAEJ,SAASkC,QAAT,CAAkBta,EAAlB,EAAsB5B,IAAtB,EAA4B;AAC3B,+BAAOqe,SAASxG,MAAT,EAAiBjW,EAAjB,EAAqB5B,IAArB,CAAP;AACH,qBAJM,EAIJ,YAAY;AACX,+BAAOkV,EAAE2C,MAAF,EAAUoD,OAAV,EAAP;AACH,qBANM,CAAP;AAOH;;AAED;;;;;;;;;;AAUA/F,kBAAE6G,MAAF,GAAWA,MAAX;AACA,yBAASA,MAAT,CAAgBhT,KAAhB,EAAuBsT,SAAvB,EAAkCC,QAAlC,EAA4C;AACxC,2BAAOpH,EAAEnM,KAAF,EAASgT,MAAT,CAAgBM,SAAhB,EAA2BC,QAA3B,CAAP;AACH;;AAEDtC,wBAAQjW,SAAR,CAAkBgY,MAAlB,GAA2B,UAAUM,SAAV,EAAqBC,QAArB,EAA+B;AACtD,2BAAO,KAAKV,GAAL,GAAW3d,IAAX,CAAgB,UAAUsJ,KAAV,EAAiB;AACpC,+BAAO8U,UAAUrX,KAAV,CAAgB,KAAK,CAArB,EAAwBuC,KAAxB,CAAP;AACH,qBAFM,EAEJ+U,QAFI,CAAP;AAGH,iBAJD;;AAMA;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BApH,kBAAEoJ,KAAF,GAAUA,KAAV;AACA,yBAASA,KAAT,CAAeC,aAAf,EAA8B;AAC1B,2BAAO,YAAY;AACf;AACA;AACA,iCAASC,SAAT,CAAmBC,IAAnB,EAAyBnY,GAAzB,EAA8B;AAC1B,gCAAI6V,MAAJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gCAAI,OAAOuC,aAAP,KAAyB,WAA7B,EAA0C;AACtC;AACA,oCAAI;AACAvC,6CAASwC,UAAUF,IAAV,EAAgBnY,GAAhB,CAAT;AACH,iCAFD,CAEE,OAAO0R,SAAP,EAAkB;AAChB,2CAAOzW,OAAOyW,SAAP,CAAP;AACH;AACD,oCAAImE,OAAOK,IAAX,EAAiB;AACb,2CAAOtH,EAAEiH,OAAOpT,KAAT,CAAP;AACH,iCAFD,MAEO;AACH,2CAAOmU,KAAKf,OAAOpT,KAAZ,EAAmBjI,QAAnB,EAA6B8d,OAA7B,CAAP;AACH;AACJ,6BAZD,MAYO;AACH;AACA;AACA,oCAAI;AACAzC,6CAASwC,UAAUF,IAAV,EAAgBnY,GAAhB,CAAT;AACH,iCAFD,CAEE,OAAO0R,SAAP,EAAkB;AAChB,wCAAID,gBAAgBC,SAAhB,CAAJ,EAAgC;AAC5B,+CAAO9C,EAAE8C,UAAUjP,KAAZ,CAAP;AACH,qCAFD,MAEO;AACH,+CAAOxH,OAAOyW,SAAP,CAAP;AACH;AACJ;AACD,uCAAOkF,KAAKf,MAAL,EAAarb,QAAb,EAAuB8d,OAAvB,CAAP;AACH;AACJ;AACD,4BAAID,YAAYJ,cAAcvZ,KAAd,CAAoB,IAApB,EAA0BL,SAA1B,CAAhB;AACA,4BAAI7D,WAAW0d,UAAUpQ,IAAV,CAAeoQ,SAAf,EAA0B,MAA1B,CAAf;AACA,4BAAII,UAAUJ,UAAUpQ,IAAV,CAAeoQ,SAAf,EAA0B,OAA1B,CAAd;AACA,+BAAO1d,UAAP;AACH,qBA7CD;AA8CH;;AAED;;;;;;;AAOAoU,kBAAE2J,KAAF,GAAUA,KAAV;AACA,yBAASA,KAAT,CAAeN,aAAf,EAA8B;AAC1BrJ,sBAAEsH,IAAF,CAAOtH,EAAEoJ,KAAF,CAAQC,aAAR,GAAP;AACH;;AAED;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAwBArJ,kBAAE,QAAF,IAAc4J,OAAd;AACA,yBAASA,OAAT,CAAiB/V,KAAjB,EAAwB;AACpB,0BAAM,IAAIkP,YAAJ,CAAiBlP,KAAjB,CAAN;AACH;;AAED;;;;;;;;;;;;;;;AAeAmM,kBAAE6J,QAAF,GAAaA,QAAb;AACA,yBAASA,QAAT,CAAkBje,QAAlB,EAA4B;AACxB,2BAAO,YAAY;AACf,+BAAOib,OAAO,CAAC,IAAD,EAAOH,IAAIjX,SAAJ,CAAP,CAAP,EAA+B,UAAU/H,IAAV,EAAgBoD,IAAhB,EAAsB;AACxD,mCAAOc,SAASkE,KAAT,CAAepI,IAAf,EAAqBoD,IAArB,CAAP;AACH,yBAFM,CAAP;AAGH,qBAJD;AAKH;;AAED;;;;;;;AAOAkV,kBAAEmJ,QAAF,GAAaA,QAAb;AACA,yBAASA,QAAT,CAAkBxG,MAAlB,EAA0BjW,EAA1B,EAA8B5B,IAA9B,EAAoC;AAChC,2BAAOkV,EAAE2C,MAAF,EAAUwG,QAAV,CAAmBzc,EAAnB,EAAuB5B,IAAvB,CAAP;AACH;;AAEDga,wBAAQjW,SAAR,CAAkBsa,QAAlB,GAA6B,UAAUzc,EAAV,EAAc5B,IAAd,EAAoB;AAC7C,wBAAIpD,OAAO,IAAX;AACA,wBAAI8d,WAAW9c,OAAf;AACAsX,sBAAE1B,QAAF,CAAW,YAAY;AACnB5W,6BAAK+d,eAAL,CAAqBD,SAASjd,OAA9B,EAAuCmE,EAAvC,EAA2C5B,IAA3C;AACH,qBAFD;AAGA,2BAAO0a,SAAS7c,OAAhB;AACH,iBAPD;;AASA;;;;;;AAMAqX,kBAAEpX,GAAF,GAAQ,UAAU+Z,MAAV,EAAkB5R,GAAlB,EAAuB;AAC3B,2BAAOiP,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,KAAnB,EAA0B,CAACpY,GAAD,CAA1B,CAAP;AACH,iBAFD;;AAIA+T,wBAAQjW,SAAR,CAAkBjG,GAAlB,GAAwB,UAAUmI,GAAV,EAAe;AACnC,2BAAO,KAAKoY,QAAL,CAAc,KAAd,EAAqB,CAACpY,GAAD,CAArB,CAAP;AACH,iBAFD;;AAIA;;;;;;;AAOAiP,kBAAEhX,GAAF,GAAQ,UAAU2Z,MAAV,EAAkB5R,GAAlB,EAAuB8C,KAAvB,EAA8B;AAClC,2BAAOmM,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,KAAnB,EAA0B,CAACpY,GAAD,EAAM8C,KAAN,CAA1B,CAAP;AACH,iBAFD;;AAIAiR,wBAAQjW,SAAR,CAAkB7F,GAAlB,GAAwB,UAAU+H,GAAV,EAAe8C,KAAf,EAAsB;AAC1C,2BAAO,KAAKsV,QAAL,CAAc,KAAd,EAAqB,CAACpY,GAAD,EAAM8C,KAAN,CAArB,CAAP;AACH,iBAFD;;AAIA;;;;;;AAMAmM,kBAAE8J,GAAF,GAAQ;AACR9J,kBAAE,QAAF,IAAc,UAAU2C,MAAV,EAAkB5R,GAAlB,EAAuB;AACjC,2BAAOiP,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,QAAnB,EAA6B,CAACpY,GAAD,CAA7B,CAAP;AACH,iBAHD;;AAKA+T,wBAAQjW,SAAR,CAAkBib,GAAlB,GAAwB;AACxBhF,wBAAQjW,SAAR,CAAkB,QAAlB,IAA8B,UAAUkC,GAAV,EAAe;AACzC,2BAAO,KAAKoY,QAAL,CAAc,QAAd,EAAwB,CAACpY,GAAD,CAAxB,CAAP;AACH,iBAHD;;AAKA;;;;;;;;;;;;AAYA;AACAiP,kBAAE+J,MAAF,GAAW;AACX/J,kBAAEgK,IAAF,GAAS,UAAUrH,MAAV,EAAkB5Q,IAAlB,EAAwBjH,IAAxB,EAA8B;AACnC,2BAAOkV,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,MAAnB,EAA2B,CAACpX,IAAD,EAAOjH,IAAP,CAA3B,CAAP;AACH,iBAHD;;AAKAga,wBAAQjW,SAAR,CAAkBkb,MAAlB,GAA2B;AAC3BjF,wBAAQjW,SAAR,CAAkBmb,IAAlB,GAAyB,UAAUjY,IAAV,EAAgBjH,IAAhB,EAAsB;AAC3C,2BAAO,KAAKqe,QAAL,CAAc,MAAd,EAAsB,CAACpX,IAAD,EAAOjH,IAAP,CAAtB,CAAP;AACH,iBAHD;;AAKA;;;;;;;AAOAkV,kBAAEhU,IAAF,GAAS;AACTgU,kBAAEiK,KAAF,GAAU;AACVjK,kBAAEkK,MAAF,GAAW,UAAUvH,MAAV,EAAkB5Q,IAAlB,CAAuB,WAAvB,EAAoC;AAC3C,2BAAOiO,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,MAAnB,EAA2B,CAACpX,IAAD,EAAO6P,YAAYnS,SAAZ,EAAuB,CAAvB,CAAP,CAA3B,CAAP;AACH,iBAJD;;AAMAqV,wBAAQjW,SAAR,CAAkB7C,IAAlB,GAAyB;AACzB8Y,wBAAQjW,SAAR,CAAkBob,KAAlB,GAA0B;AAC1BnF,wBAAQjW,SAAR,CAAkBqb,MAAlB,GAA2B,UAAUnY,IAAV,CAAe,WAAf,EAA4B;AACnD,2BAAO,KAAKoX,QAAL,CAAc,MAAd,EAAsB,CAACpX,IAAD,EAAO6P,YAAYnS,SAAZ,EAAuB,CAAvB,CAAP,CAAtB,CAAP;AACH,iBAJD;;AAMA;;;;;AAKAuQ,kBAAEmK,MAAF,GAAW,UAAUxH,MAAV,EAAkB7X,IAAlB,EAAwB;AAC/B,2BAAOkV,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,OAAnB,EAA4B,CAAC,KAAK,CAAN,EAASre,IAAT,CAA5B,CAAP;AACH,iBAFD;;AAIAga,wBAAQjW,SAAR,CAAkBsb,MAAlB,GAA2B,UAAUrf,IAAV,EAAgB;AACvC,2BAAO,KAAKqe,QAAL,CAAc,OAAd,EAAuB,CAAC,KAAK,CAAN,EAASre,IAAT,CAAvB,CAAP;AACH,iBAFD;;AAIA;;;;;AAKAkV,kBAAE,KAAF,IACAA,EAAE8H,KAAF,GAAU,UAAUnF,MAAV,CAAiB,YAAjB,EAA+B;AACrC,2BAAO3C,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,OAAnB,EAA4B,CAAC,KAAK,CAAN,EAASvH,YAAYnS,SAAZ,EAAuB,CAAvB,CAAT,CAA5B,CAAP;AACH,iBAHD;;AAKAqV,wBAAQjW,SAAR,CAAkBiZ,KAAlB,GAA0B,YAAU,WAAa;AAC7C,2BAAO,KAAKqB,QAAL,CAAc,OAAd,EAAuB,CAAC,KAAK,CAAN,EAASvH,YAAYnS,SAAZ,CAAT,CAAvB,CAAP;AACH,iBAFD;;AAIA;;;;;;AAMAuQ,kBAAEoK,KAAF,GAAU,UAAUzH,MAAV,CAAiB,WAAjB,EAA8B;AACpC,wBAAIha,UAAUqX,EAAE2C,MAAF,CAAd;AACA,wBAAI7X,OAAO8W,YAAYnS,SAAZ,EAAuB,CAAvB,CAAX;AACA,2BAAO,SAAS4a,MAAT,GAAkB;AACrB,+BAAO1hB,QAAQwgB,QAAR,CAAiB,OAAjB,EAA0B,CAC7B,IAD6B,EAE7Bre,KAAKwC,MAAL,CAAYsU,YAAYnS,SAAZ,CAAZ,CAF6B,CAA1B,CAAP;AAIH,qBALD;AAMH,iBATD;AAUAqV,wBAAQjW,SAAR,CAAkBub,KAAlB,GAA0B,YAAU,WAAa;AAC7C,wBAAIzhB,UAAU,IAAd;AACA,wBAAImC,OAAO8W,YAAYnS,SAAZ,CAAX;AACA,2BAAO,SAAS4a,MAAT,GAAkB;AACrB,+BAAO1hB,QAAQwgB,QAAR,CAAiB,OAAjB,EAA0B,CAC7B,IAD6B,EAE7Bre,KAAKwC,MAAL,CAAYsU,YAAYnS,SAAZ,CAAZ,CAF6B,CAA1B,CAAP;AAIH,qBALD;AAMH,iBATD;;AAWA;;;;;;AAMAuQ,kBAAEjS,IAAF,GAAS,UAAU4U,MAAV,EAAkB;AACvB,2BAAO3C,EAAE2C,MAAF,EAAUwG,QAAV,CAAmB,MAAnB,EAA2B,EAA3B,CAAP;AACH,iBAFD;;AAIArE,wBAAQjW,SAAR,CAAkBd,IAAlB,GAAyB,YAAY;AACjC,2BAAO,KAAKob,QAAL,CAAc,MAAd,EAAsB,EAAtB,CAAP;AACH,iBAFD;;AAIA;;;;;;;AAOA;AACA;AACAnJ,kBAAE0G,GAAF,GAAQA,GAAR;AACA,yBAASA,GAAT,CAAa4D,QAAb,EAAuB;AACnB,2BAAOtC,KAAKsC,QAAL,EAAe,UAAUA,QAAV,EAAoB;AACtC,4BAAIC,eAAe,CAAnB;AACA,4BAAI/E,WAAW9c,OAAf;AACAmZ,qCAAayI,QAAb,EAAuB,UAAU3d,SAAV,EAAqBhE,OAArB,EAA8ByN,KAA9B,EAAqC;AACxD,gCAAIoU,QAAJ;AACA,gCACI1E,UAAUnd,OAAV,KACA,CAAC6hB,WAAW7hB,QAAQod,OAAR,EAAZ,EAA+BzS,KAA/B,KAAyC,WAF7C,EAGE;AACEgX,yCAASlU,KAAT,IAAkBoU,SAAS3W,KAA3B;AACH,6BALD,MAKO;AACH,kCAAE0W,YAAF;AACAvC,qCACIrf,OADJ,EAEI,UAAUkL,KAAV,EAAiB;AACbyW,6CAASlU,KAAT,IAAkBvC,KAAlB;AACA,wCAAI,EAAE0W,YAAF,KAAmB,CAAvB,EAA0B;AACtB/E,iDAASjd,OAAT,CAAiB+hB,QAAjB;AACH;AACJ,iCAPL,EAQI9E,SAASnZ,MARb,EASI,UAAUga,QAAV,EAAoB;AAChBb,6CAASY,MAAT,CAAgB,EAAEhQ,OAAOA,KAAT,EAAgBvC,OAAOwS,QAAvB,EAAhB;AACH,iCAXL;AAaH;AACJ,yBAvBD,EAuBG,KAAK,CAvBR;AAwBA,4BAAIkE,iBAAiB,CAArB,EAAwB;AACpB/E,qCAASjd,OAAT,CAAiB+hB,QAAjB;AACH;AACD,+BAAO9E,SAAS7c,OAAhB;AACH,qBA/BM,CAAP;AAgCH;;AAEDmc,wBAAQjW,SAAR,CAAkB6X,GAAlB,GAAwB,YAAY;AAChC,2BAAOA,IAAI,IAAJ,CAAP;AACH,iBAFD;;AAIA;;;;;;;AAOA1G,kBAAEyK,GAAF,GAAQA,GAAR;;AAEA,yBAASA,GAAT,CAAaH,QAAb,EAAuB;AACnB,wBAAIA,SAASnjB,MAAT,KAAoB,CAAxB,EAA2B;AACvB,+BAAO6Y,EAAEzX,OAAF,EAAP;AACH;;AAED,wBAAIid,WAAWxF,EAAEtX,KAAF,EAAf;AACA,wBAAI6hB,eAAe,CAAnB;AACA1I,iCAAayI,QAAb,EAAuB,UAAU1N,IAAV,EAAgB8N,OAAhB,EAAyBtU,KAAzB,EAAgC;AACnD,4BAAIzN,UAAU2hB,SAASlU,KAAT,CAAd;;AAEAmU;;AAEAvC,6BAAKrf,OAAL,EAAcgiB,WAAd,EAA2BC,UAA3B,EAAuCC,UAAvC;AACA,iCAASF,WAAT,CAAqB1D,MAArB,EAA6B;AACzBzB,qCAASjd,OAAT,CAAiB0e,MAAjB;AACH;AACD,iCAAS2D,UAAT,CAAoB3f,GAApB,EAAyB;AACrBsf;AACA,gCAAIA,iBAAiB,CAArB,EAAwB;AACpBtf,oCAAI8J,OAAJ,GAAe,yDACX,8CADW,GACsC9J,IAAI8J,OADzD;AAEAyQ,yCAASnZ,MAAT,CAAgBpB,GAAhB;AACH;AACJ;AACD,iCAAS4f,UAAT,CAAoBxE,QAApB,EAA8B;AAC1Bb,qCAASY,MAAT,CAAgB;AACZhQ,uCAAOA,KADK;AAEZvC,uCAAOwS;AAFK,6BAAhB;AAIH;AACJ,qBAvBD,EAuBG1Z,SAvBH;;AAyBA,2BAAO6Y,SAAS7c,OAAhB;AACH;;AAEDmc,wBAAQjW,SAAR,CAAkB4b,GAAlB,GAAwB,YAAY;AAChC,2BAAOA,IAAI,IAAJ,CAAP;AACH,iBAFD;;AAIA;;;;;;;;;AASAzK,kBAAE8K,WAAF,GAAgBnG,UAAUmG,WAAV,EAAuB,aAAvB,EAAsC,YAAtC,CAAhB;AACA,yBAASA,WAAT,CAAqBR,QAArB,EAA+B;AAC3B,2BAAOtC,KAAKsC,QAAL,EAAe,UAAUA,QAAV,EAAoB;AACtCA,mCAAWtI,UAAUsI,QAAV,EAAoBtK,CAApB,CAAX;AACA,+BAAOgI,KAAKtB,IAAI1E,UAAUsI,QAAV,EAAoB,UAAU3hB,OAAV,EAAmB;AACnD,mCAAOqf,KAAKrf,OAAL,EAAcmW,IAAd,EAAoBA,IAApB,CAAP;AACH,yBAFe,CAAJ,CAAL,EAEF,YAAY;AACb,mCAAOwL,QAAP;AACH,yBAJM,CAAP;AAKH,qBAPM,CAAP;AAQH;;AAEDxF,wBAAQjW,SAAR,CAAkBic,WAAlB,GAAgC,YAAY;AACxC,2BAAOA,YAAY,IAAZ,CAAP;AACH,iBAFD;;AAIA;;;AAGA9K,kBAAE+K,UAAF,GAAeA,UAAf;AACA,yBAASA,UAAT,CAAoBT,QAApB,EAA8B;AAC1B,2BAAOtK,EAAEsK,QAAF,EAAYS,UAAZ,EAAP;AACH;;AAED;;;;;;;AAOAjG,wBAAQjW,SAAR,CAAkBkc,UAAlB,GAA+B,YAAY;AACvC,2BAAO,KAAKhiB,IAAL,CAAU,UAAUuhB,QAAV,EAAoB;AACjC,+BAAO5D,IAAI1E,UAAUsI,QAAV,EAAoB,UAAU3hB,OAAV,EAAmB;AAC9CA,sCAAUqX,EAAErX,OAAF,CAAV;AACA,qCAASqiB,UAAT,GAAsB;AAClB,uCAAOriB,QAAQod,OAAR,EAAP;AACH;AACD,mCAAOpd,QAAQI,IAAR,CAAaiiB,UAAb,EAAyBA,UAAzB,CAAP;AACH,yBANU,CAAJ,CAAP;AAOH,qBARM,CAAP;AASH,iBAVD;;AAYA;;;;;;;;;AASAhL,kBAAEiL,IAAF,GAAS;AACTjL,kBAAE,OAAF,IAAa,UAAU2C,MAAV,EAAkByE,QAAlB,EAA4B;AACrC,2BAAOpH,EAAE2C,MAAF,EAAU5Z,IAAV,CAAe,KAAK,CAApB,EAAuBqe,QAAvB,CAAP;AACH,iBAHD;;AAKAtC,wBAAQjW,SAAR,CAAkBoc,IAAlB,GAAyB;AACzBnG,wBAAQjW,SAAR,CAAkB,OAAlB,IAA6B,UAAUuY,QAAV,EAAoB;AAC7C,2BAAO,KAAKre,IAAL,CAAU,KAAK,CAAf,EAAkBqe,QAAlB,CAAP;AACH,iBAHD;;AAKA;;;;;;;;AAQApH,kBAAEqG,QAAF,GAAaA,QAAb;AACA,yBAASA,QAAT,CAAkB1D,MAAlB,EAA0B0E,UAA1B,EAAsC;AAClC,2BAAOrH,EAAE2C,MAAF,EAAU5Z,IAAV,CAAe,KAAK,CAApB,EAAuB,KAAK,CAA5B,EAA+Bse,UAA/B,CAAP;AACH;;AAEDvC,wBAAQjW,SAAR,CAAkBwX,QAAlB,GAA6B,UAAUgB,UAAV,EAAsB;AAC/C,2BAAO,KAAKte,IAAL,CAAU,KAAK,CAAf,EAAkB,KAAK,CAAvB,EAA0Bse,UAA1B,CAAP;AACH,iBAFD;;AAIA;;;;;;;;;;;AAWArH,kBAAEkL,GAAF,GAAQ;AACRlL,kBAAE,SAAF,IAAe,UAAU2C,MAAV,EAAkB/W,QAAlB,EAA4B;AACvC,2BAAOoU,EAAE2C,MAAF,EAAU,SAAV,EAAqB/W,QAArB,CAAP;AACH,iBAHD;;AAKAkZ,wBAAQjW,SAAR,CAAkBqc,GAAlB,GAAwB;AACxBpG,wBAAQjW,SAAR,CAAkB,SAAlB,IAA+B,UAAUjD,QAAV,EAAoB;AAC/C,wBAAI,CAACA,QAAD,IAAa,OAAOA,SAASkE,KAAhB,KAA0B,UAA3C,EAAuD;AACnD,8BAAM,IAAIhJ,KAAJ,CAAU,gCAAV,CAAN;AACH;AACD8E,+BAAWoU,EAAEpU,QAAF,CAAX;AACA,2BAAO,KAAK7C,IAAL,CAAU,UAAU8K,KAAV,EAAiB;AAC9B,+BAAOjI,SAASkc,KAAT,GAAiB/e,IAAjB,CAAsB,YAAY;AACrC,mCAAO8K,KAAP;AACH,yBAFM,CAAP;AAGH,qBAJM,EAIJ,UAAUsS,MAAV,EAAkB;AACjB;AACA,+BAAOva,SAASkc,KAAT,GAAiB/e,IAAjB,CAAsB,YAAY;AACrC,kCAAMod,MAAN;AACH,yBAFM,CAAP;AAGH,qBATM,CAAP;AAUH,iBAhBD;;AAkBA;;;;;;AAMAnG,kBAAEsH,IAAF,GAAS,UAAU3E,MAAV,EAAkBwE,SAAlB,EAA6BC,QAA7B,EAAuCf,QAAvC,EAAiD;AACtD,2BAAOrG,EAAE2C,MAAF,EAAU2E,IAAV,CAAeH,SAAf,EAA0BC,QAA1B,EAAoCf,QAApC,CAAP;AACH,iBAFD;;AAIAvB,wBAAQjW,SAAR,CAAkByY,IAAlB,GAAyB,UAAUH,SAAV,EAAqBC,QAArB,EAA+Bf,QAA/B,EAAyC;AAC9D,wBAAI8E,mBAAmB,0BAAU5b,KAAV,EAAiB;AACpC;AACA;AACAyQ,0BAAE1B,QAAF,CAAW,YAAY;AACnB4E,+CAAmB3T,KAAnB,EAA0B5G,OAA1B;AACA,gCAAIqX,EAAE7T,OAAN,EAAe;AACX6T,kCAAE7T,OAAF,CAAUoD,KAAV;AACH,6BAFD,MAEO;AACH,sCAAMA,KAAN;AACH;AACJ,yBAPD;AAQH,qBAXD;;AAaA;AACA,wBAAI5G,UAAUwe,aAAaC,QAAb,IAAyBf,QAAzB,GACV,KAAKtd,IAAL,CAAUoe,SAAV,EAAqBC,QAArB,EAA+Bf,QAA/B,CADU,GAEV,IAFJ;;AAIA,wBAAI,QAAOlJ,OAAP,yCAAOA,OAAP,OAAmB,QAAnB,IAA+BA,OAA/B,IAA0CA,QAAQ4D,MAAtD,EAA8D;AAC1DoK,2CAAmBhO,QAAQ4D,MAAR,CAAe7H,IAAf,CAAoBiS,gBAApB,CAAnB;AACH;;AAEDxiB,4BAAQI,IAAR,CAAa,KAAK,CAAlB,EAAqBoiB,gBAArB;AACH,iBAxBD;;AA0BA;;;;;;;;;AASAnL,kBAAE5B,OAAF,GAAY,UAAUuE,MAAV,EAAkByI,EAAlB,EAAsB7b,KAAtB,EAA6B;AACrC,2BAAOyQ,EAAE2C,MAAF,EAAUvE,OAAV,CAAkBgN,EAAlB,EAAsB7b,KAAtB,CAAP;AACH,iBAFD;;AAIAuV,wBAAQjW,SAAR,CAAkBuP,OAAlB,GAA4B,UAAUgN,EAAV,EAAc7b,KAAd,EAAqB;AAC7C,wBAAIiW,WAAW9c,OAAf;AACA,wBAAI2iB,YAAY7N,WAAW,YAAY;AACnC,4BAAI,CAACjO,KAAD,IAAU,aAAa,OAAOA,KAAlC,EAAyC;AACrCA,oCAAQ,IAAIzI,KAAJ,CAAUyI,SAAS,qBAAqB6b,EAArB,GAA0B,KAA7C,CAAR;AACA7b,kCAAMxI,IAAN,GAAa,WAAb;AACH;AACDye,iCAASnZ,MAAT,CAAgBkD,KAAhB;AACH,qBANe,EAMb6b,EANa,CAAhB;;AAQA,yBAAKriB,IAAL,CAAU,UAAU8K,KAAV,EAAiB;AACvB4J,qCAAa4N,SAAb;AACA7F,iCAASjd,OAAT,CAAiBsL,KAAjB;AACH,qBAHD,EAGG,UAAUiP,SAAV,EAAqB;AACpBrF,qCAAa4N,SAAb;AACA7F,iCAASnZ,MAAT,CAAgByW,SAAhB;AACH,qBAND,EAMG0C,SAASY,MANZ;;AAQA,2BAAOZ,SAAS7c,OAAhB;AACH,iBAnBD;;AAqBA;;;;;;;;;AASAqX,kBAAEsL,KAAF,GAAU,UAAU3I,MAAV,EAAkBvE,OAAlB,EAA2B;AACjC,wBAAIA,YAAY,KAAK,CAArB,EAAwB;AACpBA,kCAAUuE,MAAV;AACAA,iCAAS,KAAK,CAAd;AACH;AACD,2BAAO3C,EAAE2C,MAAF,EAAU2I,KAAV,CAAgBlN,OAAhB,CAAP;AACH,iBAND;;AAQA0G,wBAAQjW,SAAR,CAAkByc,KAAlB,GAA0B,UAAUlN,OAAV,EAAmB;AACzC,2BAAO,KAAKrV,IAAL,CAAU,UAAU8K,KAAV,EAAiB;AAC9B,4BAAI2R,WAAW9c,OAAf;AACA8U,mCAAW,YAAY;AACnBgI,qCAASjd,OAAT,CAAiBsL,KAAjB;AACH,yBAFD,EAEGuK,OAFH;AAGA,+BAAOoH,SAAS7c,OAAhB;AACH,qBANM,CAAP;AAOH,iBARD;;AAUA;;;;;;;;;AASAqX,kBAAEuL,OAAF,GAAY,UAAU3f,QAAV,EAAoBd,IAApB,EAA0B;AAClC,2BAAOkV,EAAEpU,QAAF,EAAY2f,OAAZ,CAAoBzgB,IAApB,CAAP;AACH,iBAFD;;AAIAga,wBAAQjW,SAAR,CAAkB0c,OAAlB,GAA4B,UAAUzgB,IAAV,EAAgB;AACxC,wBAAI0a,WAAW9c,OAAf;AACA,wBAAI8iB,WAAW5J,YAAY9W,IAAZ,CAAf;AACA0gB,6BAASrb,IAAT,CAAcqV,SAASe,gBAAT,EAAd;AACA,yBAAK4D,MAAL,CAAYqB,QAAZ,EAAsBP,IAAtB,CAA2BzF,SAASnZ,MAApC;AACA,2BAAOmZ,SAAS7c,OAAhB;AACH,iBAND;;AAQA;;;;;;;;;AASAqX,kBAAEyL,MAAF,GAAW,UAAU7f,QAAV,CAAmB,WAAnB,EAAgC;AACvC,wBAAId,OAAO8W,YAAYnS,SAAZ,EAAuB,CAAvB,CAAX;AACA,2BAAOuQ,EAAEpU,QAAF,EAAY2f,OAAZ,CAAoBzgB,IAApB,CAAP;AACH,iBAHD;;AAKAga,wBAAQjW,SAAR,CAAkB4c,MAAlB,GAA2B,YAAU,WAAa;AAC9C,wBAAID,WAAW5J,YAAYnS,SAAZ,CAAf;AACA,wBAAI+V,WAAW9c,OAAf;AACA8iB,6BAASrb,IAAT,CAAcqV,SAASe,gBAAT,EAAd;AACA,yBAAK4D,MAAL,CAAYqB,QAAZ,EAAsBP,IAAtB,CAA2BzF,SAASnZ,MAApC;AACA,2BAAOmZ,SAAS7c,OAAhB;AACH,iBAND;;AAQA;;;;;;;;AAQAqX,kBAAE0L,MAAF,GACA1L,EAAE2L,SAAF,GAAc,UAAU/f,QAAV,CAAmB,WAAnB,EAAgC;AAC1C,wBAAIA,aAAae,SAAjB,EAA4B;AACxB,8BAAM,IAAI7F,KAAJ,CAAU,oCAAV,CAAN;AACH;AACD,wBAAI8kB,WAAWhK,YAAYnS,SAAZ,EAAuB,CAAvB,CAAf;AACA,2BAAO,YAAY;AACf,4BAAI+b,WAAWI,SAASte,MAAT,CAAgBsU,YAAYnS,SAAZ,CAAhB,CAAf;AACA,4BAAI+V,WAAW9c,OAAf;AACA8iB,iCAASrb,IAAT,CAAcqV,SAASe,gBAAT,EAAd;AACAvG,0BAAEpU,QAAF,EAAYue,MAAZ,CAAmBqB,QAAnB,EAA6BP,IAA7B,CAAkCzF,SAASnZ,MAA3C;AACA,+BAAOmZ,SAAS7c,OAAhB;AACH,qBAND;AAOH,iBAbD;;AAeAmc,wBAAQjW,SAAR,CAAkB6c,MAAlB,GACA5G,QAAQjW,SAAR,CAAkB8c,SAAlB,GAA8B,YAAU,WAAa;AACjD,wBAAI7gB,OAAO8W,YAAYnS,SAAZ,CAAX;AACA3E,yBAAKyY,OAAL,CAAa,IAAb;AACA,2BAAOvD,EAAE2L,SAAF,CAAY7b,KAAZ,CAAkB,KAAK,CAAvB,EAA0BhF,IAA1B,CAAP;AACH,iBALD;;AAOAkV,kBAAE6L,KAAF,GAAU,UAAUjgB,QAAV,EAAoBqW,KAApB,CAA0B,WAA1B,EAAuC;AAC7C,wBAAI2J,WAAWhK,YAAYnS,SAAZ,EAAuB,CAAvB,CAAf;AACA,2BAAO,YAAY;AACf,4BAAI+b,WAAWI,SAASte,MAAT,CAAgBsU,YAAYnS,SAAZ,CAAhB,CAAf;AACA,4BAAI+V,WAAW9c,OAAf;AACA8iB,iCAASrb,IAAT,CAAcqV,SAASe,gBAAT,EAAd;AACA,iCAASuF,KAAT,GAAiB;AACb,mCAAOlgB,SAASkE,KAAT,CAAemS,KAAf,EAAsBxS,SAAtB,CAAP;AACH;AACDuQ,0BAAE8L,KAAF,EAAS3B,MAAT,CAAgBqB,QAAhB,EAA0BP,IAA1B,CAA+BzF,SAASnZ,MAAxC;AACA,+BAAOmZ,SAAS7c,OAAhB;AACH,qBATD;AAUH,iBAZD;;AAcAmc,wBAAQjW,SAAR,CAAkBgd,KAAlB,GAA0B,YAAU,kBAAoB;AACpD,wBAAI/gB,OAAO8W,YAAYnS,SAAZ,EAAuB,CAAvB,CAAX;AACA3E,yBAAKyY,OAAL,CAAa,IAAb;AACA,2BAAOvD,EAAE6L,KAAF,CAAQ/b,KAAR,CAAc,KAAK,CAAnB,EAAsBhF,IAAtB,CAAP;AACH,iBAJD;;AAMA;;;;;;;;;AASAkV,kBAAE+L,OAAF,GAAY;AACZ/L,kBAAEgM,KAAF,GAAU,UAAUrJ,MAAV,EAAkB5Q,IAAlB,EAAwBjH,IAAxB,EAA8B;AACpC,2BAAOkV,EAAE2C,MAAF,EAAUqJ,KAAV,CAAgBja,IAAhB,EAAsBjH,IAAtB,CAAP;AACH,iBAHD;;AAKAga,wBAAQjW,SAAR,CAAkBkd,OAAlB,GAA4B;AAC5BjH,wBAAQjW,SAAR,CAAkBmd,KAAlB,GAA0B,UAAUja,IAAV,EAAgBjH,IAAhB,EAAsB;AAC5C,wBAAI0gB,WAAW5J,YAAY9W,QAAQ,EAApB,CAAf;AACA,wBAAI0a,WAAW9c,OAAf;AACA8iB,6BAASrb,IAAT,CAAcqV,SAASe,gBAAT,EAAd;AACA,yBAAK4C,QAAL,CAAc,MAAd,EAAsB,CAACpX,IAAD,EAAOyZ,QAAP,CAAtB,EAAwCP,IAAxC,CAA6CzF,SAASnZ,MAAtD;AACA,2BAAOmZ,SAAS7c,OAAhB;AACH,iBAPD;;AASA;;;;;;;;;;AAUAqX,kBAAEiM,KAAF,GAAU;AACVjM,kBAAEkM,MAAF,GAAW;AACXlM,kBAAEmM,OAAF,GAAY,UAAUxJ,MAAV,EAAkB5Q,IAAlB,CAAuB,WAAvB,EAAoC;AAC5C,wBAAIyZ,WAAW5J,YAAYnS,SAAZ,EAAuB,CAAvB,CAAf;AACA,wBAAI+V,WAAW9c,OAAf;AACA8iB,6BAASrb,IAAT,CAAcqV,SAASe,gBAAT,EAAd;AACAvG,sBAAE2C,MAAF,EAAUwG,QAAV,CAAmB,MAAnB,EAA2B,CAACpX,IAAD,EAAOyZ,QAAP,CAA3B,EAA6CP,IAA7C,CAAkDzF,SAASnZ,MAA3D;AACA,2BAAOmZ,SAAS7c,OAAhB;AACH,iBARD;;AAUAmc,wBAAQjW,SAAR,CAAkBod,KAAlB,GAA0B;AAC1BnH,wBAAQjW,SAAR,CAAkBqd,MAAlB,GAA2B;AAC3BpH,wBAAQjW,SAAR,CAAkBsd,OAAlB,GAA4B,UAAUpa,IAAV,CAAe,WAAf,EAA4B;AACpD,wBAAIyZ,WAAW5J,YAAYnS,SAAZ,EAAuB,CAAvB,CAAf;AACA,wBAAI+V,WAAW9c,OAAf;AACA8iB,6BAASrb,IAAT,CAAcqV,SAASe,gBAAT,EAAd;AACA,yBAAK4C,QAAL,CAAc,MAAd,EAAsB,CAACpX,IAAD,EAAOyZ,QAAP,CAAtB,EAAwCP,IAAxC,CAA6CzF,SAASnZ,MAAtD;AACA,2BAAOmZ,SAAS7c,OAAhB;AACH,iBARD;;AAUA;;;;;;;;;;AAUAqX,kBAAEoM,OAAF,GAAYA,OAAZ;AACA,yBAASA,OAAT,CAAiBzJ,MAAjB,EAAyB0J,QAAzB,EAAmC;AAC/B,2BAAOrM,EAAE2C,MAAF,EAAUyJ,OAAV,CAAkBC,QAAlB,CAAP;AACH;;AAEDvH,wBAAQjW,SAAR,CAAkBud,OAAlB,GAA4B,UAAUC,QAAV,EAAoB;AAC5C,wBAAIA,QAAJ,EAAc;AACV,6BAAKtjB,IAAL,CAAU,UAAU8K,KAAV,EAAiB;AACvBmM,8BAAE1B,QAAF,CAAW,YAAY;AACnB+N,yCAAS,IAAT,EAAexY,KAAf;AACH,6BAFD;AAGH,yBAJD,EAIG,UAAUtE,KAAV,EAAiB;AAChByQ,8BAAE1B,QAAF,CAAW,YAAY;AACnB+N,yCAAS9c,KAAT;AACH,6BAFD;AAGH,yBARD;AASH,qBAVD,MAUO;AACH,+BAAO,IAAP;AACH;AACJ,iBAdD;;AAgBAyQ,kBAAEC,UAAF,GAAe,YAAW;AACtB,0BAAM,IAAInZ,KAAJ,CAAU,oDAAV,CAAN;AACH,iBAFD;;AAIA;AACA,oBAAI2d,cAAcpE,aAAlB;;AAEA,uBAAOL,CAAP;AAEC,aA5/DD;AA8/DC,SA3hED,EA2hEG9Y,IA3hEH,CA2hEQ,IA3hER,EA2hEaP,QAAQ,UAAR,CA3hEb;AA4hEC,KA7hEQ,EA6hEP,EAAC,YAAW,EAAZ,EA7hEO,CAt1Ekb,EAm3Ixa,IAAG,CAAC,UAASA,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACvD,YAAIqlB,UAAW,YAAW;AAAE,mBAAO,IAAP;AAAc,SAA5B,EAAd;AACA,YAAIC,kBAAkBD,QAAQxiB,SAAR,IAAqBwiB,QAAQE,YAAnD;AACA,YAAIC,oBAAoB9lB,QAAQ,WAAR,CAAxB;;AAGA;;;AAGA,iBAAS+lB,YAAT,CAAsBC,GAAtB,EAA2BC,SAA3B,EAAsC;AACrC,gBAAIC,eAAJ;;AAEA,gBAAID,SAAJ,EAAe;AACdC,kCAAkB,IAAIN,eAAJ,CAAoBI,GAApB,EAAyBC,SAAzB,CAAlB;AACA,aAFD,MAGK;AACJC,kCAAkB,IAAIN,eAAJ,CAAoBI,GAApB,CAAlB;AACA;;AAED;;;;;;;AAOA,mBAAOE,eAAP;AACA;;AAGD;;;AAGAzlB,eAAOH,OAAP,GAAiB;AACb,4BAAiBslB,kBAAkBG,YAAlB,GAAiC,IADrC;AAEb,uBAAiBD;AAFJ,SAAjB;AAKC,KAtCqB,EAsCpB,EAAC,aAAY,EAAb,EAtCoB,CAn3Iqa,EAy5Iva,IAAG,CAAC,UAAS9lB,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AACxDG,eAAOH,OAAP,GAAiBN,QAAQ,iBAAR,EAA2BiY,OAA5C;AAEC,KAHsB,EAGrB,EAAC,mBAAkB,EAAnB,EAHqB,CAz5Ioa,EA45Ija,IAAG,CAAC,UAASjY,OAAT,EAAiBS,MAAjB,EAAwBH,OAAxB,EAAgC;AAC9DG,eAAOH,OAAP,GAAe;AACb,qBAAS,CACP,CACE,kBADF,EAEE,cAFF,CADO,CADI;AAOb,qBAAS,kBAPI;AAQb,mBAAO,kBARM;AASb,yBAAa,KATA;AAUb,0BAAc,mCAVD;AAWb,yBAAa,YAXA;AAYb,gCAAoB,EAZP;AAab,0BAAc;AACZ,wBAAQ,SADI;AAEZ,4BAAY,IAFA;AAGZ,uBAAO,kBAHK;AAIZ,wBAAQ,WAJI;AAKZ,+BAAe,WALH;AAMZ,2BAAW,QANC;AAOZ,4BAAY,IAPA;AAQZ,6BAAa;AARD,aAbD;AAuBb,2BAAe,CACb,GADa,CAvBF;AA0Bb,yBAAa,6DA1BA;AA2Bb,qBAAS,QA3BI;AA4Bb,sBAAU,cA5BG;AA6Bb,sBAAU;AACR,wBAAQ,gBADA;AAER,yBAAS,mBAFD;AAGR,uBAAO;AAHC,aA7BG;AAkCb,uBAAW,gBAlCE;AAmCb,oBAAQ;AACN,uBAAO;AADD,aAnCK;AAsCb,sBAAU;AACR,2BAAW;AADH,aAtCG;AAyCb,4BAAgB,CACd;AACE,wBAAQ,oBADV;AAEE,yBAAS,eAFX;AAGE,uBAAO;AAHT,aADc,CAzCH;AAgDb,4BAAgB;AACd,yBAAS,QADK;AAEd,uBAAO,QAFO;AAGd,wCAAwB,QAHV;AAId,yBAAS;AAJK,aAhDH;AAsDb,2BAAe,iGAtDF;AAuDb,+BAAmB;AACjB,gCAAgB,QADC;AAEjB,0BAAU,QAFO;AAGjB,wBAAQ,4CAHS;AAIjB,+BAAe,QAJE;AAKjB,0BAAU,QALO;AAMjB,kCAAkB,QAND;AAOjB,wBAAQ;AAPS,aAvDN;AAgEb,2BAAe;AACb,uBAAO;AADM,aAhEF;AAmEb,uBAAW;AACT,wBAAQ;AADC,aAnEE;AAsEb,wBAAY,+CAtEC;AAuEb,wBAAY,CACV,WADU,EAEV,YAFU,EAGV,QAHU,EAIV,YAJU,EAKV,OALU,EAMV,MANU,EAOV,UAPU,EAQV,UARU,EASV,QATU,EAUV,QAVU,CAvEC;AAmFb,uBAAW,YAnFE;AAoFb,oBAAQ,OApFK;AAqFb,oBAAQ,WArFK;AAsFb,0BAAc;AACZ,wBAAQ,KADI;AAEZ,uBAAO;AAFK,aAtFD;AA0Fb,uBAAW;AACT,wBAAQ,MADC;AAET,2BAAW,kDAFF;AAGT,wBAAQ;AAHC,aA1FE;AA+Fb,uBAAW;AA/FE,SAAf;AAkGC,KAnG4B,EAmG3B,EAnG2B,CA55I8Z,EAA3b,EA+/IO,EA//IP,EA+/IU,CAAC,CAAD,CA//IV","file":"angular-ashamed.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function(window){\n\t\"use strict\";\n\n\tconst AshamedClient = require(\"../lib/client.js\");\n\tconst shm = angular.module(\"ashamed\",[]);\n\n\tshm.provider(\"ashamedConfig\",function(){\n\t\tvar self = this;\n\t\tthis.host = \"localhost:3000\";\n\t\tthis.base = \"\";\n\t\tthis.realtime = true;\n\n\t\tthis.$get = function() {\n\t\t\treturn {\n\t\t\t\thost : self.host,\n\t\t\t\tbase : self.base,\n\t\t\t\trealtime : self.realtime\n\t\t\t};\n\t\t}\n\t});\n\n\tshm.service(\"ashamedService\",[\"ashamedConfig\",\"$q\",\"$rootScope\",\"$timeout\",\n\tfunction(config,$q,$rootScope,$timeout){\n\t\tconst client = new AshamedClient(config);\n\n\t\tclient.on(\"message\",()=>{\n\t\t\t$rootScope.$apply();\n\t\t});\n\n\t\tfunction resolve(data) {\n\t\t\tvar q = $q.defer();\n\t\t\t$timeout(()=>{\n\t\t\t\t$rootScope.$apply();\n\t\t\t},10);\n\t\t\tq.resolve(data);\n\t\t\treturn q.promise;\n\t\t}\n\n\t\tthis.get = function(path,options) {\n\t\t\treturn client.get(path,options).then(resolve);\n\t\t}\n\n\t\tthis.set = function(path,item,options) {\n\t\t\treturn client.set(path,item,options).then(resolve);\n\t\t}\n\n\t\tthis.diff = function(path,changes) {\n\t\t\treturn client.diff(path,changes).then(resolve);\n\t\t}\n\n\t\tthis.update = function(path,item) {\n\t\t\treturn client.update(path,item).then(resolve);\n\t\t}\n}]);\n\n})(window);\n\n},{\"../lib/client.js\":2}],2:[function(require,module,exports){\nconst\n\tq = require(\"q\"),\n\tPath = require(\"./path.js\"),\n\textend = require(\"extend\"),\n\tEventEmitter = require('events'),\n\tdiff = Path.diff,\n\tapplyChanges = Path.applyChanges,\n\tapplyDiff = Path.applyDiff,\n\tstrToPath = Path.strToPath,\n\tpathToStr = Path.pathToStr,\n\tgetPath = Path.getPath;\n\nconst\tWebSocketClient = typeof(WebSocket)!==\"undefined\"?\n\tWebSocket : require('websocket').w3cwebsocket;\n\nvar store = {}, backup = {};\nvar pending = {};\n\nconst vfn = ()=>{};\nconst CHANNEL = \"ashamed\";\nconst DEF_OPTS = {\n\thost : \"localhost:3000\",\n\tbase : \"\",\n\trealtime : true\n}\n\n/**\n * Handles the websocket responses\n * @param msg Websocket message\n */\nfunction handleMessage(msg) {\n\tmsg = JSON.parse(msg.data);\n\t// If channel is incorrect, do nothing\n\tif(msg.channel!=CHANNEL) return;\n\tif(msg.type == \"model-update\") {modelUpdate(msg);}\n\telse if(msg.type == \"response\") {modelResponse(msg);}\n}\n\n/**\n * Updates the subscribed model with external changes\n * @param msg Websocket message data\n */\nfunction modelUpdate(msg) {\n\tvar path = msg.args[0];\n\tvar changes = msg.args[1]||[];\n\t//var bch = JSON.parse(JSON.stringify(changes));\n\tpath = strToPath(path);\n\n\t// Apply all changes\n\tapplyChanges(backup,changes,path);\n\tvar patch = diff(store,backup);\n\tapplyChanges(store,patch);\n}\n\nfunction modelResponse(msg) {\n\tvar cid = msg.cid;\n\tvar [err,data] = msg.args;\n\n\tif(!pending[cid]) return;\n\telse {\n\t\tvar cb = pending[cid];\n\t\tdelete pending[cid];\n\t\tcb(err,data);\n\t}\n}\n\nclass AshamedClient extends EventEmitter {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\toptions = extend({},DEF_OPTS,options);\n\t\tthis._options = options;\n\t\tthis._host = options.host;\n\t\tthis._base = options.base;\n\t\tthis._realtime = options.realtime;\n\t\tthis._url = {\n\t\t\tws : \"ws://\"+options.host+options.base+\"/ws\",\n\t\t\thttp : \"http://\"+options.host+options.base\n\t\t}\n\t\tthis._err = null;\n\t\tthis.connect();\n\t}\n\n\t_send(msg,callback) {\n\t\tvar err = this._err;\n\t\tmsg.channel = CHANNEL;\n\t\tcallback = callback || vfn;\n\n\t\t// Correlation ID to the callback\n\t\tmsg.cid = `ws_${Math.random()}`;\n\t\tpending[msg.cid] = callback;\n\n\t\tif(!err) {\n\t\t\tthis._ready.then(ws=>{\n\t\t\t\tws.send(JSON.stringify(msg));\n\t\t\t},err=>{\n\t\t\t\terr.code = \"ERROR\";\n\t\t\t\tcallback(err,null);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\terr.code = \"ERROR\";\n\t\t\tcallback(err,null);\n\t\t}\n\t}\n\n\tget store() {\n\t\treturn store;\n\t}\n\n\tconnect() {\n\t\tvar def = q.defer();\n\t\tvar ws = new WebSocketClient(this._url.ws);\n\t\tws.onerror = (err)=>{\n\t\t\tthis._err = `Unable to connect to ${this._url.ws}`;\n\t\t\tthis.emit(\"error\",this._err);\n\t\t\tdef.reject(this._err);\n\t\t}\n\t\tws.onopen = ()=>{\n\t\t\tthis._err = null;\n\t\t\tthis.emit(\"ready\",this);\n\t\t\tdef.resolve(ws);\n\t\t}\n\t\tws.onmessage = (msg)=>{\n\t\t\thandleMessage(msg);\n\t\t\tthis.emit(\"message\",msg);\n\t\t}\n\t\tws.onclose = ()=>{\n\t\t\tthis.emit(\"close\");\n\t\t\tthis._err = new Error(\"Connection has been closed\");\n\t\t}\n\t\tthis._ready = def.promise;\n\t}\n\n\tget(path,options) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\toptions = extend({},this._options,options);\n\t\tthis._send({op:\"get\", args:[path,options]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse if(options.realtime && data!==null && data!==undefined) {\n\t\t\t\tapplyDiff(store,data,path);\n\t\t\t\tbackup = extend(true,{},store);\n\t\t\t\tdef.resolve(getPath(path,false,store));\n\t\t\t}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n\n\tset(path,item,options) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\toptions = extend({},this._options,options);\n\t\tthis._send({op:\"set\", args:[path,item,options]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse if(options.realtime) {\n\t\t\t\tapplyDiff(store,data,path);\n\t\t\t\tbackup = extend(true,{},store);\n\t\t\t\tdef.resolve(getPath(path,false,store));\n\t\t\t}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n\n\tupdate(path,item) {\n\t\tvar s = store;\n\t\tvar old = getPath(path,true,backup);\n\t\tvar changes = diff(old,item);\n\t\treturn this.diff(path,changes);\n\t}\n\n\tdiff(path,changes) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\tthis._send({op:\"diff\", args:[path,changes]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n\n\tpath(base) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\tthis._send({op:\"path\", args:[base]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n}\n\nmodule.exports = AshamedClient;\n\n},{\"./path.js\":3,\"events\":4,\"extend\":5,\"q\":21,\"websocket\":22}],3:[function(require,module,exports){\nconst\n\textend = require(\"extend\"),\n\tjiff = require(\"jiff\");\n\nfunction strToPath(path) {\n\tpath = path ||[];\n\treturn Array.isArray(path)?\n\t\tpath :\n\t\tpath.replace(/ /g,\"\").split(\"/\").filter(s=>s.length);\n}\n\nfunction pathToStr(path) {\n\tpath = path ||[];\n\tvar res = typeof(path)==\"string\"? path : path.join(\"/\");\n\treturn res.startsWith(\"/\") ? res : `/${res}`;\n}\n\nfunction concat(a,b) {\n\ta = strToPath(a);\n\tb = strToPath(b);\n\treturn pathToStr([].concat(a).concat(b));\n}\n\nfunction getPath(path,create,src,val) {\n\tvar root = src || {};\n\tpath = strToPath(path);\n\tif(!path.length) \t{\n\t\treturn extend(src,val);\n\t}\n\twhile(path.length) {\n\t\tlet folder = path.shift();\n\t\tif(!root[folder]) {\n\t\t\tif(create) {root[folder] = {};}\n\t\t\telse {return null;}\n\t\t}\n\t\tif(!path.length && val!==undefined)\t{\n\t\t\tif(typeof(root[folder])==\"object\" && Object.keys(root[folder]).length) {\n\t\t\t\tif(typeof(val)==\"object\") extend(true,root[folder],val);\n\t\t\t\telse root[folder] = val;\n\t\t\t}\n\t\t\telse {\n\t\t\t\troot[folder] = val;\n\t\t\t}\n\t\t}\n\t\troot = root[folder];\n\t\tif(!path.length) return root;\n\t}\n}\n\nfunction diff(target,source) {\n\treturn jiff.diff(target,source).filter(d=>d.op!=\"test\");\n}\n\nfunction applyDiff(target,source,path) {\n\tvar d = {};\n\tgetPath(path,true,d,source);\n\treturn extend(true,target,d);\n}\n\nfunction applyChanges(target,patch,path) {\n\tpatch.forEach(p=>{\n\t\tp.opath = p.path;\n\t\tp.path = concat(path,p.path);\n\t\tvar np = strToPath(p.path);\n\t\tif(np.length>1) np.pop();\n\t\tgetPath(np,true,target);\n\t});\n\tjiff.patchInPlace(patch, target);\n\tpatch.forEach(p=>{\n\t\tp.path = p.opath;\n\t\tdelete p.opath;\n\t});\n}\n\nfunction applyChange(target,change) {\n\tgetPath(change.path,false,target);\n\tjiff.patchInPlace([change], target);\n}\n\nmodule.exports = {\n\tstrToPath : strToPath,\n\tpathToStr : pathToStr,\n\tgetPath : getPath,\n\tdiff : diff,\n\tconcat : concat,\n\tapplyDiff : applyDiff,\n\tapplyChange : applyChange,\n\tapplyChanges : applyChanges,\n}\n\n},{\"extend\":5,\"jiff\":6}],4:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n},{}],6:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nvar lcs = require('./lib/lcs');\nvar array = require('./lib/array');\nvar patch = require('./lib/jsonPatch');\nvar inverse = require('./lib/inverse');\nvar jsonPointer = require('./lib/jsonPointer');\nvar encodeSegment = jsonPointer.encodeSegment;\n\nexports.diff = diff;\nexports.patch = patch.apply;\nexports.patchInPlace = patch.applyInPlace;\nexports.inverse = inverse;\nexports.clone = patch.clone;\n\n// Errors\nexports.InvalidPatchOperationError = require('./lib/InvalidPatchOperationError');\nexports.TestFailedError = require('./lib/TestFailedError');\nexports.PatchNotInvertibleError = require('./lib/PatchNotInvertibleError');\n\nvar isValidObject = patch.isValidObject;\nvar defaultHash = patch.defaultHash;\n\n/**\n * Compute a JSON Patch representing the differences between a and b.\n * @param {object|array|string|number|null} a\n * @param {object|array|string|number|null} b\n * @param {?function|?object} options if a function, see options.hash\n * @param {?function(x:*):String|Number} options.hash used to hash array items\n *  in order to recognize identical objects, defaults to JSON.stringify\n * @param {?function(index:Number, array:Array):object} options.makeContext\n *  used to generate patch context. If not provided, context will not be generated\n * @returns {array} JSON Patch such that patch(diff(a, b), a) ~ b\n */\nfunction diff(a, b, options) {\n\treturn appendChanges(a, b, '', initState(options, [])).patch;\n}\n\n/**\n * Create initial diff state from the provided options\n * @param {?function|?object} options @see diff options above\n * @param {array} patch an empty or existing JSON Patch array into which\n *  the diff should generate new patch operations\n * @returns {object} initialized diff state\n */\nfunction initState(options, patch) {\n\tif(typeof options === 'object') {\n\t\treturn {\n\t\t\tpatch: patch,\n\t\t\thash: orElse(isFunction, options.hash, defaultHash),\n\t\t\tmakeContext: orElse(isFunction, options.makeContext, defaultContext),\n\t\t\tinvertible: !(options.invertible === false)\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tpatch: patch,\n\t\t\thash: orElse(isFunction, options, defaultHash),\n\t\t\tmakeContext: defaultContext,\n\t\t\tinvertible: true\n\t\t};\n\t}\n}\n\n/**\n * Given two JSON values (object, array, number, string, etc.), find their\n * differences and append them to the diff state\n * @param {object|array|string|number|null} a\n * @param {object|array|string|number|null} b\n * @param {string} path\n * @param {object} state\n * @returns {Object} updated diff state\n */\nfunction appendChanges(a, b, path, state) {\n\tif(Array.isArray(a) && Array.isArray(b)) {\n\t\treturn appendArrayChanges(a, b, path, state);\n\t}\n\n\tif(isValidObject(a) && isValidObject(b)) {\n\t\treturn appendObjectChanges(a, b, path, state);\n\t}\n\n\treturn appendValueChanges(a, b, path, state);\n}\n\n/**\n * Given two objects, find their differences and append them to the diff state\n * @param {object} o1\n * @param {object} o2\n * @param {string} path\n * @param {object} state\n * @returns {Object} updated diff state\n */\nfunction appendObjectChanges(o1, o2, path, state) {\n\tvar keys = Object.keys(o2);\n\tvar patch = state.patch;\n\tvar i, key;\n\n\tfor(i=keys.length-1; i>=0; --i) {\n\t\tkey = keys[i];\n\t\tvar keyPath = path + '/' + encodeSegment(key);\n\t\tif(o1[key] !== void 0) {\n\t\t\tappendChanges(o1[key], o2[key], keyPath, state);\n\t\t} else {\n\t\t\tpatch.push({ op: 'add', path: keyPath, value: o2[key] });\n\t\t}\n\t}\n\n\tkeys = Object.keys(o1);\n\tfor(i=keys.length-1; i>=0; --i) {\n\t\tkey = keys[i];\n\t\tif(o2[key] === void 0) {\n\t\t\tvar p = path + '/' + encodeSegment(key);\n\t\t\tif(state.invertible) {\n\t\t\t\tpatch.push({ op: 'test', path: p, value: o1[key] });\n\t\t\t}\n\t\t\tpatch.push({ op: 'remove', path: p });\n\t\t}\n\t}\n\n\treturn state;\n}\n\n/**\n * Given two arrays, find their differences and append them to the diff state\n * @param {array} a1\n * @param {array} a2\n * @param {string} path\n * @param {object} state\n * @returns {Object} updated diff state\n */\nfunction appendArrayChanges(a1, a2, path, state) {\n\tvar a1hash = array.map(state.hash, a1);\n\tvar a2hash = array.map(state.hash, a2);\n\n\tvar lcsMatrix = lcs.compare(a1hash, a2hash);\n\n\treturn lcsToJsonPatch(a1, a2, path, state, lcsMatrix);\n}\n\n/**\n * Transform an lcsMatrix into JSON Patch operations and append\n * them to state.patch, recursing into array elements as necessary\n * @param {array} a1\n * @param {array} a2\n * @param {string} path\n * @param {object} state\n * @param {object} lcsMatrix\n * @returns {object} new state with JSON Patch operations added based\n *  on the provided lcsMatrix\n */\nfunction lcsToJsonPatch(a1, a2, path, state, lcsMatrix) {\n\tvar offset = 0;\n\treturn lcs.reduce(function(state, op, i, j) {\n\t\tvar last, context;\n\t\tvar patch = state.patch;\n\t\tvar p = path + '/' + (j + offset);\n\n\t\tif (op === lcs.REMOVE) {\n\t\t\t// Coalesce adjacent remove + add into replace\n\t\t\tlast = patch[patch.length-1];\n\t\t\tcontext = state.makeContext(j, a1);\n\n\t\t\tif(state.invertible) {\n\t\t\t\tpatch.push({ op: 'test', path: p, value: a1[j], context: context });\n\t\t\t}\n\n\t\t\tif(last !== void 0 && last.op === 'add' && last.path === p) {\n\t\t\t\tlast.op = 'replace';\n\t\t\t\tlast.context = context;\n\t\t\t} else {\n\t\t\t\tpatch.push({ op: 'remove', path: p, context: context });\n\t\t\t}\n\n\t\t\toffset -= 1;\n\n\t\t} else if (op === lcs.ADD) {\n\t\t\t// See https://tools.ietf.org/html/rfc6902#section-4.1\n\t\t\t// May use either index===length *or* '-' to indicate appending to array\n\t\t\tpatch.push({ op: 'add', path: p, value: a2[i],\n\t\t\t\tcontext: state.makeContext(j, a1)\n\t\t\t});\n\n\t\t\toffset += 1;\n\n\t\t} else {\n\t\t\tappendChanges(a1[j], a2[i], p, state);\n\t\t}\n\n\t\treturn state;\n\n\t}, state, lcsMatrix);\n}\n\n/**\n * Given two number|string|null values, if they differ, append to diff state\n * @param {string|number|null} a\n * @param {string|number|null} b\n * @param {string} path\n * @param {object} state\n * @returns {object} updated diff state\n */\nfunction appendValueChanges(a, b, path, state) {\n\tif(a !== b) {\n\t\tif(state.invertible) {\n\t\t\tstate.patch.push({ op: 'test', path: path, value: a });\n\t\t}\n\n\t\tstate.patch.push({ op: 'replace', path: path, value: b });\n\t}\n\n\treturn state;\n}\n\n/**\n * @param {function} predicate\n * @param {*} x\n * @param {*} y\n * @returns {*} x if predicate(x) is truthy, otherwise y\n */\nfunction orElse(predicate, x, y) {\n\treturn predicate(x) ? x : y;\n}\n\n/**\n * Default patch context generator\n * @returns {undefined} undefined context\n */\nfunction defaultContext() {\n\treturn void 0;\n}\n\n/**\n * @param {*} x\n * @returns {boolean} true if x is a function, false otherwise\n */\nfunction isFunction(x) {\n\treturn typeof x === 'function';\n}\n\n},{\"./lib/InvalidPatchOperationError\":7,\"./lib/PatchNotInvertibleError\":8,\"./lib/TestFailedError\":9,\"./lib/array\":10,\"./lib/inverse\":14,\"./lib/jsonPatch\":15,\"./lib/jsonPointer\":16,\"./lib/lcs\":18}],7:[function(require,module,exports){\nmodule.exports = InvalidPatchOperationError;\n\nfunction InvalidPatchOperationError(message) {\n\tError.call(this);\n\tthis.name = this.constructor.name;\n\tthis.message = message;\n\tif(typeof Error.captureStackTrace === 'function') {\n\t\tError.captureStackTrace(this, this.constructor);\n\t}\n}\n\nInvalidPatchOperationError.prototype = Object.create(Error.prototype);\nInvalidPatchOperationError.prototype.constructor = InvalidPatchOperationError;\n},{}],8:[function(require,module,exports){\nmodule.exports = PatchNotInvertibleError;\n\nfunction PatchNotInvertibleError(message) {\n\tError.call(this);\n\tthis.name = this.constructor.name;\n\tthis.message = message;\n\tif(typeof Error.captureStackTrace === 'function') {\n\t\tError.captureStackTrace(this, this.constructor);\n\t}\n}\n\nPatchNotInvertibleError.prototype = Object.create(Error.prototype);\nPatchNotInvertibleError.prototype.constructor = PatchNotInvertibleError;\n},{}],9:[function(require,module,exports){\nmodule.exports = TestFailedError;\n\nfunction TestFailedError(message) {\n\tError.call(this);\n\tthis.name = this.constructor.name;\n\tthis.message = message;\n\tif(typeof Error.captureStackTrace === 'function') {\n\t\tError.captureStackTrace(this, this.constructor);\n\t}\n}\n\nTestFailedError.prototype = Object.create(Error.prototype);\nTestFailedError.prototype.constructor = TestFailedError;\n},{}],10:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexports.cons = cons;\nexports.tail = tail;\nexports.map = map;\n\n/**\n * Prepend x to a, without mutating a. Faster than a.unshift(x)\n * @param {*} x\n * @param {Array} a array-like\n * @returns {Array} new Array with x prepended\n */\nfunction cons(x, a) {\n\tvar l = a.length;\n\tvar b = new Array(l+1);\n\tb[0] = x;\n\tfor(var i=0; i<l; ++i) {\n\t\tb[i+1] = a[i];\n\t}\n\n\treturn b;\n}\n\n/**\n * Create a new Array containing all elements in a, except the first.\n *  Faster than a.slice(1)\n * @param {Array} a array-like\n * @returns {Array} new Array, the equivalent of a.slice(1)\n */\nfunction tail(a) {\n\tvar l = a.length-1;\n\tvar b = new Array(l);\n\tfor(var i=0; i<l; ++i) {\n\t\tb[i] = a[i+1];\n\t}\n\n\treturn b;\n}\n\n/**\n * Map any array-like. Faster than Array.prototype.map\n * @param {function} f\n * @param {Array} a array-like\n * @returns {Array} new Array mapped by f\n */\nfunction map(f, a) {\n\tvar b = new Array(a.length);\n\tfor(var i=0; i< a.length; ++i) {\n\t\tb[i] = f(a[i]);\n\t}\n\treturn b;\n}\n},{}],11:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n/**\n * Create a deep copy of x which must be a legal JSON object/array/value\n * @param {object|array|string|number|null} x object/array/value to clone\n * @returns {object|array|string|number|null} clone of x\n */\nmodule.exports = clone;\n\nfunction clone(x) {\n\tif(x == null || typeof x !== 'object') {\n\t\treturn x;\n\t}\n\n\tif(Array.isArray(x)) {\n\t\treturn cloneArray(x);\n\t}\n\n\treturn cloneObject(x);\n}\n\nfunction cloneArray (x) {\n\tvar l = x.length;\n\tvar y = new Array(l);\n\n\tfor (var i = 0; i < l; ++i) {\n\t\ty[i] = clone(x[i]);\n\t}\n\n\treturn y;\n}\n\nfunction cloneObject (x) {\n\tvar keys = Object.keys(x);\n\tvar y = {};\n\n\tfor (var k, i = 0, l = keys.length; i < l; ++i) {\n\t\tk = keys[i];\n\t\ty[k] = clone(x[k]);\n\t}\n\n\treturn y;\n}\n\n},{}],12:[function(require,module,exports){\nvar jsonPointer = require('./jsonPointer');\n\n/**\n * commute the patch sequence a,b to b,a\n * @param {object} a patch operation\n * @param {object} b patch operation\n */\nmodule.exports = function commutePaths(a, b) {\n\t// TODO: cases for special paths: '' and '/'\n\tvar left = jsonPointer.parse(a.path);\n\tvar right = jsonPointer.parse(b.path);\n\tvar prefix = getCommonPathPrefix(left, right);\n\tvar isArray = isArrayPath(left, right, prefix.length);\n\n\t// Never mutate the originals\n\tvar ac = copyPatch(a);\n\tvar bc = copyPatch(b);\n\n\tif(prefix.length === 0 && !isArray) {\n\t\t// Paths share no common ancestor, simple swap\n\t\treturn [bc, ac];\n\t}\n\n\tif(isArray) {\n\t\treturn commuteArrayPaths(ac, left, bc, right);\n\t} else {\n\t\treturn commuteTreePaths(ac, left, bc, right);\n\t}\n};\n\nfunction commuteTreePaths(a, left, b, right) {\n\tif(a.path === b.path) {\n\t\tthrow new TypeError('cannot commute ' + a.op + ',' + b.op + ' with identical object paths');\n\t}\n\t// FIXME: Implement tree path commutation\n\treturn [b, a];\n}\n\n/**\n * Commute two patches whose common ancestor (which may be the immediate parent)\n * is an array\n * @param a\n * @param left\n * @param b\n * @param right\n * @returns {*}\n */\nfunction commuteArrayPaths(a, left, b, right) {\n\tif(left.length === right.length) {\n\t\treturn commuteArraySiblings(a, left, b, right);\n\t}\n\n\tif (left.length > right.length) {\n\t\t// left is longer, commute by \"moving\" it to the right\n\t\tleft = commuteArrayAncestor(b, right, a, left, -1);\n\t\ta.path = jsonPointer.absolute(jsonPointer.join(left));\n\t} else {\n\t\t// right is longer, commute by \"moving\" it to the left\n\t\tright = commuteArrayAncestor(a, left, b, right, 1);\n\t\tb.path = jsonPointer.absolute(jsonPointer.join(right));\n\t}\n\n\treturn [b, a];\n}\n\nfunction isArrayPath(left, right, index) {\n\treturn jsonPointer.isValidArrayIndex(left[index])\n\t\t&& jsonPointer.isValidArrayIndex(right[index]);\n}\n\n/**\n * Commute two patches referring to items in the same array\n * @param l\n * @param lpath\n * @param r\n * @param rpath\n * @returns {*[]}\n */\nfunction commuteArraySiblings(l, lpath, r, rpath) {\n\n\tvar target = lpath.length-1;\n\tvar lindex = +lpath[target];\n\tvar rindex = +rpath[target];\n\n\tvar commuted;\n\n\tif(lindex < rindex) {\n\t\t// Adjust right path\n\t\tif(l.op === 'add' || l.op === 'copy') {\n\t\t\tcommuted = rpath.slice();\n\t\t\tcommuted[target] = Math.max(0, rindex - 1);\n\t\t\tr.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t\t} else if(l.op === 'remove') {\n\t\t\tcommuted = rpath.slice();\n\t\t\tcommuted[target] = rindex + 1;\n\t\t\tr.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t\t}\n\t} else if(r.op === 'add' || r.op === 'copy') {\n\t\t// Adjust left path\n\t\tcommuted = lpath.slice();\n\t\tcommuted[target] = lindex + 1;\n\t\tl.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t} else if (lindex > rindex && r.op === 'remove') {\n\t\t// Adjust left path only if remove was at a (strictly) lower index\n\t\tcommuted = lpath.slice();\n\t\tcommuted[target] = Math.max(0, lindex - 1);\n\t\tl.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t}\n\n\treturn [r, l];\n}\n\n/**\n * Commute two patches with a common array ancestor\n * @param l\n * @param lpath\n * @param r\n * @param rpath\n * @param direction\n * @returns {*}\n */\nfunction commuteArrayAncestor(l, lpath, r, rpath, direction) {\n\t// rpath is longer or same length\n\n\tvar target = lpath.length-1;\n\tvar lindex = +lpath[target];\n\tvar rindex = +rpath[target];\n\n\t// Copy rpath, then adjust its array index\n\tvar rc = rpath.slice();\n\n\tif(lindex > rindex) {\n\t\treturn rc;\n\t}\n\n\tif(l.op === 'add' || l.op === 'copy') {\n\t\trc[target] = Math.max(0, rindex - direction);\n\t} else if(l.op === 'remove') {\n\t\trc[target] = Math.max(0, rindex + direction);\n\t}\n\n\treturn rc;\n}\n\nfunction getCommonPathPrefix(p1, p2) {\n\tvar p1l = p1.length;\n\tvar p2l = p2.length;\n\tif(p1l === 0 || p2l === 0 || (p1l < 2 && p2l < 2)) {\n\t\treturn [];\n\t}\n\n\t// If paths are same length, the last segment cannot be part\n\t// of a common prefix.  If not the same length, the prefix cannot\n\t// be longer than the shorter path.\n\tvar l = p1l === p2l\n\t\t? p1l - 1\n\t\t: Math.min(p1l, p2l);\n\n\tvar i = 0;\n\twhile(i < l && p1[i] === p2[i]) {\n\t\t++i\n\t}\n\n\treturn p1.slice(0, i);\n}\n\nfunction copyPatch(p) {\n\tif(p.op === 'remove') {\n\t\treturn { op: p.op, path: p.path };\n\t}\n\n\tif(p.op === 'copy' || p.op === 'move') {\n\t\treturn { op: p.op, path: p.path, from: p.from };\n\t}\n\n\t// test, add, replace\n\treturn { op: p.op, path: p.path, value: p.value };\n}\n},{\"./jsonPointer\":16}],13:[function(require,module,exports){\nmodule.exports = deepEquals;\n\n/**\n * Compare 2 JSON values, or recursively compare 2 JSON objects or arrays\n * @param {object|array|string|number|boolean|null} a\n * @param {object|array|string|number|boolean|null} b\n * @returns {boolean} true iff a and b are recursively equal\n */\nfunction deepEquals(a, b) {\n\tif(a === b) {\n\t\treturn true;\n\t}\n\n\tif(Array.isArray(a) && Array.isArray(b)) {\n\t\treturn compareArrays(a, b);\n\t}\n\n\tif(typeof a === 'object' && typeof b === 'object') {\n\t\treturn compareObjects(a, b);\n\t}\n\n\treturn false;\n}\n\nfunction compareArrays(a, b) {\n\tif(a.length !== b.length) {\n\t\treturn false;\n\t}\n\n\tfor(var i = 0; i<a.length; ++i) {\n\t\tif(!deepEquals(a[i], b[i])) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction compareObjects(a, b) {\n\tif((a === null && b !== null) || (a !== null && b === null)) {\n\t\treturn false;\n\t}\n\n\tvar akeys = Object.keys(a);\n\tvar bkeys = Object.keys(b);\n\n\tif(akeys.length !== bkeys.length) {\n\t\treturn false;\n\t}\n\n\tfor(var i = 0, k; i<akeys.length; ++i) {\n\t\tk = akeys[i];\n\t\tif(!(k in b && deepEquals(a[k], b[k]))) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n},{}],14:[function(require,module,exports){\nvar patches = require('./patches');\n\nmodule.exports = function inverse(p) {\n\tvar pr = [];\n\tvar i, skip;\n\tfor(i = p.length-1; i>= 0; i -= skip) {\n\t\tskip = invertOp(pr, p[i], i, p);\n\t}\n\n\treturn pr;\n};\n\nfunction invertOp(patch, c, i, context) {\n\tvar op = patches[c.op];\n\treturn op !== void 0 && typeof op.inverse === 'function'\n\t\t? op.inverse(patch, c, i, context)\n\t\t: 1;\n}\n\n},{\"./patches\":19}],15:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nvar patches = require('./patches');\nvar clone = require('./clone');\nvar InvalidPatchOperationError = require('./InvalidPatchOperationError');\n\nexports.apply = patch;\nexports.applyInPlace = patchInPlace;\nexports.clone = clone;\nexports.isValidObject = isValidObject;\nexports.defaultHash = defaultHash;\n\nvar defaultOptions = {};\n\n/**\n * Apply the supplied JSON Patch to x\n * @param {array} changes JSON Patch\n * @param {object|array|string|number} x object/array/value to patch\n * @param {object} options\n * @param {function(index:Number, array:Array, context:object):Number} options.findContext\n *  function used adjust array indexes for smarty/fuzzy patching, for\n *  patches containing context\n * @returns {object|array|string|number} patched version of x. If x is\n *  an array or object, it will be mutated and returned. Otherwise, if\n *  x is a value, the new value will be returned.\n */\nfunction patch(changes, x, options) {\n\treturn patchInPlace(changes, clone(x), options);\n}\n\nfunction patchInPlace(changes, x, options) {\n\tif(!options) {\n\t\toptions = defaultOptions;\n\t}\n\n\t// TODO: Consider throwing if changes is not an array\n\tif(!Array.isArray(changes)) {\n\t\treturn x;\n\t}\n\n\tvar patch, p;\n\tfor(var i=0; i<changes.length; ++i) {\n\t\tp = changes[i];\n\t\tpatch = patches[p.op];\n\n\t\tif(patch === void 0) {\n\t\t\tthrow new InvalidPatchOperationError('invalid op ' + JSON.stringify(p));\n\t\t}\n\n\t\tx = patch.apply(x, p, options);\n\t}\n\n\treturn x;\n}\n\nfunction defaultHash(x) {\n\treturn isValidObject(x) || isArray(x) ? JSON.stringify(x) : x;\n}\n\nfunction isValidObject (x) {\n\treturn x !== null && Object.prototype.toString.call(x) === '[object Object]';\n}\n\nfunction isArray (x) {\n\treturn Object.prototype.toString.call(x) === '[object Array]';\n}\n\n},{\"./InvalidPatchOperationError\":7,\"./clone\":11,\"./patches\":19}],16:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nvar _parse = require('./jsonPointerParse');\n\nexports.find = find;\nexports.join = join;\nexports.absolute = absolute;\nexports.parse = parse;\nexports.contains = contains;\nexports.encodeSegment = encodeSegment;\nexports.decodeSegment = decodeSegment;\nexports.parseArrayIndex = parseArrayIndex;\nexports.isValidArrayIndex = isValidArrayIndex;\n\n// http://tools.ietf.org/html/rfc6901#page-2\nvar separator = '/';\nvar separatorRx = /\\//g;\nvar encodedSeparator = '~1';\nvar encodedSeparatorRx = /~1/g;\n\nvar escapeChar = '~';\nvar escapeRx = /~/g;\nvar encodedEscape = '~0';\nvar encodedEscapeRx = /~0/g;\n\n/**\n * Find the parent of the specified path in x and return a descriptor\n * containing the parent and a key.  If the parent does not exist in x,\n * return undefined, instead.\n * @param {object|array} x object or array in which to search\n * @param {string} path JSON Pointer string (encoded)\n * @param {?function(index:Number, array:Array, context:object):Number} findContext\n *  optional function used adjust array indexes for smarty/fuzzy patching, for\n *  patches containing context.  If provided, context MUST also be provided.\n * @param {?{before:Array, after:Array}} context optional patch context for\n *  findContext to use to adjust array indices.  If provided, findContext MUST\n *  also be provided.\n * @returns {{target:object|array|number|string, key:string}|undefined}\n */\nfunction find(x, path, findContext, context) {\n\tif(typeof path !== 'string') {\n\t\treturn;\n\t}\n\n\tif(path === '') {\n\t\t// whole document\n\t\treturn { target: x, key: void 0 };\n\t}\n\n\tif(path === separator) {\n\t\treturn { target: x, key: '' };\n\t}\n\n\tvar parent = x, key;\n\tvar hasContext = context !== void 0;\n\n\t_parse(path, function(segment) {\n\t\t// hm... this seems like it should be if(typeof x === 'undefined')\n\t\tif(x == null) {\n\t\t\t// Signal that we prematurely hit the end of the path hierarchy.\n\t\t\tparent = null;\n\t\t\treturn false;\n\t\t}\n\n\t\tif(Array.isArray(x)) {\n\t\t\tkey = hasContext\n\t\t\t\t? findIndex(findContext, parseArrayIndex(segment), x, context)\n\t\t\t\t: segment === '-' ? segment : parseArrayIndex(segment);\n\t\t} else {\n\t\t\tkey = segment;\n\t\t}\n\n\t\tparent = x;\n\t\tx = x[key];\n\t});\n\n\treturn parent === null\n\t\t? void 0\n\t\t: { target: parent, key: key };\n}\n\nfunction absolute(path) {\n\treturn path[0] === separator ? path : separator + path;\n}\n\nfunction join(segments) {\n\treturn segments.join(separator);\n}\n\nfunction parse(path) {\n\tvar segments = [];\n\t_parse(path, segments.push.bind(segments));\n\treturn segments;\n}\n\nfunction contains(a, b) {\n\treturn b.indexOf(a) === 0 && b[a.length] === separator;\n}\n\n/**\n * Decode a JSON Pointer path segment\n * @see http://tools.ietf.org/html/rfc6901#page-3\n * @param {string} s encoded segment\n * @returns {string} decoded segment\n */\nfunction decodeSegment(s) {\n\t// See: http://tools.ietf.org/html/rfc6901#page-3\n\treturn s.replace(encodedSeparatorRx, separator).replace(encodedEscapeRx, escapeChar);\n}\n\n/**\n * Encode a JSON Pointer path segment\n * @see http://tools.ietf.org/html/rfc6901#page-3\n * @param {string} s decoded segment\n * @returns {string} encoded segment\n */\nfunction encodeSegment(s) {\n\treturn s.replace(escapeRx, encodedEscape).replace(separatorRx, encodedSeparator);\n}\n\nvar arrayIndexRx = /^(0|[1-9]\\d*)$/;\n\n/**\n * Return true if s is a valid JSON Pointer array index\n * @param {String} s\n * @returns {boolean}\n */\nfunction isValidArrayIndex(s) {\n\treturn arrayIndexRx.test(s);\n}\n\n/**\n * Safely parse a string into a number >= 0. Does not check for decimal numbers\n * @param {string} s numeric string\n * @returns {number} number >= 0\n */\nfunction parseArrayIndex (s) {\n\tif(isValidArrayIndex(s)) {\n\t\treturn +s;\n\t}\n\n\tthrow new SyntaxError('invalid array index ' + s);\n}\n\nfunction findIndex (findContext, start, array, context) {\n\tvar index = start;\n\n\tif(index < 0) {\n\t\tthrow new Error('array index out of bounds ' + index);\n\t}\n\n\tif(context !== void 0 && typeof findContext === 'function') {\n\t\tindex = findContext(start, array, context);\n\t\tif(index < 0) {\n\t\t\tthrow new Error('could not find patch context ' + context);\n\t\t}\n\t}\n\n\treturn index;\n}\n},{\"./jsonPointerParse\":17}],17:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nmodule.exports = jsonPointerParse;\n\nvar parseRx = /\\/|~1|~0/g;\nvar separator = '/';\nvar escapeChar = '~';\nvar encodedSeparator = '~1';\n\n/**\n * Parse through an encoded JSON Pointer string, decoding each path segment\n * and passing it to an onSegment callback function.\n * @see https://tools.ietf.org/html/rfc6901#section-4\n * @param {string} path encoded JSON Pointer string\n * @param {{function(segment:string):boolean}} onSegment callback function\n * @returns {string} original path\n */\nfunction jsonPointerParse(path, onSegment) {\n\tvar pos, accum, matches, match;\n\n\tpos = path.charAt(0) === separator ? 1 : 0;\n\taccum = '';\n\tparseRx.lastIndex = pos;\n\n\twhile(matches = parseRx.exec(path)) {\n\n\t\tmatch = matches[0];\n\t\taccum += path.slice(pos, parseRx.lastIndex - match.length);\n\t\tpos = parseRx.lastIndex;\n\n\t\tif(match === separator) {\n\t\t\tif (onSegment(accum) === false) return path;\n\t\t\taccum = '';\n\t\t} else {\n\t\t\taccum += match === encodedSeparator ? separator : escapeChar;\n\t\t}\n\t}\n\n\taccum += path.slice(pos);\n\tonSegment(accum);\n\n\treturn path;\n}\n\n},{}],18:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexports.compare = compare;\nexports.reduce = reduce;\n\nvar REMOVE, RIGHT, ADD, DOWN, SKIP;\n\nexports.REMOVE = REMOVE = RIGHT = -1;\nexports.ADD    = ADD    = DOWN  =  1;\nexports.EQUAL  = SKIP   = 0;\n\n/**\n * Create an lcs comparison matrix describing the differences\n * between two array-like sequences\n * @param {array} a array-like\n * @param {array} b array-like\n * @returns {object} lcs descriptor, suitable for passing to reduce()\n */\nfunction compare(a, b) {\n\tvar cols = a.length;\n\tvar rows = b.length;\n\n\tvar prefix = findPrefix(a, b);\n\tvar suffix = prefix < cols && prefix < rows\n\t\t? findSuffix(a, b, prefix)\n\t\t: 0;\n\n\tvar remove = suffix + prefix - 1;\n\tcols -= remove;\n\trows -= remove;\n\tvar matrix = createMatrix(cols, rows);\n\n\tfor (var j = cols - 1; j >= 0; --j) {\n\t\tfor (var i = rows - 1; i >= 0; --i) {\n\t\t\tmatrix[i][j] = backtrack(matrix, a, b, prefix, j, i);\n\t\t}\n\t}\n\n\treturn {\n\t\tprefix: prefix,\n\t\tmatrix: matrix,\n\t\tsuffix: suffix\n\t};\n}\n\n/**\n * Reduce a set of lcs changes previously created using compare\n * @param {function(result:*, type:number, i:number, j:number)} f\n *  reducer function, where:\n *  - result is the current reduce value,\n *  - type is the type of change: ADD, REMOVE, or SKIP\n *  - i is the index of the change location in b\n *  - j is the index of the change location in a\n * @param {*} r initial value\n * @param {object} lcs results returned by compare()\n * @returns {*} the final reduced value\n */\nfunction reduce(f, r, lcs) {\n\tvar i, j, k, op;\n\n\tvar m = lcs.matrix;\n\n\t// Reduce shared prefix\n\tvar l = lcs.prefix;\n\tfor(i = 0;i < l; ++i) {\n\t\tr = f(r, SKIP, i, i);\n\t}\n\n\t// Reduce longest change span\n\tk = i;\n\tl = m.length;\n\ti = 0;\n\tj = 0;\n\twhile(i < l) {\n\t\top = m[i][j].type;\n\t\tr = f(r, op, i+k, j+k);\n\n\t\tswitch(op) {\n\t\t\tcase SKIP:  ++i; ++j; break;\n\t\t\tcase RIGHT: ++j; break;\n\t\t\tcase DOWN:  ++i; break;\n\t\t}\n\t}\n\n\t// Reduce shared suffix\n\ti += k;\n\tj += k;\n\tl = lcs.suffix;\n\tfor(k = 0;k < l; ++k) {\n\t\tr = f(r, SKIP, i+k, j+k);\n\t}\n\n\treturn r;\n}\n\nfunction findPrefix(a, b) {\n\tvar i = 0;\n\tvar l = Math.min(a.length, b.length);\n\twhile(i < l && a[i] === b[i]) {\n\t\t++i;\n\t}\n\treturn i;\n}\n\nfunction findSuffix(a, b) {\n\tvar al = a.length - 1;\n\tvar bl = b.length - 1;\n\tvar l = Math.min(al, bl);\n\tvar i = 0;\n\twhile(i < l && a[al-i] === b[bl-i]) {\n\t\t++i;\n\t}\n\treturn i;\n}\n\nfunction backtrack(matrix, a, b, start, j, i) {\n\tif (a[j+start] === b[i+start]) {\n\t\treturn { value: matrix[i + 1][j + 1].value, type: SKIP };\n\t}\n\tif (matrix[i][j + 1].value < matrix[i + 1][j].value) {\n\t\treturn { value: matrix[i][j + 1].value + 1, type: RIGHT };\n\t}\n\n\treturn { value: matrix[i + 1][j].value + 1, type: DOWN };\n}\n\nfunction createMatrix (cols, rows) {\n\tvar m = [], i, j, lastrow;\n\n\t// Fill the last row\n\tlastrow = m[rows] = [];\n\tfor (j = 0; j<cols; ++j) {\n\t\tlastrow[j] = { value: cols - j, type: RIGHT };\n\t}\n\n\t// Fill the last col\n\tfor (i = 0; i<rows; ++i) {\n\t\tm[i] = [];\n\t\tm[i][cols] = { value: rows - i, type: DOWN };\n\t}\n\n\t// Fill the last cell\n\tm[rows][cols] = { value: 0, type: SKIP };\n\n\treturn m;\n}\n\n},{}],19:[function(require,module,exports){\nvar jsonPointer = require('./jsonPointer');\nvar clone = require('./clone');\nvar deepEquals = require('./deepEquals');\nvar commutePaths = require('./commutePaths');\n\nvar array = require('./array');\n\nvar TestFailedError = require('./TestFailedError');\nvar InvalidPatchOperationError = require('./InvalidPatchOperationError');\nvar PatchNotInvertibleError = require('./PatchNotInvertibleError');\n\nvar find = jsonPointer.find;\nvar parseArrayIndex = jsonPointer.parseArrayIndex;\n\nexports.test = {\n\tapply: applyTest,\n\tinverse: invertTest,\n\tcommute: commuteTest\n};\n\nexports.add = {\n\tapply: applyAdd,\n\tinverse: invertAdd,\n\tcommute: commuteAddOrCopy\n};\n\nexports.remove = {\n\tapply: applyRemove,\n\tinverse: invertRemove,\n\tcommute: commuteRemove\n};\n\nexports.replace = {\n\tapply: applyReplace,\n\tinverse: invertReplace,\n\tcommute: commuteReplace\n};\n\nexports.move = {\n\tapply: applyMove,\n\tinverse: invertMove,\n\tcommute: commuteMove\n};\n\nexports.copy = {\n\tapply: applyCopy,\n\tinverse: notInvertible,\n\tcommute: commuteAddOrCopy\n};\n\n/**\n * Apply a test operation to x\n * @param {object|array} x\n * @param {object} test test operation\n * @throws {TestFailedError} if the test operation fails\n */\n\nfunction applyTest(x, test, options) {\n\tvar pointer = find(x, test.path, options.findContext, test.context);\n\tvar target = pointer.target;\n\tvar index, value;\n\n\tif(Array.isArray(target)) {\n\t\tindex = parseArrayIndex(pointer.key);\n\t\t//index = findIndex(options.findContext, index, target, test.context);\n\t\tvalue = target[index];\n\t} else {\n\t\tvalue = pointer.key === void 0 ? pointer.target : pointer.target[pointer.key];\n\t}\n\n\tif(!deepEquals(value, test.value)) {\n\t\tthrow new TestFailedError('test failed ' + JSON.stringify(test));\n\t}\n\n\treturn x;\n}\n\n/**\n * Invert the provided test and add it to the inverted patch sequence\n * @param pr\n * @param test\n * @returns {number}\n */\nfunction invertTest(pr, test) {\n\tpr.push(test);\n\treturn 1;\n}\n\nfunction commuteTest(test, b) {\n\tif(test.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute test,remove -> remove,test for same path');\n\t}\n\n\tif(b.op === 'test' || b.op === 'replace') {\n\t\treturn [b, test];\n\t}\n\n\treturn commutePaths(test, b);\n}\n\n/**\n * Apply an add operation to x\n * @param {object|array} x\n * @param {object} change add operation\n */\nfunction applyAdd(x, change, options) {\n\tvar pointer = find(x, change.path, options.findContext, change.context);\n\n\tif(notFound(pointer)) {\n\t\tthrow new InvalidPatchOperationError('path does not exist ' + change.path);\n\t}\n\n\tif(change.value === void 0) {\n\t\tthrow new InvalidPatchOperationError('missing value');\n\t}\n\n\tvar val = clone(change.value);\n\n\t// If pointer refers to whole document, replace whole document\n\tif(pointer.key === void 0) {\n\t\treturn val;\n\t}\n\n\t_add(pointer, val);\n\treturn x;\n}\n\nfunction _add(pointer, value) {\n\tvar target = pointer.target;\n\n\tif(Array.isArray(target)) {\n\t\t// '-' indicates 'append' to array\n\t\tif(pointer.key === '-') {\n\t\t\ttarget.push(value);\n\t\t} else if (pointer.key > target.length) {\n\t\t\tthrow new InvalidPatchOperationError('target of add outside of array bounds')\n\t\t} else {\n\t\t\ttarget.splice(pointer.key, 0, value);\n\t\t}\n\t} else if(isValidObject(target)) {\n\t\ttarget[pointer.key] = value;\n\t} else {\n\t\tthrow new InvalidPatchOperationError('target of add must be an object or array ' + pointer.key);\n\t}\n}\n\nfunction invertAdd(pr, add) {\n\tvar context = add.context;\n\tif(context !== void 0) {\n\t\tcontext = {\n\t\t\tbefore: context.before,\n\t\t\tafter: array.cons(add.value, context.after)\n\t\t}\n\t}\n\tpr.push({ op: 'test', path: add.path, value: add.value, context: context });\n\tpr.push({ op: 'remove', path: add.path, context: context });\n\treturn 1;\n}\n\nfunction commuteAddOrCopy(add, b) {\n\tif(add.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute add,remove -> remove,add for same path');\n\t}\n\n\treturn commutePaths(add, b);\n}\n\n/**\n * Apply a replace operation to x\n * @param {object|array} x\n * @param {object} change replace operation\n */\nfunction applyReplace(x, change, options) {\n\tvar pointer = find(x, change.path, options.findContext, change.context);\n\n\tif(notFound(pointer) || missingValue(pointer)) {\n\t\tthrow new InvalidPatchOperationError('path does not exist ' + change.path);\n\t}\n\n\tif(change.value === void 0) {\n\t\tthrow new InvalidPatchOperationError('missing value');\n\t}\n\n\tvar value = clone(change.value);\n\n\t// If pointer refers to whole document, replace whole document\n\tif(pointer.key === void 0) {\n\t\treturn value;\n\t}\n\n\tvar target = pointer.target;\n\n\tif(Array.isArray(target)) {\n\t\ttarget[parseArrayIndex(pointer.key)] = value;\n\t} else {\n\t\ttarget[pointer.key] = value;\n\t}\n\n\treturn x;\n}\n\nfunction invertReplace(pr, c, i, patch) {\n\tvar prev = patch[i-1];\n\tif(prev === void 0 || prev.op !== 'test' || prev.path !== c.path) {\n\t\tthrow new PatchNotInvertibleError('cannot invert replace w/o test');\n\t}\n\n\tvar context = prev.context;\n\tif(context !== void 0) {\n\t\tcontext = {\n\t\t\tbefore: context.before,\n\t\t\tafter: array.cons(prev.value, array.tail(context.after))\n\t\t}\n\t}\n\n\tpr.push({ op: 'test', path: prev.path, value: c.value });\n\tpr.push({ op: 'replace', path: prev.path, value: prev.value });\n\treturn 2;\n}\n\nfunction commuteReplace(replace, b) {\n\tif(replace.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute replace,remove -> remove,replace for same path');\n\t}\n\n\tif(b.op === 'test' || b.op === 'replace') {\n\t\treturn [b, replace];\n\t}\n\n\treturn commutePaths(replace, b);\n}\n\n/**\n * Apply a remove operation to x\n * @param {object|array} x\n * @param {object} change remove operation\n */\nfunction applyRemove(x, change, options) {\n\tvar pointer = find(x, change.path, options.findContext, change.context);\n\n\t// key must exist for remove\n\tif(notFound(pointer) || pointer.target[pointer.key] === void 0) {\n\t\tthrow new InvalidPatchOperationError('path does not exist ' + change.path);\n\t}\n\n\t_remove(pointer);\n\treturn x;\n}\n\nfunction _remove (pointer) {\n\tvar target = pointer.target;\n\n\tvar removed;\n\tif (Array.isArray(target)) {\n\t\tremoved = target.splice(parseArrayIndex(pointer.key), 1);\n\t\treturn removed[0];\n\n\t} else if (isValidObject(target)) {\n\t\tremoved = target[pointer.key];\n\t\tdelete target[pointer.key];\n\t\treturn removed;\n\n\t} else {\n\t\tthrow new InvalidPatchOperationError('target of remove must be an object or array');\n\t}\n}\n\nfunction invertRemove(pr, c, i, patch) {\n\tvar prev = patch[i-1];\n\tif(prev === void 0 || prev.op !== 'test' || prev.path !== c.path) {\n\t\tthrow new PatchNotInvertibleError('cannot invert remove w/o test');\n\t}\n\n\tvar context = prev.context;\n\tif(context !== void 0) {\n\t\tcontext = {\n\t\t\tbefore: context.before,\n\t\t\tafter: array.tail(context.after)\n\t\t}\n\t}\n\n\tpr.push({ op: 'add', path: prev.path, value: prev.value, context: context });\n\treturn 2;\n}\n\nfunction commuteRemove(remove, b) {\n\tif(remove.path === b.path && b.op === 'remove') {\n\t\treturn [b, remove];\n\t}\n\n\treturn commutePaths(remove, b);\n}\n\n/**\n * Apply a move operation to x\n * @param {object|array} x\n * @param {object} change move operation\n */\nfunction applyMove(x, change, options) {\n\tif(jsonPointer.contains(change.path, change.from)) {\n\t\tthrow new InvalidPatchOperationError('move.from cannot be ancestor of move.path');\n\t}\n\n\tvar pto = find(x, change.path, options.findContext, change.context);\n\tvar pfrom = find(x, change.from, options.findContext, change.fromContext);\n\n\t_add(pto, _remove(pfrom));\n\treturn x;\n}\n\nfunction invertMove(pr, c) {\n\tpr.push({ op: 'move',\n\t\tpath: c.from, context: c.fromContext,\n\t\tfrom: c.path, fromContext: c.context });\n\treturn 1;\n}\n\nfunction commuteMove(move, b) {\n\tif(move.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute move,remove -> move,replace for same path');\n\t}\n\n\treturn commutePaths(move, b);\n}\n\n/**\n * Apply a copy operation to x\n * @param {object|array} x\n * @param {object} change copy operation\n */\nfunction applyCopy(x, change, options) {\n\tvar pto = find(x, change.path, options.findContext, change.context);\n\tvar pfrom = find(x, change.from, options.findContext, change.fromContext);\n\n\tif(notFound(pfrom) || missingValue(pfrom)) {\n\t\tthrow new InvalidPatchOperationError('copy.from must exist');\n\t}\n\n\tvar target = pfrom.target;\n\tvar value;\n\n\tif(Array.isArray(target)) {\n\t\tvalue = target[parseArrayIndex(pfrom.key)];\n\t} else {\n\t\tvalue = target[pfrom.key];\n\t}\n\n\t_add(pto, clone(value));\n\treturn x;\n}\n\n// NOTE: Copy is not invertible\n// See https://github.com/cujojs/jiff/issues/9\n// This needs more thought. We may have to extend/amend JSON Patch.\n// At first glance, this seems like it should just be a remove.\n// However, that's not correct.  It violates the involution:\n// invert(invert(p)) ~= p.  For example:\n// invert(copy) -> remove\n// invert(remove) -> add\n// thus: invert(invert(copy)) -> add (DOH! this should be copy!)\n\nfunction notInvertible(_, c) {\n\tthrow new PatchNotInvertibleError('cannot invert ' + c.op);\n}\n\nfunction notFound (pointer) {\n\treturn pointer === void 0 || (pointer.target == null && pointer.key !== void 0);\n}\n\nfunction missingValue(pointer) {\n\treturn pointer.key !== void 0 && pointer.target[pointer.key] === void 0;\n}\n\n/**\n * Return true if x is a non-null object\n * @param {*} x\n * @returns {boolean}\n */\nfunction isValidObject (x) {\n\treturn x !== null && typeof x === 'object';\n}\n\n},{\"./InvalidPatchOperationError\":7,\"./PatchNotInvertibleError\":8,\"./TestFailedError\":9,\"./array\":10,\"./clone\":11,\"./commutePaths\":12,\"./deepEquals\":13,\"./jsonPointer\":16}],20:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],21:[function(require,module,exports){\n(function (process){\n// vim:ts=4:sts=4:sw=4:\n/*!\n *\n * Copyright 2009-2017 Kris Kowal under the terms of the MIT\n * license found at https://github.com/kriskowal/q/blob/v1/LICENSE\n *\n * With parts by Tyler Close\n * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found\n * at http://www.opensource.org/licenses/mit-license.html\n * Forked at ref_send.js version: 2009-05-11\n *\n * With parts by Mark Miller\n * Copyright (C) 2011 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n(function (definition) {\n    \"use strict\";\n\n    // This file will function properly as a <script> tag, or a module\n    // using CommonJS and NodeJS or RequireJS module formats.  In\n    // Common/Node/RequireJS, the module exports the Q API and when\n    // executed as a simple <script>, it creates a Q global instead.\n\n    // Montage Require\n    if (typeof bootstrap === \"function\") {\n        bootstrap(\"promise\", definition);\n\n    // CommonJS\n    } else if (typeof exports === \"object\" && typeof module === \"object\") {\n        module.exports = definition();\n\n    // RequireJS\n    } else if (typeof define === \"function\" && define.amd) {\n        define(definition);\n\n    // SES (Secure EcmaScript)\n    } else if (typeof ses !== \"undefined\") {\n        if (!ses.ok()) {\n            return;\n        } else {\n            ses.makeQ = definition;\n        }\n\n    // <script>\n    } else if (typeof window !== \"undefined\" || typeof self !== \"undefined\") {\n        // Prefer window over self for add-on scripts. Use self for\n        // non-windowed contexts.\n        var global = typeof window !== \"undefined\" ? window : self;\n\n        // Get the `window` object, save the previous Q global\n        // and initialize Q as a global.\n        var previousQ = global.Q;\n        global.Q = definition();\n\n        // Add a noConflict function so Q can be removed from the\n        // global namespace.\n        global.Q.noConflict = function () {\n            global.Q = previousQ;\n            return this;\n        };\n\n    } else {\n        throw new Error(\"This environment was not anticipated by Q. Please file a bug.\");\n    }\n\n})(function () {\n\"use strict\";\n\nvar hasStacks = false;\ntry {\n    throw new Error();\n} catch (e) {\n    hasStacks = !!e.stack;\n}\n\n// All code after this point will be filtered from stack traces reported\n// by Q.\nvar qStartingLine = captureLine();\nvar qFileName;\n\n// shims\n\n// used for fallback in \"allResolved\"\nvar noop = function () {};\n\n// Use the fastest possible means to execute a task in a future turn\n// of the event loop.\nvar nextTick =(function () {\n    // linked list of tasks (single, with head node)\n    var head = {task: void 0, next: null};\n    var tail = head;\n    var flushing = false;\n    var requestTick = void 0;\n    var isNodeJS = false;\n    // queue for late tasks, used by unhandled rejection tracking\n    var laterQueue = [];\n\n    function flush() {\n        /* jshint loopfunc: true */\n        var task, domain;\n\n        while (head.next) {\n            head = head.next;\n            task = head.task;\n            head.task = void 0;\n            domain = head.domain;\n\n            if (domain) {\n                head.domain = void 0;\n                domain.enter();\n            }\n            runSingle(task, domain);\n\n        }\n        while (laterQueue.length) {\n            task = laterQueue.pop();\n            runSingle(task);\n        }\n        flushing = false;\n    }\n    // runs a single function in the async queue\n    function runSingle(task, domain) {\n        try {\n            task();\n\n        } catch (e) {\n            if (isNodeJS) {\n                // In node, uncaught exceptions are considered fatal errors.\n                // Re-throw them synchronously to interrupt flushing!\n\n                // Ensure continuation if the uncaught exception is suppressed\n                // listening \"uncaughtException\" events (as domains does).\n                // Continue in next event to avoid tick recursion.\n                if (domain) {\n                    domain.exit();\n                }\n                setTimeout(flush, 0);\n                if (domain) {\n                    domain.enter();\n                }\n\n                throw e;\n\n            } else {\n                // In browsers, uncaught exceptions are not fatal.\n                // Re-throw them asynchronously to avoid slow-downs.\n                setTimeout(function () {\n                    throw e;\n                }, 0);\n            }\n        }\n\n        if (domain) {\n            domain.exit();\n        }\n    }\n\n    nextTick = function (task) {\n        tail = tail.next = {\n            task: task,\n            domain: isNodeJS && process.domain,\n            next: null\n        };\n\n        if (!flushing) {\n            flushing = true;\n            requestTick();\n        }\n    };\n\n    if (typeof process === \"object\" &&\n        process.toString() === \"[object process]\" && process.nextTick) {\n        // Ensure Q is in a real Node environment, with a `process.nextTick`.\n        // To see through fake Node environments:\n        // * Mocha test runner - exposes a `process` global without a `nextTick`\n        // * Browserify - exposes a `process.nexTick` function that uses\n        //   `setTimeout`. In this case `setImmediate` is preferred because\n        //    it is faster. Browserify's `process.toString()` yields\n        //   \"[object Object]\", while in a real Node environment\n        //   `process.toString()` yields \"[object process]\".\n        isNodeJS = true;\n\n        requestTick = function () {\n            process.nextTick(flush);\n        };\n\n    } else if (typeof setImmediate === \"function\") {\n        // In IE10, Node.js 0.9+, or https://github.com/NobleJS/setImmediate\n        if (typeof window !== \"undefined\") {\n            requestTick = setImmediate.bind(window, flush);\n        } else {\n            requestTick = function () {\n                setImmediate(flush);\n            };\n        }\n\n    } else if (typeof MessageChannel !== \"undefined\") {\n        // modern browsers\n        // http://www.nonblocking.io/2011/06/windownexttick.html\n        var channel = new MessageChannel();\n        // At least Safari Version 6.0.5 (8536.30.1) intermittently cannot create\n        // working message ports the first time a page loads.\n        channel.port1.onmessage = function () {\n            requestTick = requestPortTick;\n            channel.port1.onmessage = flush;\n            flush();\n        };\n        var requestPortTick = function () {\n            // Opera requires us to provide a message payload, regardless of\n            // whether we use it.\n            channel.port2.postMessage(0);\n        };\n        requestTick = function () {\n            setTimeout(flush, 0);\n            requestPortTick();\n        };\n\n    } else {\n        // old browsers\n        requestTick = function () {\n            setTimeout(flush, 0);\n        };\n    }\n    // runs a task after all other tasks have been run\n    // this is useful for unhandled rejection tracking that needs to happen\n    // after all `then`d tasks have been run.\n    nextTick.runAfter = function (task) {\n        laterQueue.push(task);\n        if (!flushing) {\n            flushing = true;\n            requestTick();\n        }\n    };\n    return nextTick;\n})();\n\n// Attempt to make generics safe in the face of downstream\n// modifications.\n// There is no situation where this is necessary.\n// If you need a security guarantee, these primordials need to be\n// deeply frozen anyway, and if you dont need a security guarantee,\n// this is just plain paranoid.\n// However, this **might** have the nice side-effect of reducing the size of\n// the minified code by reducing x.call() to merely x()\n// See Mark Millers explanation of what this does.\n// http://wiki.ecmascript.org/doku.php?id=conventions:safe_meta_programming\nvar call = Function.call;\nfunction uncurryThis(f) {\n    return function () {\n        return call.apply(f, arguments);\n    };\n}\n// This is equivalent, but slower:\n// uncurryThis = Function_bind.bind(Function_bind.call);\n// http://jsperf.com/uncurrythis\n\nvar array_slice = uncurryThis(Array.prototype.slice);\n\nvar array_reduce = uncurryThis(\n    Array.prototype.reduce || function (callback, basis) {\n        var index = 0,\n            length = this.length;\n        // concerning the initial value, if one is not provided\n        if (arguments.length === 1) {\n            // seek to the first value in the array, accounting\n            // for the possibility that is is a sparse array\n            do {\n                if (index in this) {\n                    basis = this[index++];\n                    break;\n                }\n                if (++index >= length) {\n                    throw new TypeError();\n                }\n            } while (1);\n        }\n        // reduce\n        for (; index < length; index++) {\n            // account for the possibility that the array is sparse\n            if (index in this) {\n                basis = callback(basis, this[index], index);\n            }\n        }\n        return basis;\n    }\n);\n\nvar array_indexOf = uncurryThis(\n    Array.prototype.indexOf || function (value) {\n        // not a very good shim, but good enough for our one use of it\n        for (var i = 0; i < this.length; i++) {\n            if (this[i] === value) {\n                return i;\n            }\n        }\n        return -1;\n    }\n);\n\nvar array_map = uncurryThis(\n    Array.prototype.map || function (callback, thisp) {\n        var self = this;\n        var collect = [];\n        array_reduce(self, function (undefined, value, index) {\n            collect.push(callback.call(thisp, value, index, self));\n        }, void 0);\n        return collect;\n    }\n);\n\nvar object_create = Object.create || function (prototype) {\n    function Type() { }\n    Type.prototype = prototype;\n    return new Type();\n};\n\nvar object_defineProperty = Object.defineProperty || function (obj, prop, descriptor) {\n    obj[prop] = descriptor.value;\n    return obj;\n};\n\nvar object_hasOwnProperty = uncurryThis(Object.prototype.hasOwnProperty);\n\nvar object_keys = Object.keys || function (object) {\n    var keys = [];\n    for (var key in object) {\n        if (object_hasOwnProperty(object, key)) {\n            keys.push(key);\n        }\n    }\n    return keys;\n};\n\nvar object_toString = uncurryThis(Object.prototype.toString);\n\nfunction isObject(value) {\n    return value === Object(value);\n}\n\n// generator related shims\n\n// FIXME: Remove this function once ES6 generators are in SpiderMonkey.\nfunction isStopIteration(exception) {\n    return (\n        object_toString(exception) === \"[object StopIteration]\" ||\n        exception instanceof QReturnValue\n    );\n}\n\n// FIXME: Remove this helper and Q.return once ES6 generators are in\n// SpiderMonkey.\nvar QReturnValue;\nif (typeof ReturnValue !== \"undefined\") {\n    QReturnValue = ReturnValue;\n} else {\n    QReturnValue = function (value) {\n        this.value = value;\n    };\n}\n\n// long stack traces\n\nvar STACK_JUMP_SEPARATOR = \"From previous event:\";\n\nfunction makeStackTraceLong(error, promise) {\n    // If possible, transform the error stack trace by removing Node and Q\n    // cruft, then concatenating with the stack trace of `promise`. See #57.\n    if (hasStacks &&\n        promise.stack &&\n        typeof error === \"object\" &&\n        error !== null &&\n        error.stack\n    ) {\n        var stacks = [];\n        for (var p = promise; !!p; p = p.source) {\n            if (p.stack && (!error.__minimumStackCounter__ || error.__minimumStackCounter__ > p.stackCounter)) {\n                object_defineProperty(error, \"__minimumStackCounter__\", {value: p.stackCounter, configurable: true});\n                stacks.unshift(p.stack);\n            }\n        }\n        stacks.unshift(error.stack);\n\n        var concatedStacks = stacks.join(\"\\n\" + STACK_JUMP_SEPARATOR + \"\\n\");\n        var stack = filterStackString(concatedStacks);\n        object_defineProperty(error, \"stack\", {value: stack, configurable: true});\n    }\n}\n\nfunction filterStackString(stackString) {\n    var lines = stackString.split(\"\\n\");\n    var desiredLines = [];\n    for (var i = 0; i < lines.length; ++i) {\n        var line = lines[i];\n\n        if (!isInternalFrame(line) && !isNodeFrame(line) && line) {\n            desiredLines.push(line);\n        }\n    }\n    return desiredLines.join(\"\\n\");\n}\n\nfunction isNodeFrame(stackLine) {\n    return stackLine.indexOf(\"(module.js:\") !== -1 ||\n           stackLine.indexOf(\"(node.js:\") !== -1;\n}\n\nfunction getFileNameAndLineNumber(stackLine) {\n    // Named functions: \"at functionName (filename:lineNumber:columnNumber)\"\n    // In IE10 function name can have spaces (\"Anonymous function\") O_o\n    var attempt1 = /at .+ \\((.+):(\\d+):(?:\\d+)\\)$/.exec(stackLine);\n    if (attempt1) {\n        return [attempt1[1], Number(attempt1[2])];\n    }\n\n    // Anonymous functions: \"at filename:lineNumber:columnNumber\"\n    var attempt2 = /at ([^ ]+):(\\d+):(?:\\d+)$/.exec(stackLine);\n    if (attempt2) {\n        return [attempt2[1], Number(attempt2[2])];\n    }\n\n    // Firefox style: \"function@filename:lineNumber or @filename:lineNumber\"\n    var attempt3 = /.*@(.+):(\\d+)$/.exec(stackLine);\n    if (attempt3) {\n        return [attempt3[1], Number(attempt3[2])];\n    }\n}\n\nfunction isInternalFrame(stackLine) {\n    var fileNameAndLineNumber = getFileNameAndLineNumber(stackLine);\n\n    if (!fileNameAndLineNumber) {\n        return false;\n    }\n\n    var fileName = fileNameAndLineNumber[0];\n    var lineNumber = fileNameAndLineNumber[1];\n\n    return fileName === qFileName &&\n        lineNumber >= qStartingLine &&\n        lineNumber <= qEndingLine;\n}\n\n// discover own file name and line number range for filtering stack\n// traces\nfunction captureLine() {\n    if (!hasStacks) {\n        return;\n    }\n\n    try {\n        throw new Error();\n    } catch (e) {\n        var lines = e.stack.split(\"\\n\");\n        var firstLine = lines[0].indexOf(\"@\") > 0 ? lines[1] : lines[2];\n        var fileNameAndLineNumber = getFileNameAndLineNumber(firstLine);\n        if (!fileNameAndLineNumber) {\n            return;\n        }\n\n        qFileName = fileNameAndLineNumber[0];\n        return fileNameAndLineNumber[1];\n    }\n}\n\nfunction deprecate(callback, name, alternative) {\n    return function () {\n        if (typeof console !== \"undefined\" &&\n            typeof console.warn === \"function\") {\n            console.warn(name + \" is deprecated, use \" + alternative +\n                         \" instead.\", new Error(\"\").stack);\n        }\n        return callback.apply(callback, arguments);\n    };\n}\n\n// end of shims\n// beginning of real work\n\n/**\n * Constructs a promise for an immediate reference, passes promises through, or\n * coerces promises from different systems.\n * @param value immediate reference or promise\n */\nfunction Q(value) {\n    // If the object is already a Promise, return it directly.  This enables\n    // the resolve function to both be used to created references from objects,\n    // but to tolerably coerce non-promises to promises.\n    if (value instanceof Promise) {\n        return value;\n    }\n\n    // assimilate thenables\n    if (isPromiseAlike(value)) {\n        return coerce(value);\n    } else {\n        return fulfill(value);\n    }\n}\nQ.resolve = Q;\n\n/**\n * Performs a task in a future turn of the event loop.\n * @param {Function} task\n */\nQ.nextTick = nextTick;\n\n/**\n * Controls whether or not long stack traces will be on\n */\nQ.longStackSupport = false;\n\n/**\n * The counter is used to determine the stopping point for building\n * long stack traces. In makeStackTraceLong we walk backwards through\n * the linked list of promises, only stacks which were created before\n * the rejection are concatenated.\n */\nvar longStackCounter = 1;\n\n// enable long stacks if Q_DEBUG is set\nif (typeof process === \"object\" && process && process.env && process.env.Q_DEBUG) {\n    Q.longStackSupport = true;\n}\n\n/**\n * Constructs a {promise, resolve, reject} object.\n *\n * `resolve` is a callback to invoke with a more resolved value for the\n * promise. To fulfill the promise, invoke `resolve` with any value that is\n * not a thenable. To reject the promise, invoke `resolve` with a rejected\n * thenable, or invoke `reject` with the reason directly. To resolve the\n * promise to another thenable, thus putting it in the same state, invoke\n * `resolve` with that other thenable.\n */\nQ.defer = defer;\nfunction defer() {\n    // if \"messages\" is an \"Array\", that indicates that the promise has not yet\n    // been resolved.  If it is \"undefined\", it has been resolved.  Each\n    // element of the messages array is itself an array of complete arguments to\n    // forward to the resolved promise.  We coerce the resolution value to a\n    // promise using the `resolve` function because it handles both fully\n    // non-thenable values and other thenables gracefully.\n    var messages = [], progressListeners = [], resolvedPromise;\n\n    var deferred = object_create(defer.prototype);\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, operands) {\n        var args = array_slice(arguments);\n        if (messages) {\n            messages.push(args);\n            if (op === \"when\" && operands[1]) { // progress operand\n                progressListeners.push(operands[1]);\n            }\n        } else {\n            Q.nextTick(function () {\n                resolvedPromise.promiseDispatch.apply(resolvedPromise, args);\n            });\n        }\n    };\n\n    // XXX deprecated\n    promise.valueOf = function () {\n        if (messages) {\n            return promise;\n        }\n        var nearerValue = nearer(resolvedPromise);\n        if (isPromise(nearerValue)) {\n            resolvedPromise = nearerValue; // shorten chain\n        }\n        return nearerValue;\n    };\n\n    promise.inspect = function () {\n        if (!resolvedPromise) {\n            return { state: \"pending\" };\n        }\n        return resolvedPromise.inspect();\n    };\n\n    if (Q.longStackSupport && hasStacks) {\n        try {\n            throw new Error();\n        } catch (e) {\n            // NOTE: don't try to use `Error.captureStackTrace` or transfer the\n            // accessor around; that causes memory leaks as per GH-111. Just\n            // reify the stack trace as a string ASAP.\n            //\n            // At the same time, cut off the first line; it's always just\n            // \"[object Promise]\\n\", as per the `toString`.\n            promise.stack = e.stack.substring(e.stack.indexOf(\"\\n\") + 1);\n            promise.stackCounter = longStackCounter++;\n        }\n    }\n\n    // NOTE: we do the checks for `resolvedPromise` in each method, instead of\n    // consolidating them into `become`, since otherwise we'd create new\n    // promises with the lines `become(whatever(value))`. See e.g. GH-252.\n\n    function become(newPromise) {\n        resolvedPromise = newPromise;\n\n        if (Q.longStackSupport && hasStacks) {\n            // Only hold a reference to the new promise if long stacks\n            // are enabled to reduce memory usage\n            promise.source = newPromise;\n        }\n\n        array_reduce(messages, function (undefined, message) {\n            Q.nextTick(function () {\n                newPromise.promiseDispatch.apply(newPromise, message);\n            });\n        }, void 0);\n\n        messages = void 0;\n        progressListeners = void 0;\n    }\n\n    deferred.promise = promise;\n    deferred.resolve = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(Q(value));\n    };\n\n    deferred.fulfill = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(fulfill(value));\n    };\n    deferred.reject = function (reason) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(reject(reason));\n    };\n    deferred.notify = function (progress) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        array_reduce(progressListeners, function (undefined, progressListener) {\n            Q.nextTick(function () {\n                progressListener(progress);\n            });\n        }, void 0);\n    };\n\n    return deferred;\n}\n\n/**\n * Creates a Node-style callback that will resolve or reject the deferred\n * promise.\n * @returns a nodeback\n */\ndefer.prototype.makeNodeResolver = function () {\n    var self = this;\n    return function (error, value) {\n        if (error) {\n            self.reject(error);\n        } else if (arguments.length > 2) {\n            self.resolve(array_slice(arguments, 1));\n        } else {\n            self.resolve(value);\n        }\n    };\n};\n\n/**\n * @param resolver {Function} a function that returns nothing and accepts\n * the resolve, reject, and notify functions for a deferred.\n * @returns a promise that may be resolved with the given resolve and reject\n * functions, or rejected by a thrown exception in resolver\n */\nQ.Promise = promise; // ES6\nQ.promise = promise;\nfunction promise(resolver) {\n    if (typeof resolver !== \"function\") {\n        throw new TypeError(\"resolver must be a function.\");\n    }\n    var deferred = defer();\n    try {\n        resolver(deferred.resolve, deferred.reject, deferred.notify);\n    } catch (reason) {\n        deferred.reject(reason);\n    }\n    return deferred.promise;\n}\n\npromise.race = race; // ES6\npromise.all = all; // ES6\npromise.reject = reject; // ES6\npromise.resolve = Q; // ES6\n\n// XXX experimental.  This method is a way to denote that a local value is\n// serializable and should be immediately dispatched to a remote upon request,\n// instead of passing a reference.\nQ.passByCopy = function (object) {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return object;\n};\n\nPromise.prototype.passByCopy = function () {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return this;\n};\n\n/**\n * If two promises eventually fulfill to the same value, promises that value,\n * but otherwise rejects.\n * @param x {Any*}\n * @param y {Any*}\n * @returns {Any*} a promise for x and y if they are the same, but a rejection\n * otherwise.\n *\n */\nQ.join = function (x, y) {\n    return Q(x).join(y);\n};\n\nPromise.prototype.join = function (that) {\n    return Q([this, that]).spread(function (x, y) {\n        if (x === y) {\n            // TODO: \"===\" should be Object.is or equiv\n            return x;\n        } else {\n            throw new Error(\"Q can't join: not the same: \" + x + \" \" + y);\n        }\n    });\n};\n\n/**\n * Returns a promise for the first of an array of promises to become settled.\n * @param answers {Array[Any*]} promises to race\n * @returns {Any*} the first promise to be settled\n */\nQ.race = race;\nfunction race(answerPs) {\n    return promise(function (resolve, reject) {\n        // Switch to this once we can assume at least ES5\n        // answerPs.forEach(function (answerP) {\n        //     Q(answerP).then(resolve, reject);\n        // });\n        // Use this in the meantime\n        for (var i = 0, len = answerPs.length; i < len; i++) {\n            Q(answerPs[i]).then(resolve, reject);\n        }\n    });\n}\n\nPromise.prototype.race = function () {\n    return this.then(Q.race);\n};\n\n/**\n * Constructs a Promise with a promise descriptor object and optional fallback\n * function.  The descriptor contains methods like when(rejected), get(name),\n * set(name, value), post(name, args), and delete(name), which all\n * return either a value, a promise for a value, or a rejection.  The fallback\n * accepts the operation name, a resolver, and any further arguments that would\n * have been forwarded to the appropriate method above had a method been\n * provided with the proper name.  The API makes no guarantees about the nature\n * of the returned object, apart from that it is usable whereever promises are\n * bought and sold.\n */\nQ.makePromise = Promise;\nfunction Promise(descriptor, fallback, inspect) {\n    if (fallback === void 0) {\n        fallback = function (op) {\n            return reject(new Error(\n                \"Promise does not support operation: \" + op\n            ));\n        };\n    }\n    if (inspect === void 0) {\n        inspect = function () {\n            return {state: \"unknown\"};\n        };\n    }\n\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, args) {\n        var result;\n        try {\n            if (descriptor[op]) {\n                result = descriptor[op].apply(promise, args);\n            } else {\n                result = fallback.call(promise, op, args);\n            }\n        } catch (exception) {\n            result = reject(exception);\n        }\n        if (resolve) {\n            resolve(result);\n        }\n    };\n\n    promise.inspect = inspect;\n\n    // XXX deprecated `valueOf` and `exception` support\n    if (inspect) {\n        var inspected = inspect();\n        if (inspected.state === \"rejected\") {\n            promise.exception = inspected.reason;\n        }\n\n        promise.valueOf = function () {\n            var inspected = inspect();\n            if (inspected.state === \"pending\" ||\n                inspected.state === \"rejected\") {\n                return promise;\n            }\n            return inspected.value;\n        };\n    }\n\n    return promise;\n}\n\nPromise.prototype.toString = function () {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.then = function (fulfilled, rejected, progressed) {\n    var self = this;\n    var deferred = defer();\n    var done = false;   // ensure the untrusted promise makes at most a\n                        // single call to one of the callbacks\n\n    function _fulfilled(value) {\n        try {\n            return typeof fulfilled === \"function\" ? fulfilled(value) : value;\n        } catch (exception) {\n            return reject(exception);\n        }\n    }\n\n    function _rejected(exception) {\n        if (typeof rejected === \"function\") {\n            makeStackTraceLong(exception, self);\n            try {\n                return rejected(exception);\n            } catch (newException) {\n                return reject(newException);\n            }\n        }\n        return reject(exception);\n    }\n\n    function _progressed(value) {\n        return typeof progressed === \"function\" ? progressed(value) : value;\n    }\n\n    Q.nextTick(function () {\n        self.promiseDispatch(function (value) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_fulfilled(value));\n        }, \"when\", [function (exception) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_rejected(exception));\n        }]);\n    });\n\n    // Progress propagator need to be attached in the current tick.\n    self.promiseDispatch(void 0, \"when\", [void 0, function (value) {\n        var newValue;\n        var threw = false;\n        try {\n            newValue = _progressed(value);\n        } catch (e) {\n            threw = true;\n            if (Q.onerror) {\n                Q.onerror(e);\n            } else {\n                throw e;\n            }\n        }\n\n        if (!threw) {\n            deferred.notify(newValue);\n        }\n    }]);\n\n    return deferred.promise;\n};\n\nQ.tap = function (promise, callback) {\n    return Q(promise).tap(callback);\n};\n\n/**\n * Works almost like \"finally\", but not called for rejections.\n * Original resolution value is passed through callback unaffected.\n * Callback may return a promise that will be awaited for.\n * @param {Function} callback\n * @returns {Q.Promise}\n * @example\n * doSomething()\n *   .then(...)\n *   .tap(console.log)\n *   .then(...);\n */\nPromise.prototype.tap = function (callback) {\n    callback = Q(callback);\n\n    return this.then(function (value) {\n        return callback.fcall(value).thenResolve(value);\n    });\n};\n\n/**\n * Registers an observer on a promise.\n *\n * Guarantees:\n *\n * 1. that fulfilled and rejected will be called only once.\n * 2. that either the fulfilled callback or the rejected callback will be\n *    called, but not both.\n * 3. that fulfilled and rejected will not be called in this turn.\n *\n * @param value      promise or immediate reference to observe\n * @param fulfilled  function to be called with the fulfilled value\n * @param rejected   function to be called with the rejection exception\n * @param progressed function to be called on any progress notifications\n * @return promise for the return value from the invoked callback\n */\nQ.when = when;\nfunction when(value, fulfilled, rejected, progressed) {\n    return Q(value).then(fulfilled, rejected, progressed);\n}\n\nPromise.prototype.thenResolve = function (value) {\n    return this.then(function () { return value; });\n};\n\nQ.thenResolve = function (promise, value) {\n    return Q(promise).thenResolve(value);\n};\n\nPromise.prototype.thenReject = function (reason) {\n    return this.then(function () { throw reason; });\n};\n\nQ.thenReject = function (promise, reason) {\n    return Q(promise).thenReject(reason);\n};\n\n/**\n * If an object is not a promise, it is as \"near\" as possible.\n * If a promise is rejected, it is as \"near\" as possible too.\n * If its a fulfilled promise, the fulfillment value is nearer.\n * If its a deferred promise and the deferred has been resolved, the\n * resolution is \"nearer\".\n * @param object\n * @returns most resolved (nearest) form of the object\n */\n\n// XXX should we re-do this?\nQ.nearer = nearer;\nfunction nearer(value) {\n    if (isPromise(value)) {\n        var inspected = value.inspect();\n        if (inspected.state === \"fulfilled\") {\n            return inspected.value;\n        }\n    }\n    return value;\n}\n\n/**\n * @returns whether the given object is a promise.\n * Otherwise it is a fulfilled value.\n */\nQ.isPromise = isPromise;\nfunction isPromise(object) {\n    return object instanceof Promise;\n}\n\nQ.isPromiseAlike = isPromiseAlike;\nfunction isPromiseAlike(object) {\n    return isObject(object) && typeof object.then === \"function\";\n}\n\n/**\n * @returns whether the given object is a pending promise, meaning not\n * fulfilled or rejected.\n */\nQ.isPending = isPending;\nfunction isPending(object) {\n    return isPromise(object) && object.inspect().state === \"pending\";\n}\n\nPromise.prototype.isPending = function () {\n    return this.inspect().state === \"pending\";\n};\n\n/**\n * @returns whether the given object is a value or fulfilled\n * promise.\n */\nQ.isFulfilled = isFulfilled;\nfunction isFulfilled(object) {\n    return !isPromise(object) || object.inspect().state === \"fulfilled\";\n}\n\nPromise.prototype.isFulfilled = function () {\n    return this.inspect().state === \"fulfilled\";\n};\n\n/**\n * @returns whether the given object is a rejected promise.\n */\nQ.isRejected = isRejected;\nfunction isRejected(object) {\n    return isPromise(object) && object.inspect().state === \"rejected\";\n}\n\nPromise.prototype.isRejected = function () {\n    return this.inspect().state === \"rejected\";\n};\n\n//// BEGIN UNHANDLED REJECTION TRACKING\n\n// This promise library consumes exceptions thrown in handlers so they can be\n// handled by a subsequent promise.  The exceptions get added to this array when\n// they are created, and removed when they are handled.  Note that in ES6 or\n// shimmed environments, this would naturally be a `Set`.\nvar unhandledReasons = [];\nvar unhandledRejections = [];\nvar reportedUnhandledRejections = [];\nvar trackUnhandledRejections = true;\n\nfunction resetUnhandledRejections() {\n    unhandledReasons.length = 0;\n    unhandledRejections.length = 0;\n\n    if (!trackUnhandledRejections) {\n        trackUnhandledRejections = true;\n    }\n}\n\nfunction trackRejection(promise, reason) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n    if (typeof process === \"object\" && typeof process.emit === \"function\") {\n        Q.nextTick.runAfter(function () {\n            if (array_indexOf(unhandledRejections, promise) !== -1) {\n                process.emit(\"unhandledRejection\", reason, promise);\n                reportedUnhandledRejections.push(promise);\n            }\n        });\n    }\n\n    unhandledRejections.push(promise);\n    if (reason && typeof reason.stack !== \"undefined\") {\n        unhandledReasons.push(reason.stack);\n    } else {\n        unhandledReasons.push(\"(no stack) \" + reason);\n    }\n}\n\nfunction untrackRejection(promise) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n\n    var at = array_indexOf(unhandledRejections, promise);\n    if (at !== -1) {\n        if (typeof process === \"object\" && typeof process.emit === \"function\") {\n            Q.nextTick.runAfter(function () {\n                var atReport = array_indexOf(reportedUnhandledRejections, promise);\n                if (atReport !== -1) {\n                    process.emit(\"rejectionHandled\", unhandledReasons[at], promise);\n                    reportedUnhandledRejections.splice(atReport, 1);\n                }\n            });\n        }\n        unhandledRejections.splice(at, 1);\n        unhandledReasons.splice(at, 1);\n    }\n}\n\nQ.resetUnhandledRejections = resetUnhandledRejections;\n\nQ.getUnhandledReasons = function () {\n    // Make a copy so that consumers can't interfere with our internal state.\n    return unhandledReasons.slice();\n};\n\nQ.stopUnhandledRejectionTracking = function () {\n    resetUnhandledRejections();\n    trackUnhandledRejections = false;\n};\n\nresetUnhandledRejections();\n\n//// END UNHANDLED REJECTION TRACKING\n\n/**\n * Constructs a rejected promise.\n * @param reason value describing the failure\n */\nQ.reject = reject;\nfunction reject(reason) {\n    var rejection = Promise({\n        \"when\": function (rejected) {\n            // note that the error has been handled\n            if (rejected) {\n                untrackRejection(this);\n            }\n            return rejected ? rejected(reason) : this;\n        }\n    }, function fallback() {\n        return this;\n    }, function inspect() {\n        return { state: \"rejected\", reason: reason };\n    });\n\n    // Note that the reason has not been handled.\n    trackRejection(rejection, reason);\n\n    return rejection;\n}\n\n/**\n * Constructs a fulfilled promise for an immediate reference.\n * @param value immediate reference\n */\nQ.fulfill = fulfill;\nfunction fulfill(value) {\n    return Promise({\n        \"when\": function () {\n            return value;\n        },\n        \"get\": function (name) {\n            return value[name];\n        },\n        \"set\": function (name, rhs) {\n            value[name] = rhs;\n        },\n        \"delete\": function (name) {\n            delete value[name];\n        },\n        \"post\": function (name, args) {\n            // Mark Miller proposes that post with no name should apply a\n            // promised function.\n            if (name === null || name === void 0) {\n                return value.apply(void 0, args);\n            } else {\n                return value[name].apply(value, args);\n            }\n        },\n        \"apply\": function (thisp, args) {\n            return value.apply(thisp, args);\n        },\n        \"keys\": function () {\n            return object_keys(value);\n        }\n    }, void 0, function inspect() {\n        return { state: \"fulfilled\", value: value };\n    });\n}\n\n/**\n * Converts thenables to Q promises.\n * @param promise thenable promise\n * @returns a Q promise\n */\nfunction coerce(promise) {\n    var deferred = defer();\n    Q.nextTick(function () {\n        try {\n            promise.then(deferred.resolve, deferred.reject, deferred.notify);\n        } catch (exception) {\n            deferred.reject(exception);\n        }\n    });\n    return deferred.promise;\n}\n\n/**\n * Annotates an object such that it will never be\n * transferred away from this process over any promise\n * communication channel.\n * @param object\n * @returns promise a wrapping of that object that\n * additionally responds to the \"isDef\" message\n * without a rejection.\n */\nQ.master = master;\nfunction master(object) {\n    return Promise({\n        \"isDef\": function () {}\n    }, function fallback(op, args) {\n        return dispatch(object, op, args);\n    }, function () {\n        return Q(object).inspect();\n    });\n}\n\n/**\n * Spreads the values of a promised array of arguments into the\n * fulfillment callback.\n * @param fulfilled callback that receives variadic arguments from the\n * promised array\n * @param rejected callback that receives the exception if the promise\n * is rejected.\n * @returns a promise for the return value or thrown exception of\n * either callback.\n */\nQ.spread = spread;\nfunction spread(value, fulfilled, rejected) {\n    return Q(value).spread(fulfilled, rejected);\n}\n\nPromise.prototype.spread = function (fulfilled, rejected) {\n    return this.all().then(function (array) {\n        return fulfilled.apply(void 0, array);\n    }, rejected);\n};\n\n/**\n * The async function is a decorator for generator functions, turning\n * them into asynchronous generators.  Although generators are only part\n * of the newest ECMAScript 6 drafts, this code does not cause syntax\n * errors in older engines.  This code should continue to work and will\n * in fact improve over time as the language improves.\n *\n * ES6 generators are currently part of V8 version 3.19 with the\n * --harmony-generators runtime flag enabled.  SpiderMonkey has had them\n * for longer, but under an older Python-inspired form.  This function\n * works on both kinds of generators.\n *\n * Decorates a generator function such that:\n *  - it may yield promises\n *  - execution will continue when that promise is fulfilled\n *  - the value of the yield expression will be the fulfilled value\n *  - it returns a promise for the return value (when the generator\n *    stops iterating)\n *  - the decorated function returns a promise for the return value\n *    of the generator or the first rejected promise among those\n *    yielded.\n *  - if an error is thrown in the generator, it propagates through\n *    every following yield until it is caught, or until it escapes\n *    the generator function altogether, and is translated into a\n *    rejection for the promise returned by the decorated generator.\n */\nQ.async = async;\nfunction async(makeGenerator) {\n    return function () {\n        // when verb is \"send\", arg is a value\n        // when verb is \"throw\", arg is an exception\n        function continuer(verb, arg) {\n            var result;\n\n            // Until V8 3.19 / Chromium 29 is released, SpiderMonkey is the only\n            // engine that has a deployed base of browsers that support generators.\n            // However, SM's generators use the Python-inspired semantics of\n            // outdated ES6 drafts.  We would like to support ES6, but we'd also\n            // like to make it possible to use generators in deployed browsers, so\n            // we also support Python-style generators.  At some point we can remove\n            // this block.\n\n            if (typeof StopIteration === \"undefined\") {\n                // ES6 Generators\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    return reject(exception);\n                }\n                if (result.done) {\n                    return Q(result.value);\n                } else {\n                    return when(result.value, callback, errback);\n                }\n            } else {\n                // SpiderMonkey Generators\n                // FIXME: Remove this case when SM does ES6 generators.\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    if (isStopIteration(exception)) {\n                        return Q(exception.value);\n                    } else {\n                        return reject(exception);\n                    }\n                }\n                return when(result, callback, errback);\n            }\n        }\n        var generator = makeGenerator.apply(this, arguments);\n        var callback = continuer.bind(continuer, \"next\");\n        var errback = continuer.bind(continuer, \"throw\");\n        return callback();\n    };\n}\n\n/**\n * The spawn function is a small wrapper around async that immediately\n * calls the generator and also ends the promise chain, so that any\n * unhandled errors are thrown instead of forwarded to the error\n * handler. This is useful because it's extremely common to run\n * generators at the top-level to work with libraries.\n */\nQ.spawn = spawn;\nfunction spawn(makeGenerator) {\n    Q.done(Q.async(makeGenerator)());\n}\n\n// FIXME: Remove this interface once ES6 generators are in SpiderMonkey.\n/**\n * Throws a ReturnValue exception to stop an asynchronous generator.\n *\n * This interface is a stop-gap measure to support generator return\n * values in older Firefox/SpiderMonkey.  In browsers that support ES6\n * generators like Chromium 29, just use \"return\" in your generator\n * functions.\n *\n * @param value the return value for the surrounding generator\n * @throws ReturnValue exception with the value.\n * @example\n * // ES6 style\n * Q.async(function* () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      return foo + bar;\n * })\n * // Older SpiderMonkey style\n * Q.async(function () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      Q.return(foo + bar);\n * })\n */\nQ[\"return\"] = _return;\nfunction _return(value) {\n    throw new QReturnValue(value);\n}\n\n/**\n * The promised function decorator ensures that any promise arguments\n * are settled and passed as values (`this` is also settled and passed\n * as a value).  It will also ensure that the result of a function is\n * always a promise.\n *\n * @example\n * var add = Q.promised(function (a, b) {\n *     return a + b;\n * });\n * add(Q(a), Q(B));\n *\n * @param {function} callback The function to decorate\n * @returns {function} a function that has been decorated.\n */\nQ.promised = promised;\nfunction promised(callback) {\n    return function () {\n        return spread([this, all(arguments)], function (self, args) {\n            return callback.apply(self, args);\n        });\n    };\n}\n\n/**\n * sends a message to a value in a future turn\n * @param object* the recipient\n * @param op the name of the message operation, e.g., \"when\",\n * @param args further arguments to be forwarded to the operation\n * @returns result {Promise} a promise for the result of the operation\n */\nQ.dispatch = dispatch;\nfunction dispatch(object, op, args) {\n    return Q(object).dispatch(op, args);\n}\n\nPromise.prototype.dispatch = function (op, args) {\n    var self = this;\n    var deferred = defer();\n    Q.nextTick(function () {\n        self.promiseDispatch(deferred.resolve, op, args);\n    });\n    return deferred.promise;\n};\n\n/**\n * Gets the value of a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to get\n * @return promise for the property value\n */\nQ.get = function (object, key) {\n    return Q(object).dispatch(\"get\", [key]);\n};\n\nPromise.prototype.get = function (key) {\n    return this.dispatch(\"get\", [key]);\n};\n\n/**\n * Sets the value of a property in a future turn.\n * @param object    promise or immediate reference for object object\n * @param name      name of property to set\n * @param value     new value of property\n * @return promise for the return value\n */\nQ.set = function (object, key, value) {\n    return Q(object).dispatch(\"set\", [key, value]);\n};\n\nPromise.prototype.set = function (key, value) {\n    return this.dispatch(\"set\", [key, value]);\n};\n\n/**\n * Deletes a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to delete\n * @return promise for the return value\n */\nQ.del = // XXX legacy\nQ[\"delete\"] = function (object, key) {\n    return Q(object).dispatch(\"delete\", [key]);\n};\n\nPromise.prototype.del = // XXX legacy\nPromise.prototype[\"delete\"] = function (key) {\n    return this.dispatch(\"delete\", [key]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param value     a value to post, typically an array of\n *                  invocation arguments for promises that\n *                  are ultimately backed with `resolve` values,\n *                  as opposed to those backed with URLs\n *                  wherein the posted value can be any\n *                  JSON serializable object.\n * @return promise for the return value\n */\n// bound locally because it is used by other methods\nQ.mapply = // XXX As proposed by \"Redsandro\"\nQ.post = function (object, name, args) {\n    return Q(object).dispatch(\"post\", [name, args]);\n};\n\nPromise.prototype.mapply = // XXX As proposed by \"Redsandro\"\nPromise.prototype.post = function (name, args) {\n    return this.dispatch(\"post\", [name, args]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param ...args   array of invocation arguments\n * @return promise for the return value\n */\nQ.send = // XXX Mark Miller's proposed parlance\nQ.mcall = // XXX As proposed by \"Redsandro\"\nQ.invoke = function (object, name /*...args*/) {\n    return Q(object).dispatch(\"post\", [name, array_slice(arguments, 2)]);\n};\n\nPromise.prototype.send = // XXX Mark Miller's proposed parlance\nPromise.prototype.mcall = // XXX As proposed by \"Redsandro\"\nPromise.prototype.invoke = function (name /*...args*/) {\n    return this.dispatch(\"post\", [name, array_slice(arguments, 1)]);\n};\n\n/**\n * Applies the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param args      array of application arguments\n */\nQ.fapply = function (object, args) {\n    return Q(object).dispatch(\"apply\", [void 0, args]);\n};\n\nPromise.prototype.fapply = function (args) {\n    return this.dispatch(\"apply\", [void 0, args]);\n};\n\n/**\n * Calls the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ[\"try\"] =\nQ.fcall = function (object /* ...args*/) {\n    return Q(object).dispatch(\"apply\", [void 0, array_slice(arguments, 1)]);\n};\n\nPromise.prototype.fcall = function (/*...args*/) {\n    return this.dispatch(\"apply\", [void 0, array_slice(arguments)]);\n};\n\n/**\n * Binds the promised function, transforming return values into a fulfilled\n * promise and thrown errors into a rejected one.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ.fbind = function (object /*...args*/) {\n    var promise = Q(object);\n    var args = array_slice(arguments, 1);\n    return function fbound() {\n        return promise.dispatch(\"apply\", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\nPromise.prototype.fbind = function (/*...args*/) {\n    var promise = this;\n    var args = array_slice(arguments);\n    return function fbound() {\n        return promise.dispatch(\"apply\", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\n\n/**\n * Requests the names of the owned properties of a promised\n * object in a future turn.\n * @param object    promise or immediate reference for target object\n * @return promise for the keys of the eventually settled object\n */\nQ.keys = function (object) {\n    return Q(object).dispatch(\"keys\", []);\n};\n\nPromise.prototype.keys = function () {\n    return this.dispatch(\"keys\", []);\n};\n\n/**\n * Turns an array of promises into a promise for an array.  If any of\n * the promises gets rejected, the whole array is rejected immediately.\n * @param {Array*} an array (or promise for an array) of values (or\n * promises for values)\n * @returns a promise for an array of the corresponding values\n */\n// By Mark Miller\n// http://wiki.ecmascript.org/doku.php?id=strawman:concurrency&rev=1308776521#allfulfilled\nQ.all = all;\nfunction all(promises) {\n    return when(promises, function (promises) {\n        var pendingCount = 0;\n        var deferred = defer();\n        array_reduce(promises, function (undefined, promise, index) {\n            var snapshot;\n            if (\n                isPromise(promise) &&\n                (snapshot = promise.inspect()).state === \"fulfilled\"\n            ) {\n                promises[index] = snapshot.value;\n            } else {\n                ++pendingCount;\n                when(\n                    promise,\n                    function (value) {\n                        promises[index] = value;\n                        if (--pendingCount === 0) {\n                            deferred.resolve(promises);\n                        }\n                    },\n                    deferred.reject,\n                    function (progress) {\n                        deferred.notify({ index: index, value: progress });\n                    }\n                );\n            }\n        }, void 0);\n        if (pendingCount === 0) {\n            deferred.resolve(promises);\n        }\n        return deferred.promise;\n    });\n}\n\nPromise.prototype.all = function () {\n    return all(this);\n};\n\n/**\n * Returns the first resolved promise of an array. Prior rejected promises are\n * ignored.  Rejects only if all promises are rejected.\n * @param {Array*} an array containing values or promises for values\n * @returns a promise fulfilled with the value of the first resolved promise,\n * or a rejected promise if all promises are rejected.\n */\nQ.any = any;\n\nfunction any(promises) {\n    if (promises.length === 0) {\n        return Q.resolve();\n    }\n\n    var deferred = Q.defer();\n    var pendingCount = 0;\n    array_reduce(promises, function (prev, current, index) {\n        var promise = promises[index];\n\n        pendingCount++;\n\n        when(promise, onFulfilled, onRejected, onProgress);\n        function onFulfilled(result) {\n            deferred.resolve(result);\n        }\n        function onRejected(err) {\n            pendingCount--;\n            if (pendingCount === 0) {\n                err.message = (\"Q can't get fulfillment value from any promise, all \" +\n                    \"promises were rejected. Last error message: \" + err.message);\n                deferred.reject(err);\n            }\n        }\n        function onProgress(progress) {\n            deferred.notify({\n                index: index,\n                value: progress\n            });\n        }\n    }, undefined);\n\n    return deferred.promise;\n}\n\nPromise.prototype.any = function () {\n    return any(this);\n};\n\n/**\n * Waits for all promises to be settled, either fulfilled or\n * rejected.  This is distinct from `all` since that would stop\n * waiting at the first rejection.  The promise returned by\n * `allResolved` will never be rejected.\n * @param promises a promise for an array (or an array) of promises\n * (or values)\n * @return a promise for an array of promises\n */\nQ.allResolved = deprecate(allResolved, \"allResolved\", \"allSettled\");\nfunction allResolved(promises) {\n    return when(promises, function (promises) {\n        promises = array_map(promises, Q);\n        return when(all(array_map(promises, function (promise) {\n            return when(promise, noop, noop);\n        })), function () {\n            return promises;\n        });\n    });\n}\n\nPromise.prototype.allResolved = function () {\n    return allResolved(this);\n};\n\n/**\n * @see Promise#allSettled\n */\nQ.allSettled = allSettled;\nfunction allSettled(promises) {\n    return Q(promises).allSettled();\n}\n\n/**\n * Turns an array of promises into a promise for an array of their states (as\n * returned by `inspect`) when they have all settled.\n * @param {Array[Any*]} values an array (or promise for an array) of values (or\n * promises for values)\n * @returns {Array[State]} an array of states for the respective values.\n */\nPromise.prototype.allSettled = function () {\n    return this.then(function (promises) {\n        return all(array_map(promises, function (promise) {\n            promise = Q(promise);\n            function regardless() {\n                return promise.inspect();\n            }\n            return promise.then(regardless, regardless);\n        }));\n    });\n};\n\n/**\n * Captures the failure of a promise, giving an oportunity to recover\n * with a callback.  If the given promise is fulfilled, the returned\n * promise is fulfilled.\n * @param {Any*} promise for something\n * @param {Function} callback to fulfill the returned promise if the\n * given promise is rejected\n * @returns a promise for the return value of the callback\n */\nQ.fail = // XXX legacy\nQ[\"catch\"] = function (object, rejected) {\n    return Q(object).then(void 0, rejected);\n};\n\nPromise.prototype.fail = // XXX legacy\nPromise.prototype[\"catch\"] = function (rejected) {\n    return this.then(void 0, rejected);\n};\n\n/**\n * Attaches a listener that can respond to progress notifications from a\n * promise's originating deferred. This listener receives the exact arguments\n * passed to ``deferred.notify``.\n * @param {Any*} promise for something\n * @param {Function} callback to receive any progress notifications\n * @returns the given promise, unchanged\n */\nQ.progress = progress;\nfunction progress(object, progressed) {\n    return Q(object).then(void 0, void 0, progressed);\n}\n\nPromise.prototype.progress = function (progressed) {\n    return this.then(void 0, void 0, progressed);\n};\n\n/**\n * Provides an opportunity to observe the settling of a promise,\n * regardless of whether the promise is fulfilled or rejected.  Forwards\n * the resolution to the returned promise when the callback is done.\n * The callback can return a promise to defer completion.\n * @param {Any*} promise\n * @param {Function} callback to observe the resolution of the given\n * promise, takes no arguments.\n * @returns a promise for the resolution of the given promise when\n * ``fin`` is done.\n */\nQ.fin = // XXX legacy\nQ[\"finally\"] = function (object, callback) {\n    return Q(object)[\"finally\"](callback);\n};\n\nPromise.prototype.fin = // XXX legacy\nPromise.prototype[\"finally\"] = function (callback) {\n    if (!callback || typeof callback.apply !== \"function\") {\n        throw new Error(\"Q can't apply finally callback\");\n    }\n    callback = Q(callback);\n    return this.then(function (value) {\n        return callback.fcall().then(function () {\n            return value;\n        });\n    }, function (reason) {\n        // TODO attempt to recycle the rejection with \"this\".\n        return callback.fcall().then(function () {\n            throw reason;\n        });\n    });\n};\n\n/**\n * Terminates a chain of promises, forcing rejections to be\n * thrown as exceptions.\n * @param {Any*} promise at the end of a chain of promises\n * @returns nothing\n */\nQ.done = function (object, fulfilled, rejected, progress) {\n    return Q(object).done(fulfilled, rejected, progress);\n};\n\nPromise.prototype.done = function (fulfilled, rejected, progress) {\n    var onUnhandledError = function (error) {\n        // forward to a future turn so that ``when``\n        // does not catch it and turn it into a rejection.\n        Q.nextTick(function () {\n            makeStackTraceLong(error, promise);\n            if (Q.onerror) {\n                Q.onerror(error);\n            } else {\n                throw error;\n            }\n        });\n    };\n\n    // Avoid unnecessary `nextTick`ing via an unnecessary `when`.\n    var promise = fulfilled || rejected || progress ?\n        this.then(fulfilled, rejected, progress) :\n        this;\n\n    if (typeof process === \"object\" && process && process.domain) {\n        onUnhandledError = process.domain.bind(onUnhandledError);\n    }\n\n    promise.then(void 0, onUnhandledError);\n};\n\n/**\n * Causes a promise to be rejected if it does not get fulfilled before\n * some milliseconds time out.\n * @param {Any*} promise\n * @param {Number} milliseconds timeout\n * @param {Any*} custom error message or Error object (optional)\n * @returns a promise for the resolution of the given promise if it is\n * fulfilled before the timeout, otherwise rejected.\n */\nQ.timeout = function (object, ms, error) {\n    return Q(object).timeout(ms, error);\n};\n\nPromise.prototype.timeout = function (ms, error) {\n    var deferred = defer();\n    var timeoutId = setTimeout(function () {\n        if (!error || \"string\" === typeof error) {\n            error = new Error(error || \"Timed out after \" + ms + \" ms\");\n            error.code = \"ETIMEDOUT\";\n        }\n        deferred.reject(error);\n    }, ms);\n\n    this.then(function (value) {\n        clearTimeout(timeoutId);\n        deferred.resolve(value);\n    }, function (exception) {\n        clearTimeout(timeoutId);\n        deferred.reject(exception);\n    }, deferred.notify);\n\n    return deferred.promise;\n};\n\n/**\n * Returns a promise for the given value (or promised value), some\n * milliseconds after it resolved. Passes rejections immediately.\n * @param {Any*} promise\n * @param {Number} milliseconds\n * @returns a promise for the resolution of the given promise after milliseconds\n * time has elapsed since the resolution of the given promise.\n * If the given promise rejects, that is passed immediately.\n */\nQ.delay = function (object, timeout) {\n    if (timeout === void 0) {\n        timeout = object;\n        object = void 0;\n    }\n    return Q(object).delay(timeout);\n};\n\nPromise.prototype.delay = function (timeout) {\n    return this.then(function (value) {\n        var deferred = defer();\n        setTimeout(function () {\n            deferred.resolve(value);\n        }, timeout);\n        return deferred.promise;\n    });\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided as an array, and returns a promise.\n *\n *      Q.nfapply(FS.readFile, [__filename])\n *      .then(function (content) {\n *      })\n *\n */\nQ.nfapply = function (callback, args) {\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfapply = function (args) {\n    var deferred = defer();\n    var nodeArgs = array_slice(args);\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided individually, and returns a promise.\n * @example\n * Q.nfcall(FS.readFile, __filename)\n * .then(function (content) {\n * })\n *\n */\nQ.nfcall = function (callback /*...args*/) {\n    var args = array_slice(arguments, 1);\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfcall = function (/*...args*/) {\n    var nodeArgs = array_slice(arguments);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Wraps a NodeJS continuation passing function and returns an equivalent\n * version that returns a promise.\n * @example\n * Q.nfbind(FS.readFile, __filename)(\"utf-8\")\n * .then(console.log)\n * .done()\n */\nQ.nfbind =\nQ.denodeify = function (callback /*...args*/) {\n    if (callback === undefined) {\n        throw new Error(\"Q can't wrap an undefined function\");\n    }\n    var baseArgs = array_slice(arguments, 1);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        Q(callback).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nfbind =\nPromise.prototype.denodeify = function (/*...args*/) {\n    var args = array_slice(arguments);\n    args.unshift(this);\n    return Q.denodeify.apply(void 0, args);\n};\n\nQ.nbind = function (callback, thisp /*...args*/) {\n    var baseArgs = array_slice(arguments, 2);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        function bound() {\n            return callback.apply(thisp, arguments);\n        }\n        Q(bound).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nbind = function (/*thisp, ...args*/) {\n    var args = array_slice(arguments, 0);\n    args.unshift(this);\n    return Q.nbind.apply(void 0, args);\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback with a given array of arguments, plus a provided callback.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param {Array} args arguments to pass to the method; the callback\n * will be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nmapply = // XXX As proposed by \"Redsandro\"\nQ.npost = function (object, name, args) {\n    return Q(object).npost(name, args);\n};\n\nPromise.prototype.nmapply = // XXX As proposed by \"Redsandro\"\nPromise.prototype.npost = function (name, args) {\n    var nodeArgs = array_slice(args || []);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback, forwarding the given variadic arguments, plus a provided\n * callback argument.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param ...args arguments to pass to the method; the callback will\n * be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nsend = // XXX Based on Mark Miller's proposed \"send\"\nQ.nmcall = // XXX Based on \"Redsandro's\" proposal\nQ.ninvoke = function (object, name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 2);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    Q(object).dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\nPromise.prototype.nsend = // XXX Based on Mark Miller's proposed \"send\"\nPromise.prototype.nmcall = // XXX Based on \"Redsandro's\" proposal\nPromise.prototype.ninvoke = function (name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 1);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * If a function would like to support both Node continuation-passing-style and\n * promise-returning-style, it can end its internal promise chain with\n * `nodeify(nodeback)`, forwarding the optional nodeback argument.  If the user\n * elects to use a nodeback, the result will be sent there.  If they do not\n * pass a nodeback, they will receive the result promise.\n * @param object a result (or a promise for a result)\n * @param {Function} nodeback a Node.js-style callback\n * @returns either the promise or nothing\n */\nQ.nodeify = nodeify;\nfunction nodeify(object, nodeback) {\n    return Q(object).nodeify(nodeback);\n}\n\nPromise.prototype.nodeify = function (nodeback) {\n    if (nodeback) {\n        this.then(function (value) {\n            Q.nextTick(function () {\n                nodeback(null, value);\n            });\n        }, function (error) {\n            Q.nextTick(function () {\n                nodeback(error);\n            });\n        });\n    } else {\n        return this;\n    }\n};\n\nQ.noConflict = function() {\n    throw new Error(\"Q.noConflict only works when Q is used as a global\");\n};\n\n// All code before this point will be filtered from stack traces.\nvar qEndingLine = captureLine();\n\nreturn Q;\n\n});\n\n}).call(this,require('_process'))\n},{\"_process\":20}],22:[function(require,module,exports){\nvar _global = (function() { return this; })();\nvar NativeWebSocket = _global.WebSocket || _global.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new NativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new NativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\n\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : NativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n\n},{\"./version\":23}],23:[function(require,module,exports){\nmodule.exports = require('../package.json').version;\n\n},{\"../package.json\":24}],24:[function(require,module,exports){\nmodule.exports={\n  \"_args\": [\n    [\n      \"websocket@1.0.24\",\n      \"/opt/ashamed\"\n    ]\n  ],\n  \"_from\": \"websocket@1.0.24\",\n  \"_id\": \"websocket@1.0.24\",\n  \"_inBundle\": false,\n  \"_integrity\": \"sha1-dJA+dfJUW2suHeFCW8HJBZF6GJA=\",\n  \"_location\": \"/websocket\",\n  \"_phantomChildren\": {},\n  \"_requested\": {\n    \"type\": \"version\",\n    \"registry\": true,\n    \"raw\": \"websocket@1.0.24\",\n    \"name\": \"websocket\",\n    \"escapedName\": \"websocket\",\n    \"rawSpec\": \"1.0.24\",\n    \"saveSpec\": null,\n    \"fetchSpec\": \"1.0.24\"\n  },\n  \"_requiredBy\": [\n    \"/\"\n  ],\n  \"_resolved\": \"https://registry.npmjs.org/websocket/-/websocket-1.0.24.tgz\",\n  \"_spec\": \"1.0.24\",\n  \"_where\": \"/opt/ashamed\",\n  \"author\": {\n    \"name\": \"Brian McKelvey\",\n    \"email\": \"brian@worlize.com\",\n    \"url\": \"https://www.worlize.com/\"\n  },\n  \"browser\": \"lib/browser.js\",\n  \"bugs\": {\n    \"url\": \"https://github.com/theturtle32/WebSocket-Node/issues\"\n  },\n  \"config\": {\n    \"verbose\": false\n  },\n  \"contributors\": [\n    {\n      \"name\": \"Iaki Baz Castillo\",\n      \"email\": \"ibc@aliax.net\",\n      \"url\": \"http://dev.sipdoc.net\"\n    }\n  ],\n  \"dependencies\": {\n    \"debug\": \"^2.2.0\",\n    \"nan\": \"^2.3.3\",\n    \"typedarray-to-buffer\": \"^3.1.2\",\n    \"yaeti\": \"^0.0.6\"\n  },\n  \"description\": \"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.\",\n  \"devDependencies\": {\n    \"buffer-equal\": \"^1.0.0\",\n    \"faucet\": \"^0.0.1\",\n    \"gulp\": \"git+https://github.com/gulpjs/gulp.git#4.0\",\n    \"gulp-jshint\": \"^2.0.4\",\n    \"jshint\": \"^2.0.0\",\n    \"jshint-stylish\": \"^2.2.1\",\n    \"tape\": \"^4.0.1\"\n  },\n  \"directories\": {\n    \"lib\": \"./lib\"\n  },\n  \"engines\": {\n    \"node\": \">=0.8.0\"\n  },\n  \"homepage\": \"https://github.com/theturtle32/WebSocket-Node\",\n  \"keywords\": [\n    \"websocket\",\n    \"websockets\",\n    \"socket\",\n    \"networking\",\n    \"comet\",\n    \"push\",\n    \"RFC-6455\",\n    \"realtime\",\n    \"server\",\n    \"client\"\n  ],\n  \"license\": \"Apache-2.0\",\n  \"main\": \"index\",\n  \"name\": \"websocket\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/theturtle32/WebSocket-Node.git\"\n  },\n  \"scripts\": {\n    \"gulp\": \"gulp\",\n    \"install\": \"(node-gyp rebuild 2> builderror.log) || (exit 0)\",\n    \"test\": \"faucet test/unit\"\n  },\n  \"version\": \"1.0.24\"\n}\n\n},{}]},{},[1]);\n"]}
=======
{"version":3,"sources":["angular-ashamed.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","module","window","AshamedClient","shm","angular","provider","self","host","base","realtime","$get","service","config","$q","$rootScope","$timeout","client","on","$apply","resolve","data","q","defer","promise","get","path","options","then","set","item","diff","changes","update","Path","extend","EventEmitter","applyChanges","applyDiff","strToPath","pathToStr","getPath","WebSocketClient","WebSocket","w3cwebsocket","store","backup","pending","vfn","CHANNEL","DEF_OPTS","handleMessage","msg","JSON","parse","channel","type","modelUpdate","modelResponse","args","patch","cid","err","cb","_options","_host","_base","_realtime","_url","ws","http","_err","connect","callback","Math","random","_ready","send","stringify","def","onerror","emit","reject","onopen","onmessage","onclose","_send","op","undefined","old","jiff","Array","isArray","replace","split","filter","res","join","startsWith","concat","b","create","src","val","root","folder","shift","Object","keys","target","source","d","forEach","p","np","pop","patchInPlace","applyChange","change","_events","_maxListeners","prototype","defaultMaxListeners","setMaxListeners","isNumber","isNaN","TypeError","er","handler","len","listeners","error","isObject","arguments","context","isUndefined","isFunction","slice","apply","addListener","listener","m","newListener","push","warned","console","trace","once","fired","g","removeListener","list","position","splice","removeAllListeners","key","ret","listenerCount","evlistener","emitter","arg","hasOwn","hasOwnProperty","toStr","toString","arr","isPlainObject","obj","hasOwnConstructor","hasIsPrototypeOf","constructor","name","copy","copyIsArray","clone","deep","lcs","array","inverse","jsonPointer","encodeSegment","applyInPlace","InvalidPatchOperationError","TestFailedError","PatchNotInvertibleError","isValidObject","defaultHash","appendChanges","initState","hash","orElse","makeContext","defaultContext","invertible","state","appendArrayChanges","appendObjectChanges","appendValueChanges","o1","o2","keyPath","value","a1","a2","a1hash","map","a2hash","lcsMatrix","compare","lcsToJsonPatch","offset","reduce","j","last","REMOVE","ADD","predicate","x","y","message","captureStackTrace","cons","tail","cloneArray","cloneObject","k","commutePaths","left","right","prefix","getCommonPathPrefix","isArrayPath","ac","copyPatch","bc","commuteArrayPaths","commuteTreePaths","commuteArraySiblings","commuteArrayAncestor","absolute","index","isValidArrayIndex","lpath","rpath","lindex","rindex","commuted","max","direction","rc","p1","p2","p1l","p2l","min","from","deepEquals","compareArrays","compareObjects","akeys","bkeys","patches","pr","skip","invertOp","c","defaultOptions","_parse","find","contains","decodeSegment","parseArrayIndex","separator","separatorRx","encodedSeparator","encodedSeparatorRx","escapeChar","escapeRx","encodedEscape","encodedEscapeRx","findContext","parent","hasContext","segment","findIndex","segments","bind","indexOf","arrayIndexRx","test","SyntaxError","start","jsonPointerParse","parseRx","onSegment","pos","accum","matches","match","charAt","lastIndex","exec","RIGHT","DOWN","SKIP","EQUAL","cols","rows","findPrefix","suffix","findSuffix","remove","matrix","createMatrix","backtrack","al","bl","lastrow","applyTest","invertTest","commute","commuteTest","add","applyAdd","invertAdd","commuteAddOrCopy","applyRemove","invertRemove","commuteRemove","applyReplace","invertReplace","commuteReplace","move","applyMove","invertMove","commuteMove","applyCopy","notInvertible","pointer","notFound","_add","before","after","missingValue","prev","_remove","removed","pto","pfrom","fromContext","_","process","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","setTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","run","nextTick","Item","title","browser","env","argv","version","versions","noop","off","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","definition","bootstrap","define","amd","ses","ok","makeQ","global","previousQ","Q","noConflict","hasStacks","stack","qStartingLine","captureLine","qFileName","head","task","next","flushing","requestTick","isNodeJS","laterQueue","flush","domain","enter","runSingle","exit","setImmediate","MessageChannel","port1","requestPortTick","port2","postMessage","runAfter","Function","uncurryThis","array_slice","array_reduce","basis","array_indexOf","array_map","thisp","collect","object_create","Type","object_defineProperty","defineProperty","prop","descriptor","object_hasOwnProperty","object_keys","object","object_toString","isStopIteration","exception","QReturnValue","ReturnValue","STACK_JUMP_SEPARATOR","makeStackTraceLong","stacks","__minimumStackCounter__","stackCounter","configurable","unshift","concatedStacks","filterStackString","stackString","lines","desiredLines","line","isInternalFrame","isNodeFrame","stackLine","getFileNameAndLineNumber","attempt1","Number","attempt2","attempt3","fileNameAndLineNumber","fileName","lineNumber","qEndingLine","firstLine","deprecate","alternative","warn","Promise","isPromiseAlike","coerce","fulfill","longStackSupport","longStackCounter","Q_DEBUG","messages","progressListeners","resolvedPromise","deferred","promiseDispatch","operands","valueOf","nearerValue","nearer","isPromise","inspect","substring","become","newPromise","reason","notify","progress","progressListener","makeNodeResolver","resolver","race","all","passByCopy","that","spread","answerPs","makePromise","fallback","result","inspected","fulfilled","rejected","progressed","done","_fulfilled","_rejected","newException","_progressed","newValue","threw","tap","fcall","thenResolve","when","thenReject","isPending","isFulfilled","isRejected","unhandledReasons","unhandledRejections","reportedUnhandledRejections","trackUnhandledRejections","resetUnhandledRejections","trackRejection","untrackRejection","at","atReport","getUnhandledReasons","stopUnhandledRejectionTracking","rejection","rhs","master","dispatch","async","makeGenerator","continuer","verb","StopIteration","generator","errback","spawn","_return","promised","del","mapply","post","mcall","invoke","fapply","fbind","fbound","promises","pendingCount","snapshot","any","current","onFulfilled","onRejected","onProgress","allResolved","allSettled","regardless","fail","fin","onUnhandledError","ms","timeoutId","delay","nfapply","nodeArgs","nfcall","nfbind","denodeify","baseArgs","nbind","bound","nmapply","npost","nsend","nmcall","ninvoke","nodeify","nodeback","_global","NativeWebSocket","MozWebSocket","websocket_version","W3CWebSocket","uri","protocols","native_instance"],"mappings":"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","file":"angular-ashamed.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function(window){\n\t\"use strict\";\n\n\tconst AshamedClient = require(\"../lib/client.js\");\n\tconst shm = angular.module(\"ashamed\",[]);\n\n\tshm.provider(\"ashamedConfig\",function(){\n\t\tvar self = this;\n\t\tthis.host = \"localhost:3000\";\n\t\tthis.base = \"\";\n\t\tthis.realtime = true;\n\n\t\tthis.$get = function() {\n\t\t\treturn {\n\t\t\t\thost : self.host,\n\t\t\t\tbase : self.base,\n\t\t\t\trealtime : self.realtime\n\t\t\t};\n\t\t}\n\t});\n\n\tshm.service(\"ashamedService\",[\"ashamedConfig\",\"$q\",\"$rootScope\",\"$timeout\",\n\tfunction(config,$q,$rootScope,$timeout){\n\t\tconst client = new AshamedClient(config);\n\n\t\tclient.on(\"message\",()=>{\n\t\t\t$rootScope.$apply();\n\t\t});\n\n\t\tfunction resolve(data) {\n\t\t\tvar q = $q.defer();\n\t\t\t$timeout(()=>{\n\t\t\t\t$rootScope.$apply();\n\t\t\t},10);\n\t\t\tq.resolve(data);\n\t\t\treturn q.promise;\n\t\t}\n\n\t\tthis.get = function(path,options) {\n\t\t\treturn client.get(path,options).then(resolve);\n\t\t}\n\n\t\tthis.set = function(path,item,options) {\n\t\t\treturn client.set(path,item,options).then(resolve);\n\t\t}\n\n\t\tthis.diff = function(path,changes) {\n\t\t\treturn client.diff(path,changes).then(resolve);\n\t\t}\n\n\t\tthis.update = function(path,item) {\n\t\t\treturn client.update(path,item).then(resolve);\n\t\t}\n}]);\n\n})(window);\n\n},{\"../lib/client.js\":2}],2:[function(require,module,exports){\nconst\n\tq = require(\"q\"),\n\tPath = require(\"./path.js\"),\n\textend = require(\"extend\"),\n\tEventEmitter = require('events'),\n\tdiff = Path.diff,\n\tapplyChanges = Path.applyChanges,\n\tapplyDiff = Path.applyDiff,\n\tstrToPath = Path.strToPath,\n\tpathToStr = Path.pathToStr,\n\tgetPath = Path.getPath;\n\nconst\tWebSocketClient = typeof(WebSocket)!==\"undefined\"?\n\tWebSocket : require('websocket').w3cwebsocket;\n\nvar store = {}, backup = {};\nvar pending = {};\n\nconst vfn = ()=>{};\nconst CHANNEL = \"ashamed\";\nconst DEF_OPTS = {\n\thost : \"localhost:3000\",\n\tbase : \"\",\n\trealtime : true\n}\n\n/**\n * Handles the websocket responses\n * @param msg Websocket message\n */\nfunction handleMessage(msg) {\n\tmsg = JSON.parse(msg.data);\n\t// If channel is incorrect, do nothing\n\tif(msg.channel!=CHANNEL) return;\n\tif(msg.type == \"model-update\") {modelUpdate(msg);}\n\telse if(msg.type == \"response\") {modelResponse(msg);}\n}\n\n/**\n * Updates the subscribed model with external changes\n * @param msg Websocket message data\n */\nfunction modelUpdate(msg) {\n\tvar path = msg.args[0];\n\tvar changes = msg.args[1]||[];\n\t//var bch = JSON.parse(JSON.stringify(changes));\n\tpath = strToPath(path);\n\n\t// Apply all changes\n\tapplyChanges(backup,changes,path);\n\tvar patch = diff(store,backup);\n\tapplyChanges(store,patch);\n}\n\nfunction modelResponse(msg) {\n\tvar cid = msg.cid;\n\tvar [err,data] = msg.args;\n\n\tif(!pending[cid]) return;\n\telse {\n\t\tvar cb = pending[cid];\n\t\tdelete pending[cid];\n\t\tcb(err,data);\n\t}\n}\n\nclass AshamedClient extends EventEmitter {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\toptions = extend({},DEF_OPTS,options);\n\t\tthis._options = options;\n\t\tthis._host = options.host;\n\t\tthis._base = options.base;\n\t\tthis._realtime = options.realtime;\n\t\tthis._url = {\n\t\t\tws : \"ws://\"+options.host+options.base+\"/ws\",\n\t\t\thttp : \"http://\"+options.host+options.base\n\t\t}\n\t\tthis._err = null;\n\t\tthis.connect();\n\t}\n\n\t_send(msg,callback) {\n\t\tvar err = this._err;\n\t\tmsg.channel = CHANNEL;\n\t\tcallback = callback || vfn;\n\n\t\t// Correlation ID to the callback\n\t\tmsg.cid = `ws_${Math.random()}`;\n\t\tpending[msg.cid] = callback;\n\n\t\tif(!err) {\n\t\t\tthis._ready.then(ws=>{\n\t\t\t\tws.send(JSON.stringify(msg));\n\t\t\t},err=>{\n\t\t\t\terr.code = \"ERROR\";\n\t\t\t\tcallback(err,null);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\terr.code = \"ERROR\";\n\t\t\tcallback(err,null);\n\t\t}\n\t}\n\n\tget store() {\n\t\treturn store;\n\t}\n\n\tconnect() {\n\t\tvar def = q.defer();\n\t\tvar ws = new WebSocketClient(this._url.ws);\n\t\tws.onerror = (err)=>{\n\t\t\tthis._err = `Unable to connect to ${this._url.ws}`;\n\t\t\tthis.emit(\"error\",this._err);\n\t\t\tdef.reject(this._err);\n\t\t}\n\t\tws.onopen = ()=>{\n\t\t\tthis._err = null;\n\t\t\tthis.emit(\"ready\",this);\n\t\t\tdef.resolve(ws);\n\t\t}\n\t\tws.onmessage = (msg)=>{\n\t\t\thandleMessage(msg);\n\t\t\tthis.emit(\"message\",msg);\n\t\t}\n\t\tws.onclose = ()=>{\n\t\t\tthis.emit(\"close\");\n\t\t\tthis._err = new Error(\"Connection has been closed\");\n\t\t}\n\t\tthis._ready = def.promise;\n\t}\n\n\tget(path,options) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\toptions = extend({},this._options,options);\n\t\tthis._send({op:\"get\", args:[path,options]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse if(options.realtime && data!==null && data!==undefined) {\n\t\t\t\tapplyDiff(store,data,path);\n\t\t\t\tbackup = extend(true,{},store);\n\t\t\t\tdef.resolve(getPath(path,false,store));\n\t\t\t}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n\n\tset(path,item,options) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\toptions = extend({},this._options,options);\n\t\tthis._send({op:\"set\", args:[path,item,options]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse if(options.realtime) {\n\t\t\t\tapplyDiff(store,data,path);\n\t\t\t\tbackup = extend(true,{},store);\n\t\t\t\tdef.resolve(getPath(path,false,store));\n\t\t\t}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n\n\tupdate(path,item) {\n\t\tvar s = store;\n\t\tvar old = getPath(path,true,backup);\n\t\tvar changes = diff(old,item);\n\t\treturn this.diff(path,changes);\n\t}\n\n\tdiff(path,changes) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\tthis._send({op:\"diff\", args:[path,changes]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n\n\tpath(base) {\n\t\tvar def = q.defer();\n\t\tvar cid = \"ws_\"+Math.random();\n\n\t\tthis._send({op:\"path\", args:[base]},(err,data)=> {\n\t\t\tif(err && err.code) {def.reject(err);}\n\t\t\telse {def.resolve(data);}\n\t\t});\n\n\t\treturn def.promise;\n\t}\n}\n\nmodule.exports = AshamedClient;\n\n},{\"./path.js\":3,\"events\":4,\"extend\":5,\"q\":21,\"websocket\":22}],3:[function(require,module,exports){\nconst\n\textend = require(\"extend\"),\n\tjiff = require(\"jiff\");\n\nfunction strToPath(path) {\n\tpath = path ||[];\n\treturn Array.isArray(path)?\n\t\tpath :\n\t\tpath.replace(/ /g,\"\").split(\"/\").filter(s=>s.length);\n}\n\nfunction pathToStr(path) {\n\tpath = path ||[];\n\tvar res = typeof(path)==\"string\"? path : path.join(\"/\");\n\treturn res.startsWith(\"/\") ? res : `/${res}`;\n}\n\nfunction concat(a,b) {\n\ta = strToPath(a);\n\tb = strToPath(b);\n\treturn pathToStr([].concat(a).concat(b));\n}\n\nfunction getPath(path,create,src,val) {\n\tvar root = src || {};\n\tpath = strToPath(path);\n\tif(!path.length) \t{\n\t\treturn extend(src,val);\n\t}\n\twhile(path.length) {\n\t\tlet folder = path.shift();\n\t\tif(!root[folder]) {\n\t\t\tif(create) {root[folder] = {};}\n\t\t\telse {return null;}\n\t\t}\n\t\tif(!path.length && val!==undefined)\t{\n\t\t\tif(typeof(root[folder])==\"object\" && Object.keys(root[folder]).length) {\n\t\t\t\tif(typeof(val)==\"object\") extend(true,root[folder],val);\n\t\t\t\telse root[folder] = val;\n\t\t\t}\n\t\t\telse {\n\t\t\t\troot[folder] = val;\n\t\t\t}\n\t\t}\n\t\troot = root[folder];\n\t\tif(!path.length) return root;\n\t}\n}\n\nfunction diff(target,source) {\n\treturn jiff.diff(target,source).filter(d=>d.op!=\"test\");\n}\n\nfunction applyDiff(target,source,path) {\n\tvar d = {};\n\tgetPath(path,true,d,source);\n\treturn extend(true,target,d);\n}\n\nfunction applyChanges(target,patch,path) {\n\tpatch.forEach(p=>{\n\t\tp.path = concat(path,p.path);\n\t\tvar np = strToPath(p.path);\n\t\tif(np.length>1) np.pop();\n\t\tgetPath(np,true,target);\n\t});\n\tjiff.patchInPlace(patch, target);\n}\n\nfunction applyChange(target,change) {\n\tgetPath(change.path,false,target);\n\tjiff.patchInPlace([change], target);\n}\n\nmodule.exports = {\n\tstrToPath : strToPath,\n\tpathToStr : pathToStr,\n\tgetPath : getPath,\n\tdiff : diff,\n\tconcat : concat,\n\tapplyDiff : applyDiff,\n\tapplyChange : applyChange,\n\tapplyChanges : applyChanges,\n}\n\n},{\"extend\":5,\"jiff\":6}],4:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\n\nvar isArray = function isArray(arr) {\n\tif (typeof Array.isArray === 'function') {\n\t\treturn Array.isArray(arr);\n\t}\n\n\treturn toStr.call(arr) === '[object Array]';\n};\n\nvar isPlainObject = function isPlainObject(obj) {\n\tif (!obj || toStr.call(obj) !== '[object Object]') {\n\t\treturn false;\n\t}\n\n\tvar hasOwnConstructor = hasOwn.call(obj, 'constructor');\n\tvar hasIsPrototypeOf = obj.constructor && obj.constructor.prototype && hasOwn.call(obj.constructor.prototype, 'isPrototypeOf');\n\t// Not own constructor property must be Object\n\tif (obj.constructor && !hasOwnConstructor && !hasIsPrototypeOf) {\n\t\treturn false;\n\t}\n\n\t// Own properties are enumerated firstly, so to speed up,\n\t// if last one is own, then all properties are own.\n\tvar key;\n\tfor (key in obj) { /**/ }\n\n\treturn typeof key === 'undefined' || hasOwn.call(obj, key);\n};\n\nmodule.exports = function extend() {\n\tvar options, name, src, copy, copyIsArray, clone;\n\tvar target = arguments[0];\n\tvar i = 1;\n\tvar length = arguments.length;\n\tvar deep = false;\n\n\t// Handle a deep copy situation\n\tif (typeof target === 'boolean') {\n\t\tdeep = target;\n\t\ttarget = arguments[1] || {};\n\t\t// skip the boolean and the target\n\t\ti = 2;\n\t}\n\tif (target == null || (typeof target !== 'object' && typeof target !== 'function')) {\n\t\ttarget = {};\n\t}\n\n\tfor (; i < length; ++i) {\n\t\toptions = arguments[i];\n\t\t// Only deal with non-null/undefined values\n\t\tif (options != null) {\n\t\t\t// Extend the base object\n\t\t\tfor (name in options) {\n\t\t\t\tsrc = target[name];\n\t\t\t\tcopy = options[name];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif (target !== copy) {\n\t\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\t\tif (deep && copy && (isPlainObject(copy) || (copyIsArray = isArray(copy)))) {\n\t\t\t\t\t\tif (copyIsArray) {\n\t\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\t\tclone = src && isArray(src) ? src : [];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone = src && isPlainObject(src) ? src : {};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\t\ttarget[name] = extend(deep, clone, copy);\n\n\t\t\t\t\t// Don't bring in undefined values\n\t\t\t\t\t} else if (typeof copy !== 'undefined') {\n\t\t\t\t\t\ttarget[name] = copy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\n},{}],6:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nvar lcs = require('./lib/lcs');\nvar array = require('./lib/array');\nvar patch = require('./lib/jsonPatch');\nvar inverse = require('./lib/inverse');\nvar jsonPointer = require('./lib/jsonPointer');\nvar encodeSegment = jsonPointer.encodeSegment;\n\nexports.diff = diff;\nexports.patch = patch.apply;\nexports.patchInPlace = patch.applyInPlace;\nexports.inverse = inverse;\nexports.clone = patch.clone;\n\n// Errors\nexports.InvalidPatchOperationError = require('./lib/InvalidPatchOperationError');\nexports.TestFailedError = require('./lib/TestFailedError');\nexports.PatchNotInvertibleError = require('./lib/PatchNotInvertibleError');\n\nvar isValidObject = patch.isValidObject;\nvar defaultHash = patch.defaultHash;\n\n/**\n * Compute a JSON Patch representing the differences between a and b.\n * @param {object|array|string|number|null} a\n * @param {object|array|string|number|null} b\n * @param {?function|?object} options if a function, see options.hash\n * @param {?function(x:*):String|Number} options.hash used to hash array items\n *  in order to recognize identical objects, defaults to JSON.stringify\n * @param {?function(index:Number, array:Array):object} options.makeContext\n *  used to generate patch context. If not provided, context will not be generated\n * @returns {array} JSON Patch such that patch(diff(a, b), a) ~ b\n */\nfunction diff(a, b, options) {\n\treturn appendChanges(a, b, '', initState(options, [])).patch;\n}\n\n/**\n * Create initial diff state from the provided options\n * @param {?function|?object} options @see diff options above\n * @param {array} patch an empty or existing JSON Patch array into which\n *  the diff should generate new patch operations\n * @returns {object} initialized diff state\n */\nfunction initState(options, patch) {\n\tif(typeof options === 'object') {\n\t\treturn {\n\t\t\tpatch: patch,\n\t\t\thash: orElse(isFunction, options.hash, defaultHash),\n\t\t\tmakeContext: orElse(isFunction, options.makeContext, defaultContext),\n\t\t\tinvertible: !(options.invertible === false)\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tpatch: patch,\n\t\t\thash: orElse(isFunction, options, defaultHash),\n\t\t\tmakeContext: defaultContext,\n\t\t\tinvertible: true\n\t\t};\n\t}\n}\n\n/**\n * Given two JSON values (object, array, number, string, etc.), find their\n * differences and append them to the diff state\n * @param {object|array|string|number|null} a\n * @param {object|array|string|number|null} b\n * @param {string} path\n * @param {object} state\n * @returns {Object} updated diff state\n */\nfunction appendChanges(a, b, path, state) {\n\tif(Array.isArray(a) && Array.isArray(b)) {\n\t\treturn appendArrayChanges(a, b, path, state);\n\t}\n\n\tif(isValidObject(a) && isValidObject(b)) {\n\t\treturn appendObjectChanges(a, b, path, state);\n\t}\n\n\treturn appendValueChanges(a, b, path, state);\n}\n\n/**\n * Given two objects, find their differences and append them to the diff state\n * @param {object} o1\n * @param {object} o2\n * @param {string} path\n * @param {object} state\n * @returns {Object} updated diff state\n */\nfunction appendObjectChanges(o1, o2, path, state) {\n\tvar keys = Object.keys(o2);\n\tvar patch = state.patch;\n\tvar i, key;\n\n\tfor(i=keys.length-1; i>=0; --i) {\n\t\tkey = keys[i];\n\t\tvar keyPath = path + '/' + encodeSegment(key);\n\t\tif(o1[key] !== void 0) {\n\t\t\tappendChanges(o1[key], o2[key], keyPath, state);\n\t\t} else {\n\t\t\tpatch.push({ op: 'add', path: keyPath, value: o2[key] });\n\t\t}\n\t}\n\n\tkeys = Object.keys(o1);\n\tfor(i=keys.length-1; i>=0; --i) {\n\t\tkey = keys[i];\n\t\tif(o2[key] === void 0) {\n\t\t\tvar p = path + '/' + encodeSegment(key);\n\t\t\tif(state.invertible) {\n\t\t\t\tpatch.push({ op: 'test', path: p, value: o1[key] });\n\t\t\t}\n\t\t\tpatch.push({ op: 'remove', path: p });\n\t\t}\n\t}\n\n\treturn state;\n}\n\n/**\n * Given two arrays, find their differences and append them to the diff state\n * @param {array} a1\n * @param {array} a2\n * @param {string} path\n * @param {object} state\n * @returns {Object} updated diff state\n */\nfunction appendArrayChanges(a1, a2, path, state) {\n\tvar a1hash = array.map(state.hash, a1);\n\tvar a2hash = array.map(state.hash, a2);\n\n\tvar lcsMatrix = lcs.compare(a1hash, a2hash);\n\n\treturn lcsToJsonPatch(a1, a2, path, state, lcsMatrix);\n}\n\n/**\n * Transform an lcsMatrix into JSON Patch operations and append\n * them to state.patch, recursing into array elements as necessary\n * @param {array} a1\n * @param {array} a2\n * @param {string} path\n * @param {object} state\n * @param {object} lcsMatrix\n * @returns {object} new state with JSON Patch operations added based\n *  on the provided lcsMatrix\n */\nfunction lcsToJsonPatch(a1, a2, path, state, lcsMatrix) {\n\tvar offset = 0;\n\treturn lcs.reduce(function(state, op, i, j) {\n\t\tvar last, context;\n\t\tvar patch = state.patch;\n\t\tvar p = path + '/' + (j + offset);\n\n\t\tif (op === lcs.REMOVE) {\n\t\t\t// Coalesce adjacent remove + add into replace\n\t\t\tlast = patch[patch.length-1];\n\t\t\tcontext = state.makeContext(j, a1);\n\n\t\t\tif(state.invertible) {\n\t\t\t\tpatch.push({ op: 'test', path: p, value: a1[j], context: context });\n\t\t\t}\n\n\t\t\tif(last !== void 0 && last.op === 'add' && last.path === p) {\n\t\t\t\tlast.op = 'replace';\n\t\t\t\tlast.context = context;\n\t\t\t} else {\n\t\t\t\tpatch.push({ op: 'remove', path: p, context: context });\n\t\t\t}\n\n\t\t\toffset -= 1;\n\n\t\t} else if (op === lcs.ADD) {\n\t\t\t// See https://tools.ietf.org/html/rfc6902#section-4.1\n\t\t\t// May use either index===length *or* '-' to indicate appending to array\n\t\t\tpatch.push({ op: 'add', path: p, value: a2[i],\n\t\t\t\tcontext: state.makeContext(j, a1)\n\t\t\t});\n\n\t\t\toffset += 1;\n\n\t\t} else {\n\t\t\tappendChanges(a1[j], a2[i], p, state);\n\t\t}\n\n\t\treturn state;\n\n\t}, state, lcsMatrix);\n}\n\n/**\n * Given two number|string|null values, if they differ, append to diff state\n * @param {string|number|null} a\n * @param {string|number|null} b\n * @param {string} path\n * @param {object} state\n * @returns {object} updated diff state\n */\nfunction appendValueChanges(a, b, path, state) {\n\tif(a !== b) {\n\t\tif(state.invertible) {\n\t\t\tstate.patch.push({ op: 'test', path: path, value: a });\n\t\t}\n\n\t\tstate.patch.push({ op: 'replace', path: path, value: b });\n\t}\n\n\treturn state;\n}\n\n/**\n * @param {function} predicate\n * @param {*} x\n * @param {*} y\n * @returns {*} x if predicate(x) is truthy, otherwise y\n */\nfunction orElse(predicate, x, y) {\n\treturn predicate(x) ? x : y;\n}\n\n/**\n * Default patch context generator\n * @returns {undefined} undefined context\n */\nfunction defaultContext() {\n\treturn void 0;\n}\n\n/**\n * @param {*} x\n * @returns {boolean} true if x is a function, false otherwise\n */\nfunction isFunction(x) {\n\treturn typeof x === 'function';\n}\n\n},{\"./lib/InvalidPatchOperationError\":7,\"./lib/PatchNotInvertibleError\":8,\"./lib/TestFailedError\":9,\"./lib/array\":10,\"./lib/inverse\":14,\"./lib/jsonPatch\":15,\"./lib/jsonPointer\":16,\"./lib/lcs\":18}],7:[function(require,module,exports){\nmodule.exports = InvalidPatchOperationError;\n\nfunction InvalidPatchOperationError(message) {\n\tError.call(this);\n\tthis.name = this.constructor.name;\n\tthis.message = message;\n\tif(typeof Error.captureStackTrace === 'function') {\n\t\tError.captureStackTrace(this, this.constructor);\n\t}\n}\n\nInvalidPatchOperationError.prototype = Object.create(Error.prototype);\nInvalidPatchOperationError.prototype.constructor = InvalidPatchOperationError;\n},{}],8:[function(require,module,exports){\nmodule.exports = PatchNotInvertibleError;\n\nfunction PatchNotInvertibleError(message) {\n\tError.call(this);\n\tthis.name = this.constructor.name;\n\tthis.message = message;\n\tif(typeof Error.captureStackTrace === 'function') {\n\t\tError.captureStackTrace(this, this.constructor);\n\t}\n}\n\nPatchNotInvertibleError.prototype = Object.create(Error.prototype);\nPatchNotInvertibleError.prototype.constructor = PatchNotInvertibleError;\n},{}],9:[function(require,module,exports){\nmodule.exports = TestFailedError;\n\nfunction TestFailedError(message) {\n\tError.call(this);\n\tthis.name = this.constructor.name;\n\tthis.message = message;\n\tif(typeof Error.captureStackTrace === 'function') {\n\t\tError.captureStackTrace(this, this.constructor);\n\t}\n}\n\nTestFailedError.prototype = Object.create(Error.prototype);\nTestFailedError.prototype.constructor = TestFailedError;\n},{}],10:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexports.cons = cons;\nexports.tail = tail;\nexports.map = map;\n\n/**\n * Prepend x to a, without mutating a. Faster than a.unshift(x)\n * @param {*} x\n * @param {Array} a array-like\n * @returns {Array} new Array with x prepended\n */\nfunction cons(x, a) {\n\tvar l = a.length;\n\tvar b = new Array(l+1);\n\tb[0] = x;\n\tfor(var i=0; i<l; ++i) {\n\t\tb[i+1] = a[i];\n\t}\n\n\treturn b;\n}\n\n/**\n * Create a new Array containing all elements in a, except the first.\n *  Faster than a.slice(1)\n * @param {Array} a array-like\n * @returns {Array} new Array, the equivalent of a.slice(1)\n */\nfunction tail(a) {\n\tvar l = a.length-1;\n\tvar b = new Array(l);\n\tfor(var i=0; i<l; ++i) {\n\t\tb[i] = a[i+1];\n\t}\n\n\treturn b;\n}\n\n/**\n * Map any array-like. Faster than Array.prototype.map\n * @param {function} f\n * @param {Array} a array-like\n * @returns {Array} new Array mapped by f\n */\nfunction map(f, a) {\n\tvar b = new Array(a.length);\n\tfor(var i=0; i< a.length; ++i) {\n\t\tb[i] = f(a[i]);\n\t}\n\treturn b;\n}\n},{}],11:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n/**\n * Create a deep copy of x which must be a legal JSON object/array/value\n * @param {object|array|string|number|null} x object/array/value to clone\n * @returns {object|array|string|number|null} clone of x\n */\nmodule.exports = clone;\n\nfunction clone(x) {\n\tif(x == null || typeof x !== 'object') {\n\t\treturn x;\n\t}\n\n\tif(Array.isArray(x)) {\n\t\treturn cloneArray(x);\n\t}\n\n\treturn cloneObject(x);\n}\n\nfunction cloneArray (x) {\n\tvar l = x.length;\n\tvar y = new Array(l);\n\n\tfor (var i = 0; i < l; ++i) {\n\t\ty[i] = clone(x[i]);\n\t}\n\n\treturn y;\n}\n\nfunction cloneObject (x) {\n\tvar keys = Object.keys(x);\n\tvar y = {};\n\n\tfor (var k, i = 0, l = keys.length; i < l; ++i) {\n\t\tk = keys[i];\n\t\ty[k] = clone(x[k]);\n\t}\n\n\treturn y;\n}\n\n},{}],12:[function(require,module,exports){\nvar jsonPointer = require('./jsonPointer');\n\n/**\n * commute the patch sequence a,b to b,a\n * @param {object} a patch operation\n * @param {object} b patch operation\n */\nmodule.exports = function commutePaths(a, b) {\n\t// TODO: cases for special paths: '' and '/'\n\tvar left = jsonPointer.parse(a.path);\n\tvar right = jsonPointer.parse(b.path);\n\tvar prefix = getCommonPathPrefix(left, right);\n\tvar isArray = isArrayPath(left, right, prefix.length);\n\n\t// Never mutate the originals\n\tvar ac = copyPatch(a);\n\tvar bc = copyPatch(b);\n\n\tif(prefix.length === 0 && !isArray) {\n\t\t// Paths share no common ancestor, simple swap\n\t\treturn [bc, ac];\n\t}\n\n\tif(isArray) {\n\t\treturn commuteArrayPaths(ac, left, bc, right);\n\t} else {\n\t\treturn commuteTreePaths(ac, left, bc, right);\n\t}\n};\n\nfunction commuteTreePaths(a, left, b, right) {\n\tif(a.path === b.path) {\n\t\tthrow new TypeError('cannot commute ' + a.op + ',' + b.op + ' with identical object paths');\n\t}\n\t// FIXME: Implement tree path commutation\n\treturn [b, a];\n}\n\n/**\n * Commute two patches whose common ancestor (which may be the immediate parent)\n * is an array\n * @param a\n * @param left\n * @param b\n * @param right\n * @returns {*}\n */\nfunction commuteArrayPaths(a, left, b, right) {\n\tif(left.length === right.length) {\n\t\treturn commuteArraySiblings(a, left, b, right);\n\t}\n\n\tif (left.length > right.length) {\n\t\t// left is longer, commute by \"moving\" it to the right\n\t\tleft = commuteArrayAncestor(b, right, a, left, -1);\n\t\ta.path = jsonPointer.absolute(jsonPointer.join(left));\n\t} else {\n\t\t// right is longer, commute by \"moving\" it to the left\n\t\tright = commuteArrayAncestor(a, left, b, right, 1);\n\t\tb.path = jsonPointer.absolute(jsonPointer.join(right));\n\t}\n\n\treturn [b, a];\n}\n\nfunction isArrayPath(left, right, index) {\n\treturn jsonPointer.isValidArrayIndex(left[index])\n\t\t&& jsonPointer.isValidArrayIndex(right[index]);\n}\n\n/**\n * Commute two patches referring to items in the same array\n * @param l\n * @param lpath\n * @param r\n * @param rpath\n * @returns {*[]}\n */\nfunction commuteArraySiblings(l, lpath, r, rpath) {\n\n\tvar target = lpath.length-1;\n\tvar lindex = +lpath[target];\n\tvar rindex = +rpath[target];\n\n\tvar commuted;\n\n\tif(lindex < rindex) {\n\t\t// Adjust right path\n\t\tif(l.op === 'add' || l.op === 'copy') {\n\t\t\tcommuted = rpath.slice();\n\t\t\tcommuted[target] = Math.max(0, rindex - 1);\n\t\t\tr.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t\t} else if(l.op === 'remove') {\n\t\t\tcommuted = rpath.slice();\n\t\t\tcommuted[target] = rindex + 1;\n\t\t\tr.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t\t}\n\t} else if(r.op === 'add' || r.op === 'copy') {\n\t\t// Adjust left path\n\t\tcommuted = lpath.slice();\n\t\tcommuted[target] = lindex + 1;\n\t\tl.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t} else if (lindex > rindex && r.op === 'remove') {\n\t\t// Adjust left path only if remove was at a (strictly) lower index\n\t\tcommuted = lpath.slice();\n\t\tcommuted[target] = Math.max(0, lindex - 1);\n\t\tl.path = jsonPointer.absolute(jsonPointer.join(commuted));\n\t}\n\n\treturn [r, l];\n}\n\n/**\n * Commute two patches with a common array ancestor\n * @param l\n * @param lpath\n * @param r\n * @param rpath\n * @param direction\n * @returns {*}\n */\nfunction commuteArrayAncestor(l, lpath, r, rpath, direction) {\n\t// rpath is longer or same length\n\n\tvar target = lpath.length-1;\n\tvar lindex = +lpath[target];\n\tvar rindex = +rpath[target];\n\n\t// Copy rpath, then adjust its array index\n\tvar rc = rpath.slice();\n\n\tif(lindex > rindex) {\n\t\treturn rc;\n\t}\n\n\tif(l.op === 'add' || l.op === 'copy') {\n\t\trc[target] = Math.max(0, rindex - direction);\n\t} else if(l.op === 'remove') {\n\t\trc[target] = Math.max(0, rindex + direction);\n\t}\n\n\treturn rc;\n}\n\nfunction getCommonPathPrefix(p1, p2) {\n\tvar p1l = p1.length;\n\tvar p2l = p2.length;\n\tif(p1l === 0 || p2l === 0 || (p1l < 2 && p2l < 2)) {\n\t\treturn [];\n\t}\n\n\t// If paths are same length, the last segment cannot be part\n\t// of a common prefix.  If not the same length, the prefix cannot\n\t// be longer than the shorter path.\n\tvar l = p1l === p2l\n\t\t? p1l - 1\n\t\t: Math.min(p1l, p2l);\n\n\tvar i = 0;\n\twhile(i < l && p1[i] === p2[i]) {\n\t\t++i\n\t}\n\n\treturn p1.slice(0, i);\n}\n\nfunction copyPatch(p) {\n\tif(p.op === 'remove') {\n\t\treturn { op: p.op, path: p.path };\n\t}\n\n\tif(p.op === 'copy' || p.op === 'move') {\n\t\treturn { op: p.op, path: p.path, from: p.from };\n\t}\n\n\t// test, add, replace\n\treturn { op: p.op, path: p.path, value: p.value };\n}\n},{\"./jsonPointer\":16}],13:[function(require,module,exports){\nmodule.exports = deepEquals;\n\n/**\n * Compare 2 JSON values, or recursively compare 2 JSON objects or arrays\n * @param {object|array|string|number|boolean|null} a\n * @param {object|array|string|number|boolean|null} b\n * @returns {boolean} true iff a and b are recursively equal\n */\nfunction deepEquals(a, b) {\n\tif(a === b) {\n\t\treturn true;\n\t}\n\n\tif(Array.isArray(a) && Array.isArray(b)) {\n\t\treturn compareArrays(a, b);\n\t}\n\n\tif(typeof a === 'object' && typeof b === 'object') {\n\t\treturn compareObjects(a, b);\n\t}\n\n\treturn false;\n}\n\nfunction compareArrays(a, b) {\n\tif(a.length !== b.length) {\n\t\treturn false;\n\t}\n\n\tfor(var i = 0; i<a.length; ++i) {\n\t\tif(!deepEquals(a[i], b[i])) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction compareObjects(a, b) {\n\tif((a === null && b !== null) || (a !== null && b === null)) {\n\t\treturn false;\n\t}\n\n\tvar akeys = Object.keys(a);\n\tvar bkeys = Object.keys(b);\n\n\tif(akeys.length !== bkeys.length) {\n\t\treturn false;\n\t}\n\n\tfor(var i = 0, k; i<akeys.length; ++i) {\n\t\tk = akeys[i];\n\t\tif(!(k in b && deepEquals(a[k], b[k]))) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n},{}],14:[function(require,module,exports){\nvar patches = require('./patches');\n\nmodule.exports = function inverse(p) {\n\tvar pr = [];\n\tvar i, skip;\n\tfor(i = p.length-1; i>= 0; i -= skip) {\n\t\tskip = invertOp(pr, p[i], i, p);\n\t}\n\n\treturn pr;\n};\n\nfunction invertOp(patch, c, i, context) {\n\tvar op = patches[c.op];\n\treturn op !== void 0 && typeof op.inverse === 'function'\n\t\t? op.inverse(patch, c, i, context)\n\t\t: 1;\n}\n\n},{\"./patches\":19}],15:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nvar patches = require('./patches');\nvar clone = require('./clone');\nvar InvalidPatchOperationError = require('./InvalidPatchOperationError');\n\nexports.apply = patch;\nexports.applyInPlace = patchInPlace;\nexports.clone = clone;\nexports.isValidObject = isValidObject;\nexports.defaultHash = defaultHash;\n\nvar defaultOptions = {};\n\n/**\n * Apply the supplied JSON Patch to x\n * @param {array} changes JSON Patch\n * @param {object|array|string|number} x object/array/value to patch\n * @param {object} options\n * @param {function(index:Number, array:Array, context:object):Number} options.findContext\n *  function used adjust array indexes for smarty/fuzzy patching, for\n *  patches containing context\n * @returns {object|array|string|number} patched version of x. If x is\n *  an array or object, it will be mutated and returned. Otherwise, if\n *  x is a value, the new value will be returned.\n */\nfunction patch(changes, x, options) {\n\treturn patchInPlace(changes, clone(x), options);\n}\n\nfunction patchInPlace(changes, x, options) {\n\tif(!options) {\n\t\toptions = defaultOptions;\n\t}\n\n\t// TODO: Consider throwing if changes is not an array\n\tif(!Array.isArray(changes)) {\n\t\treturn x;\n\t}\n\n\tvar patch, p;\n\tfor(var i=0; i<changes.length; ++i) {\n\t\tp = changes[i];\n\t\tpatch = patches[p.op];\n\n\t\tif(patch === void 0) {\n\t\t\tthrow new InvalidPatchOperationError('invalid op ' + JSON.stringify(p));\n\t\t}\n\n\t\tx = patch.apply(x, p, options);\n\t}\n\n\treturn x;\n}\n\nfunction defaultHash(x) {\n\treturn isValidObject(x) || isArray(x) ? JSON.stringify(x) : x;\n}\n\nfunction isValidObject (x) {\n\treturn x !== null && Object.prototype.toString.call(x) === '[object Object]';\n}\n\nfunction isArray (x) {\n\treturn Object.prototype.toString.call(x) === '[object Array]';\n}\n\n},{\"./InvalidPatchOperationError\":7,\"./clone\":11,\"./patches\":19}],16:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nvar _parse = require('./jsonPointerParse');\n\nexports.find = find;\nexports.join = join;\nexports.absolute = absolute;\nexports.parse = parse;\nexports.contains = contains;\nexports.encodeSegment = encodeSegment;\nexports.decodeSegment = decodeSegment;\nexports.parseArrayIndex = parseArrayIndex;\nexports.isValidArrayIndex = isValidArrayIndex;\n\n// http://tools.ietf.org/html/rfc6901#page-2\nvar separator = '/';\nvar separatorRx = /\\//g;\nvar encodedSeparator = '~1';\nvar encodedSeparatorRx = /~1/g;\n\nvar escapeChar = '~';\nvar escapeRx = /~/g;\nvar encodedEscape = '~0';\nvar encodedEscapeRx = /~0/g;\n\n/**\n * Find the parent of the specified path in x and return a descriptor\n * containing the parent and a key.  If the parent does not exist in x,\n * return undefined, instead.\n * @param {object|array} x object or array in which to search\n * @param {string} path JSON Pointer string (encoded)\n * @param {?function(index:Number, array:Array, context:object):Number} findContext\n *  optional function used adjust array indexes for smarty/fuzzy patching, for\n *  patches containing context.  If provided, context MUST also be provided.\n * @param {?{before:Array, after:Array}} context optional patch context for\n *  findContext to use to adjust array indices.  If provided, findContext MUST\n *  also be provided.\n * @returns {{target:object|array|number|string, key:string}|undefined}\n */\nfunction find(x, path, findContext, context) {\n\tif(typeof path !== 'string') {\n\t\treturn;\n\t}\n\n\tif(path === '') {\n\t\t// whole document\n\t\treturn { target: x, key: void 0 };\n\t}\n\n\tif(path === separator) {\n\t\treturn { target: x, key: '' };\n\t}\n\n\tvar parent = x, key;\n\tvar hasContext = context !== void 0;\n\n\t_parse(path, function(segment) {\n\t\t// hm... this seems like it should be if(typeof x === 'undefined')\n\t\tif(x == null) {\n\t\t\t// Signal that we prematurely hit the end of the path hierarchy.\n\t\t\tparent = null;\n\t\t\treturn false;\n\t\t}\n\n\t\tif(Array.isArray(x)) {\n\t\t\tkey = hasContext\n\t\t\t\t? findIndex(findContext, parseArrayIndex(segment), x, context)\n\t\t\t\t: segment === '-' ? segment : parseArrayIndex(segment);\n\t\t} else {\n\t\t\tkey = segment;\n\t\t}\n\n\t\tparent = x;\n\t\tx = x[key];\n\t});\n\n\treturn parent === null\n\t\t? void 0\n\t\t: { target: parent, key: key };\n}\n\nfunction absolute(path) {\n\treturn path[0] === separator ? path : separator + path;\n}\n\nfunction join(segments) {\n\treturn segments.join(separator);\n}\n\nfunction parse(path) {\n\tvar segments = [];\n\t_parse(path, segments.push.bind(segments));\n\treturn segments;\n}\n\nfunction contains(a, b) {\n\treturn b.indexOf(a) === 0 && b[a.length] === separator;\n}\n\n/**\n * Decode a JSON Pointer path segment\n * @see http://tools.ietf.org/html/rfc6901#page-3\n * @param {string} s encoded segment\n * @returns {string} decoded segment\n */\nfunction decodeSegment(s) {\n\t// See: http://tools.ietf.org/html/rfc6901#page-3\n\treturn s.replace(encodedSeparatorRx, separator).replace(encodedEscapeRx, escapeChar);\n}\n\n/**\n * Encode a JSON Pointer path segment\n * @see http://tools.ietf.org/html/rfc6901#page-3\n * @param {string} s decoded segment\n * @returns {string} encoded segment\n */\nfunction encodeSegment(s) {\n\treturn s.replace(escapeRx, encodedEscape).replace(separatorRx, encodedSeparator);\n}\n\nvar arrayIndexRx = /^(0|[1-9]\\d*)$/;\n\n/**\n * Return true if s is a valid JSON Pointer array index\n * @param {String} s\n * @returns {boolean}\n */\nfunction isValidArrayIndex(s) {\n\treturn arrayIndexRx.test(s);\n}\n\n/**\n * Safely parse a string into a number >= 0. Does not check for decimal numbers\n * @param {string} s numeric string\n * @returns {number} number >= 0\n */\nfunction parseArrayIndex (s) {\n\tif(isValidArrayIndex(s)) {\n\t\treturn +s;\n\t}\n\n\tthrow new SyntaxError('invalid array index ' + s);\n}\n\nfunction findIndex (findContext, start, array, context) {\n\tvar index = start;\n\n\tif(index < 0) {\n\t\tthrow new Error('array index out of bounds ' + index);\n\t}\n\n\tif(context !== void 0 && typeof findContext === 'function') {\n\t\tindex = findContext(start, array, context);\n\t\tif(index < 0) {\n\t\t\tthrow new Error('could not find patch context ' + context);\n\t\t}\n\t}\n\n\treturn index;\n}\n},{\"./jsonPointerParse\":17}],17:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nmodule.exports = jsonPointerParse;\n\nvar parseRx = /\\/|~1|~0/g;\nvar separator = '/';\nvar escapeChar = '~';\nvar encodedSeparator = '~1';\n\n/**\n * Parse through an encoded JSON Pointer string, decoding each path segment\n * and passing it to an onSegment callback function.\n * @see https://tools.ietf.org/html/rfc6901#section-4\n * @param {string} path encoded JSON Pointer string\n * @param {{function(segment:string):boolean}} onSegment callback function\n * @returns {string} original path\n */\nfunction jsonPointerParse(path, onSegment) {\n\tvar pos, accum, matches, match;\n\n\tpos = path.charAt(0) === separator ? 1 : 0;\n\taccum = '';\n\tparseRx.lastIndex = pos;\n\n\twhile(matches = parseRx.exec(path)) {\n\n\t\tmatch = matches[0];\n\t\taccum += path.slice(pos, parseRx.lastIndex - match.length);\n\t\tpos = parseRx.lastIndex;\n\n\t\tif(match === separator) {\n\t\t\tif (onSegment(accum) === false) return path;\n\t\t\taccum = '';\n\t\t} else {\n\t\t\taccum += match === encodedSeparator ? separator : escapeChar;\n\t\t}\n\t}\n\n\taccum += path.slice(pos);\n\tonSegment(accum);\n\n\treturn path;\n}\n\n},{}],18:[function(require,module,exports){\n/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\nexports.compare = compare;\nexports.reduce = reduce;\n\nvar REMOVE, RIGHT, ADD, DOWN, SKIP;\n\nexports.REMOVE = REMOVE = RIGHT = -1;\nexports.ADD    = ADD    = DOWN  =  1;\nexports.EQUAL  = SKIP   = 0;\n\n/**\n * Create an lcs comparison matrix describing the differences\n * between two array-like sequences\n * @param {array} a array-like\n * @param {array} b array-like\n * @returns {object} lcs descriptor, suitable for passing to reduce()\n */\nfunction compare(a, b) {\n\tvar cols = a.length;\n\tvar rows = b.length;\n\n\tvar prefix = findPrefix(a, b);\n\tvar suffix = prefix < cols && prefix < rows\n\t\t? findSuffix(a, b, prefix)\n\t\t: 0;\n\n\tvar remove = suffix + prefix - 1;\n\tcols -= remove;\n\trows -= remove;\n\tvar matrix = createMatrix(cols, rows);\n\n\tfor (var j = cols - 1; j >= 0; --j) {\n\t\tfor (var i = rows - 1; i >= 0; --i) {\n\t\t\tmatrix[i][j] = backtrack(matrix, a, b, prefix, j, i);\n\t\t}\n\t}\n\n\treturn {\n\t\tprefix: prefix,\n\t\tmatrix: matrix,\n\t\tsuffix: suffix\n\t};\n}\n\n/**\n * Reduce a set of lcs changes previously created using compare\n * @param {function(result:*, type:number, i:number, j:number)} f\n *  reducer function, where:\n *  - result is the current reduce value,\n *  - type is the type of change: ADD, REMOVE, or SKIP\n *  - i is the index of the change location in b\n *  - j is the index of the change location in a\n * @param {*} r initial value\n * @param {object} lcs results returned by compare()\n * @returns {*} the final reduced value\n */\nfunction reduce(f, r, lcs) {\n\tvar i, j, k, op;\n\n\tvar m = lcs.matrix;\n\n\t// Reduce shared prefix\n\tvar l = lcs.prefix;\n\tfor(i = 0;i < l; ++i) {\n\t\tr = f(r, SKIP, i, i);\n\t}\n\n\t// Reduce longest change span\n\tk = i;\n\tl = m.length;\n\ti = 0;\n\tj = 0;\n\twhile(i < l) {\n\t\top = m[i][j].type;\n\t\tr = f(r, op, i+k, j+k);\n\n\t\tswitch(op) {\n\t\t\tcase SKIP:  ++i; ++j; break;\n\t\t\tcase RIGHT: ++j; break;\n\t\t\tcase DOWN:  ++i; break;\n\t\t}\n\t}\n\n\t// Reduce shared suffix\n\ti += k;\n\tj += k;\n\tl = lcs.suffix;\n\tfor(k = 0;k < l; ++k) {\n\t\tr = f(r, SKIP, i+k, j+k);\n\t}\n\n\treturn r;\n}\n\nfunction findPrefix(a, b) {\n\tvar i = 0;\n\tvar l = Math.min(a.length, b.length);\n\twhile(i < l && a[i] === b[i]) {\n\t\t++i;\n\t}\n\treturn i;\n}\n\nfunction findSuffix(a, b) {\n\tvar al = a.length - 1;\n\tvar bl = b.length - 1;\n\tvar l = Math.min(al, bl);\n\tvar i = 0;\n\twhile(i < l && a[al-i] === b[bl-i]) {\n\t\t++i;\n\t}\n\treturn i;\n}\n\nfunction backtrack(matrix, a, b, start, j, i) {\n\tif (a[j+start] === b[i+start]) {\n\t\treturn { value: matrix[i + 1][j + 1].value, type: SKIP };\n\t}\n\tif (matrix[i][j + 1].value < matrix[i + 1][j].value) {\n\t\treturn { value: matrix[i][j + 1].value + 1, type: RIGHT };\n\t}\n\n\treturn { value: matrix[i + 1][j].value + 1, type: DOWN };\n}\n\nfunction createMatrix (cols, rows) {\n\tvar m = [], i, j, lastrow;\n\n\t// Fill the last row\n\tlastrow = m[rows] = [];\n\tfor (j = 0; j<cols; ++j) {\n\t\tlastrow[j] = { value: cols - j, type: RIGHT };\n\t}\n\n\t// Fill the last col\n\tfor (i = 0; i<rows; ++i) {\n\t\tm[i] = [];\n\t\tm[i][cols] = { value: rows - i, type: DOWN };\n\t}\n\n\t// Fill the last cell\n\tm[rows][cols] = { value: 0, type: SKIP };\n\n\treturn m;\n}\n\n},{}],19:[function(require,module,exports){\nvar jsonPointer = require('./jsonPointer');\nvar clone = require('./clone');\nvar deepEquals = require('./deepEquals');\nvar commutePaths = require('./commutePaths');\n\nvar array = require('./array');\n\nvar TestFailedError = require('./TestFailedError');\nvar InvalidPatchOperationError = require('./InvalidPatchOperationError');\nvar PatchNotInvertibleError = require('./PatchNotInvertibleError');\n\nvar find = jsonPointer.find;\nvar parseArrayIndex = jsonPointer.parseArrayIndex;\n\nexports.test = {\n\tapply: applyTest,\n\tinverse: invertTest,\n\tcommute: commuteTest\n};\n\nexports.add = {\n\tapply: applyAdd,\n\tinverse: invertAdd,\n\tcommute: commuteAddOrCopy\n};\n\nexports.remove = {\n\tapply: applyRemove,\n\tinverse: invertRemove,\n\tcommute: commuteRemove\n};\n\nexports.replace = {\n\tapply: applyReplace,\n\tinverse: invertReplace,\n\tcommute: commuteReplace\n};\n\nexports.move = {\n\tapply: applyMove,\n\tinverse: invertMove,\n\tcommute: commuteMove\n};\n\nexports.copy = {\n\tapply: applyCopy,\n\tinverse: notInvertible,\n\tcommute: commuteAddOrCopy\n};\n\n/**\n * Apply a test operation to x\n * @param {object|array} x\n * @param {object} test test operation\n * @throws {TestFailedError} if the test operation fails\n */\n\nfunction applyTest(x, test, options) {\n\tvar pointer = find(x, test.path, options.findContext, test.context);\n\tvar target = pointer.target;\n\tvar index, value;\n\n\tif(Array.isArray(target)) {\n\t\tindex = parseArrayIndex(pointer.key);\n\t\t//index = findIndex(options.findContext, index, target, test.context);\n\t\tvalue = target[index];\n\t} else {\n\t\tvalue = pointer.key === void 0 ? pointer.target : pointer.target[pointer.key];\n\t}\n\n\tif(!deepEquals(value, test.value)) {\n\t\tthrow new TestFailedError('test failed ' + JSON.stringify(test));\n\t}\n\n\treturn x;\n}\n\n/**\n * Invert the provided test and add it to the inverted patch sequence\n * @param pr\n * @param test\n * @returns {number}\n */\nfunction invertTest(pr, test) {\n\tpr.push(test);\n\treturn 1;\n}\n\nfunction commuteTest(test, b) {\n\tif(test.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute test,remove -> remove,test for same path');\n\t}\n\n\tif(b.op === 'test' || b.op === 'replace') {\n\t\treturn [b, test];\n\t}\n\n\treturn commutePaths(test, b);\n}\n\n/**\n * Apply an add operation to x\n * @param {object|array} x\n * @param {object} change add operation\n */\nfunction applyAdd(x, change, options) {\n\tvar pointer = find(x, change.path, options.findContext, change.context);\n\n\tif(notFound(pointer)) {\n\t\tthrow new InvalidPatchOperationError('path does not exist ' + change.path);\n\t}\n\n\tif(change.value === void 0) {\n\t\tthrow new InvalidPatchOperationError('missing value');\n\t}\n\n\tvar val = clone(change.value);\n\n\t// If pointer refers to whole document, replace whole document\n\tif(pointer.key === void 0) {\n\t\treturn val;\n\t}\n\n\t_add(pointer, val);\n\treturn x;\n}\n\nfunction _add(pointer, value) {\n\tvar target = pointer.target;\n\n\tif(Array.isArray(target)) {\n\t\t// '-' indicates 'append' to array\n\t\tif(pointer.key === '-') {\n\t\t\ttarget.push(value);\n\t\t} else if (pointer.key > target.length) {\n\t\t\tthrow new InvalidPatchOperationError('target of add outside of array bounds')\n\t\t} else {\n\t\t\ttarget.splice(pointer.key, 0, value);\n\t\t}\n\t} else if(isValidObject(target)) {\n\t\ttarget[pointer.key] = value;\n\t} else {\n\t\tthrow new InvalidPatchOperationError('target of add must be an object or array ' + pointer.key);\n\t}\n}\n\nfunction invertAdd(pr, add) {\n\tvar context = add.context;\n\tif(context !== void 0) {\n\t\tcontext = {\n\t\t\tbefore: context.before,\n\t\t\tafter: array.cons(add.value, context.after)\n\t\t}\n\t}\n\tpr.push({ op: 'test', path: add.path, value: add.value, context: context });\n\tpr.push({ op: 'remove', path: add.path, context: context });\n\treturn 1;\n}\n\nfunction commuteAddOrCopy(add, b) {\n\tif(add.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute add,remove -> remove,add for same path');\n\t}\n\n\treturn commutePaths(add, b);\n}\n\n/**\n * Apply a replace operation to x\n * @param {object|array} x\n * @param {object} change replace operation\n */\nfunction applyReplace(x, change, options) {\n\tvar pointer = find(x, change.path, options.findContext, change.context);\n\n\tif(notFound(pointer) || missingValue(pointer)) {\n\t\tthrow new InvalidPatchOperationError('path does not exist ' + change.path);\n\t}\n\n\tif(change.value === void 0) {\n\t\tthrow new InvalidPatchOperationError('missing value');\n\t}\n\n\tvar value = clone(change.value);\n\n\t// If pointer refers to whole document, replace whole document\n\tif(pointer.key === void 0) {\n\t\treturn value;\n\t}\n\n\tvar target = pointer.target;\n\n\tif(Array.isArray(target)) {\n\t\ttarget[parseArrayIndex(pointer.key)] = value;\n\t} else {\n\t\ttarget[pointer.key] = value;\n\t}\n\n\treturn x;\n}\n\nfunction invertReplace(pr, c, i, patch) {\n\tvar prev = patch[i-1];\n\tif(prev === void 0 || prev.op !== 'test' || prev.path !== c.path) {\n\t\tthrow new PatchNotInvertibleError('cannot invert replace w/o test');\n\t}\n\n\tvar context = prev.context;\n\tif(context !== void 0) {\n\t\tcontext = {\n\t\t\tbefore: context.before,\n\t\t\tafter: array.cons(prev.value, array.tail(context.after))\n\t\t}\n\t}\n\n\tpr.push({ op: 'test', path: prev.path, value: c.value });\n\tpr.push({ op: 'replace', path: prev.path, value: prev.value });\n\treturn 2;\n}\n\nfunction commuteReplace(replace, b) {\n\tif(replace.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute replace,remove -> remove,replace for same path');\n\t}\n\n\tif(b.op === 'test' || b.op === 'replace') {\n\t\treturn [b, replace];\n\t}\n\n\treturn commutePaths(replace, b);\n}\n\n/**\n * Apply a remove operation to x\n * @param {object|array} x\n * @param {object} change remove operation\n */\nfunction applyRemove(x, change, options) {\n\tvar pointer = find(x, change.path, options.findContext, change.context);\n\n\t// key must exist for remove\n\tif(notFound(pointer) || pointer.target[pointer.key] === void 0) {\n\t\tthrow new InvalidPatchOperationError('path does not exist ' + change.path);\n\t}\n\n\t_remove(pointer);\n\treturn x;\n}\n\nfunction _remove (pointer) {\n\tvar target = pointer.target;\n\n\tvar removed;\n\tif (Array.isArray(target)) {\n\t\tremoved = target.splice(parseArrayIndex(pointer.key), 1);\n\t\treturn removed[0];\n\n\t} else if (isValidObject(target)) {\n\t\tremoved = target[pointer.key];\n\t\tdelete target[pointer.key];\n\t\treturn removed;\n\n\t} else {\n\t\tthrow new InvalidPatchOperationError('target of remove must be an object or array');\n\t}\n}\n\nfunction invertRemove(pr, c, i, patch) {\n\tvar prev = patch[i-1];\n\tif(prev === void 0 || prev.op !== 'test' || prev.path !== c.path) {\n\t\tthrow new PatchNotInvertibleError('cannot invert remove w/o test');\n\t}\n\n\tvar context = prev.context;\n\tif(context !== void 0) {\n\t\tcontext = {\n\t\t\tbefore: context.before,\n\t\t\tafter: array.tail(context.after)\n\t\t}\n\t}\n\n\tpr.push({ op: 'add', path: prev.path, value: prev.value, context: context });\n\treturn 2;\n}\n\nfunction commuteRemove(remove, b) {\n\tif(remove.path === b.path && b.op === 'remove') {\n\t\treturn [b, remove];\n\t}\n\n\treturn commutePaths(remove, b);\n}\n\n/**\n * Apply a move operation to x\n * @param {object|array} x\n * @param {object} change move operation\n */\nfunction applyMove(x, change, options) {\n\tif(jsonPointer.contains(change.path, change.from)) {\n\t\tthrow new InvalidPatchOperationError('move.from cannot be ancestor of move.path');\n\t}\n\n\tvar pto = find(x, change.path, options.findContext, change.context);\n\tvar pfrom = find(x, change.from, options.findContext, change.fromContext);\n\n\t_add(pto, _remove(pfrom));\n\treturn x;\n}\n\nfunction invertMove(pr, c) {\n\tpr.push({ op: 'move',\n\t\tpath: c.from, context: c.fromContext,\n\t\tfrom: c.path, fromContext: c.context });\n\treturn 1;\n}\n\nfunction commuteMove(move, b) {\n\tif(move.path === b.path && b.op === 'remove') {\n\t\tthrow new TypeError('Can\\'t commute move,remove -> move,replace for same path');\n\t}\n\n\treturn commutePaths(move, b);\n}\n\n/**\n * Apply a copy operation to x\n * @param {object|array} x\n * @param {object} change copy operation\n */\nfunction applyCopy(x, change, options) {\n\tvar pto = find(x, change.path, options.findContext, change.context);\n\tvar pfrom = find(x, change.from, options.findContext, change.fromContext);\n\n\tif(notFound(pfrom) || missingValue(pfrom)) {\n\t\tthrow new InvalidPatchOperationError('copy.from must exist');\n\t}\n\n\tvar target = pfrom.target;\n\tvar value;\n\n\tif(Array.isArray(target)) {\n\t\tvalue = target[parseArrayIndex(pfrom.key)];\n\t} else {\n\t\tvalue = target[pfrom.key];\n\t}\n\n\t_add(pto, clone(value));\n\treturn x;\n}\n\n// NOTE: Copy is not invertible\n// See https://github.com/cujojs/jiff/issues/9\n// This needs more thought. We may have to extend/amend JSON Patch.\n// At first glance, this seems like it should just be a remove.\n// However, that's not correct.  It violates the involution:\n// invert(invert(p)) ~= p.  For example:\n// invert(copy) -> remove\n// invert(remove) -> add\n// thus: invert(invert(copy)) -> add (DOH! this should be copy!)\n\nfunction notInvertible(_, c) {\n\tthrow new PatchNotInvertibleError('cannot invert ' + c.op);\n}\n\nfunction notFound (pointer) {\n\treturn pointer === void 0 || (pointer.target == null && pointer.key !== void 0);\n}\n\nfunction missingValue(pointer) {\n\treturn pointer.key !== void 0 && pointer.target[pointer.key] === void 0;\n}\n\n/**\n * Return true if x is a non-null object\n * @param {*} x\n * @returns {boolean}\n */\nfunction isValidObject (x) {\n\treturn x !== null && typeof x === 'object';\n}\n\n},{\"./InvalidPatchOperationError\":7,\"./PatchNotInvertibleError\":8,\"./TestFailedError\":9,\"./array\":10,\"./clone\":11,\"./commutePaths\":12,\"./deepEquals\":13,\"./jsonPointer\":16}],20:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],21:[function(require,module,exports){\n(function (process){\n// vim:ts=4:sts=4:sw=4:\n/*!\n *\n * Copyright 2009-2017 Kris Kowal under the terms of the MIT\n * license found at https://github.com/kriskowal/q/blob/v1/LICENSE\n *\n * With parts by Tyler Close\n * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found\n * at http://www.opensource.org/licenses/mit-license.html\n * Forked at ref_send.js version: 2009-05-11\n *\n * With parts by Mark Miller\n * Copyright (C) 2011 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\n(function (definition) {\n    \"use strict\";\n\n    // This file will function properly as a <script> tag, or a module\n    // using CommonJS and NodeJS or RequireJS module formats.  In\n    // Common/Node/RequireJS, the module exports the Q API and when\n    // executed as a simple <script>, it creates a Q global instead.\n\n    // Montage Require\n    if (typeof bootstrap === \"function\") {\n        bootstrap(\"promise\", definition);\n\n    // CommonJS\n    } else if (typeof exports === \"object\" && typeof module === \"object\") {\n        module.exports = definition();\n\n    // RequireJS\n    } else if (typeof define === \"function\" && define.amd) {\n        define(definition);\n\n    // SES (Secure EcmaScript)\n    } else if (typeof ses !== \"undefined\") {\n        if (!ses.ok()) {\n            return;\n        } else {\n            ses.makeQ = definition;\n        }\n\n    // <script>\n    } else if (typeof window !== \"undefined\" || typeof self !== \"undefined\") {\n        // Prefer window over self for add-on scripts. Use self for\n        // non-windowed contexts.\n        var global = typeof window !== \"undefined\" ? window : self;\n\n        // Get the `window` object, save the previous Q global\n        // and initialize Q as a global.\n        var previousQ = global.Q;\n        global.Q = definition();\n\n        // Add a noConflict function so Q can be removed from the\n        // global namespace.\n        global.Q.noConflict = function () {\n            global.Q = previousQ;\n            return this;\n        };\n\n    } else {\n        throw new Error(\"This environment was not anticipated by Q. Please file a bug.\");\n    }\n\n})(function () {\n\"use strict\";\n\nvar hasStacks = false;\ntry {\n    throw new Error();\n} catch (e) {\n    hasStacks = !!e.stack;\n}\n\n// All code after this point will be filtered from stack traces reported\n// by Q.\nvar qStartingLine = captureLine();\nvar qFileName;\n\n// shims\n\n// used for fallback in \"allResolved\"\nvar noop = function () {};\n\n// Use the fastest possible means to execute a task in a future turn\n// of the event loop.\nvar nextTick =(function () {\n    // linked list of tasks (single, with head node)\n    var head = {task: void 0, next: null};\n    var tail = head;\n    var flushing = false;\n    var requestTick = void 0;\n    var isNodeJS = false;\n    // queue for late tasks, used by unhandled rejection tracking\n    var laterQueue = [];\n\n    function flush() {\n        /* jshint loopfunc: true */\n        var task, domain;\n\n        while (head.next) {\n            head = head.next;\n            task = head.task;\n            head.task = void 0;\n            domain = head.domain;\n\n            if (domain) {\n                head.domain = void 0;\n                domain.enter();\n            }\n            runSingle(task, domain);\n\n        }\n        while (laterQueue.length) {\n            task = laterQueue.pop();\n            runSingle(task);\n        }\n        flushing = false;\n    }\n    // runs a single function in the async queue\n    function runSingle(task, domain) {\n        try {\n            task();\n\n        } catch (e) {\n            if (isNodeJS) {\n                // In node, uncaught exceptions are considered fatal errors.\n                // Re-throw them synchronously to interrupt flushing!\n\n                // Ensure continuation if the uncaught exception is suppressed\n                // listening \"uncaughtException\" events (as domains does).\n                // Continue in next event to avoid tick recursion.\n                if (domain) {\n                    domain.exit();\n                }\n                setTimeout(flush, 0);\n                if (domain) {\n                    domain.enter();\n                }\n\n                throw e;\n\n            } else {\n                // In browsers, uncaught exceptions are not fatal.\n                // Re-throw them asynchronously to avoid slow-downs.\n                setTimeout(function () {\n                    throw e;\n                }, 0);\n            }\n        }\n\n        if (domain) {\n            domain.exit();\n        }\n    }\n\n    nextTick = function (task) {\n        tail = tail.next = {\n            task: task,\n            domain: isNodeJS && process.domain,\n            next: null\n        };\n\n        if (!flushing) {\n            flushing = true;\n            requestTick();\n        }\n    };\n\n    if (typeof process === \"object\" &&\n        process.toString() === \"[object process]\" && process.nextTick) {\n        // Ensure Q is in a real Node environment, with a `process.nextTick`.\n        // To see through fake Node environments:\n        // * Mocha test runner - exposes a `process` global without a `nextTick`\n        // * Browserify - exposes a `process.nexTick` function that uses\n        //   `setTimeout`. In this case `setImmediate` is preferred because\n        //    it is faster. Browserify's `process.toString()` yields\n        //   \"[object Object]\", while in a real Node environment\n        //   `process.toString()` yields \"[object process]\".\n        isNodeJS = true;\n\n        requestTick = function () {\n            process.nextTick(flush);\n        };\n\n    } else if (typeof setImmediate === \"function\") {\n        // In IE10, Node.js 0.9+, or https://github.com/NobleJS/setImmediate\n        if (typeof window !== \"undefined\") {\n            requestTick = setImmediate.bind(window, flush);\n        } else {\n            requestTick = function () {\n                setImmediate(flush);\n            };\n        }\n\n    } else if (typeof MessageChannel !== \"undefined\") {\n        // modern browsers\n        // http://www.nonblocking.io/2011/06/windownexttick.html\n        var channel = new MessageChannel();\n        // At least Safari Version 6.0.5 (8536.30.1) intermittently cannot create\n        // working message ports the first time a page loads.\n        channel.port1.onmessage = function () {\n            requestTick = requestPortTick;\n            channel.port1.onmessage = flush;\n            flush();\n        };\n        var requestPortTick = function () {\n            // Opera requires us to provide a message payload, regardless of\n            // whether we use it.\n            channel.port2.postMessage(0);\n        };\n        requestTick = function () {\n            setTimeout(flush, 0);\n            requestPortTick();\n        };\n\n    } else {\n        // old browsers\n        requestTick = function () {\n            setTimeout(flush, 0);\n        };\n    }\n    // runs a task after all other tasks have been run\n    // this is useful for unhandled rejection tracking that needs to happen\n    // after all `then`d tasks have been run.\n    nextTick.runAfter = function (task) {\n        laterQueue.push(task);\n        if (!flushing) {\n            flushing = true;\n            requestTick();\n        }\n    };\n    return nextTick;\n})();\n\n// Attempt to make generics safe in the face of downstream\n// modifications.\n// There is no situation where this is necessary.\n// If you need a security guarantee, these primordials need to be\n// deeply frozen anyway, and if you dont need a security guarantee,\n// this is just plain paranoid.\n// However, this **might** have the nice side-effect of reducing the size of\n// the minified code by reducing x.call() to merely x()\n// See Mark Millers explanation of what this does.\n// http://wiki.ecmascript.org/doku.php?id=conventions:safe_meta_programming\nvar call = Function.call;\nfunction uncurryThis(f) {\n    return function () {\n        return call.apply(f, arguments);\n    };\n}\n// This is equivalent, but slower:\n// uncurryThis = Function_bind.bind(Function_bind.call);\n// http://jsperf.com/uncurrythis\n\nvar array_slice = uncurryThis(Array.prototype.slice);\n\nvar array_reduce = uncurryThis(\n    Array.prototype.reduce || function (callback, basis) {\n        var index = 0,\n            length = this.length;\n        // concerning the initial value, if one is not provided\n        if (arguments.length === 1) {\n            // seek to the first value in the array, accounting\n            // for the possibility that is is a sparse array\n            do {\n                if (index in this) {\n                    basis = this[index++];\n                    break;\n                }\n                if (++index >= length) {\n                    throw new TypeError();\n                }\n            } while (1);\n        }\n        // reduce\n        for (; index < length; index++) {\n            // account for the possibility that the array is sparse\n            if (index in this) {\n                basis = callback(basis, this[index], index);\n            }\n        }\n        return basis;\n    }\n);\n\nvar array_indexOf = uncurryThis(\n    Array.prototype.indexOf || function (value) {\n        // not a very good shim, but good enough for our one use of it\n        for (var i = 0; i < this.length; i++) {\n            if (this[i] === value) {\n                return i;\n            }\n        }\n        return -1;\n    }\n);\n\nvar array_map = uncurryThis(\n    Array.prototype.map || function (callback, thisp) {\n        var self = this;\n        var collect = [];\n        array_reduce(self, function (undefined, value, index) {\n            collect.push(callback.call(thisp, value, index, self));\n        }, void 0);\n        return collect;\n    }\n);\n\nvar object_create = Object.create || function (prototype) {\n    function Type() { }\n    Type.prototype = prototype;\n    return new Type();\n};\n\nvar object_defineProperty = Object.defineProperty || function (obj, prop, descriptor) {\n    obj[prop] = descriptor.value;\n    return obj;\n};\n\nvar object_hasOwnProperty = uncurryThis(Object.prototype.hasOwnProperty);\n\nvar object_keys = Object.keys || function (object) {\n    var keys = [];\n    for (var key in object) {\n        if (object_hasOwnProperty(object, key)) {\n            keys.push(key);\n        }\n    }\n    return keys;\n};\n\nvar object_toString = uncurryThis(Object.prototype.toString);\n\nfunction isObject(value) {\n    return value === Object(value);\n}\n\n// generator related shims\n\n// FIXME: Remove this function once ES6 generators are in SpiderMonkey.\nfunction isStopIteration(exception) {\n    return (\n        object_toString(exception) === \"[object StopIteration]\" ||\n        exception instanceof QReturnValue\n    );\n}\n\n// FIXME: Remove this helper and Q.return once ES6 generators are in\n// SpiderMonkey.\nvar QReturnValue;\nif (typeof ReturnValue !== \"undefined\") {\n    QReturnValue = ReturnValue;\n} else {\n    QReturnValue = function (value) {\n        this.value = value;\n    };\n}\n\n// long stack traces\n\nvar STACK_JUMP_SEPARATOR = \"From previous event:\";\n\nfunction makeStackTraceLong(error, promise) {\n    // If possible, transform the error stack trace by removing Node and Q\n    // cruft, then concatenating with the stack trace of `promise`. See #57.\n    if (hasStacks &&\n        promise.stack &&\n        typeof error === \"object\" &&\n        error !== null &&\n        error.stack\n    ) {\n        var stacks = [];\n        for (var p = promise; !!p; p = p.source) {\n            if (p.stack && (!error.__minimumStackCounter__ || error.__minimumStackCounter__ > p.stackCounter)) {\n                object_defineProperty(error, \"__minimumStackCounter__\", {value: p.stackCounter, configurable: true});\n                stacks.unshift(p.stack);\n            }\n        }\n        stacks.unshift(error.stack);\n\n        var concatedStacks = stacks.join(\"\\n\" + STACK_JUMP_SEPARATOR + \"\\n\");\n        var stack = filterStackString(concatedStacks);\n        object_defineProperty(error, \"stack\", {value: stack, configurable: true});\n    }\n}\n\nfunction filterStackString(stackString) {\n    var lines = stackString.split(\"\\n\");\n    var desiredLines = [];\n    for (var i = 0; i < lines.length; ++i) {\n        var line = lines[i];\n\n        if (!isInternalFrame(line) && !isNodeFrame(line) && line) {\n            desiredLines.push(line);\n        }\n    }\n    return desiredLines.join(\"\\n\");\n}\n\nfunction isNodeFrame(stackLine) {\n    return stackLine.indexOf(\"(module.js:\") !== -1 ||\n           stackLine.indexOf(\"(node.js:\") !== -1;\n}\n\nfunction getFileNameAndLineNumber(stackLine) {\n    // Named functions: \"at functionName (filename:lineNumber:columnNumber)\"\n    // In IE10 function name can have spaces (\"Anonymous function\") O_o\n    var attempt1 = /at .+ \\((.+):(\\d+):(?:\\d+)\\)$/.exec(stackLine);\n    if (attempt1) {\n        return [attempt1[1], Number(attempt1[2])];\n    }\n\n    // Anonymous functions: \"at filename:lineNumber:columnNumber\"\n    var attempt2 = /at ([^ ]+):(\\d+):(?:\\d+)$/.exec(stackLine);\n    if (attempt2) {\n        return [attempt2[1], Number(attempt2[2])];\n    }\n\n    // Firefox style: \"function@filename:lineNumber or @filename:lineNumber\"\n    var attempt3 = /.*@(.+):(\\d+)$/.exec(stackLine);\n    if (attempt3) {\n        return [attempt3[1], Number(attempt3[2])];\n    }\n}\n\nfunction isInternalFrame(stackLine) {\n    var fileNameAndLineNumber = getFileNameAndLineNumber(stackLine);\n\n    if (!fileNameAndLineNumber) {\n        return false;\n    }\n\n    var fileName = fileNameAndLineNumber[0];\n    var lineNumber = fileNameAndLineNumber[1];\n\n    return fileName === qFileName &&\n        lineNumber >= qStartingLine &&\n        lineNumber <= qEndingLine;\n}\n\n// discover own file name and line number range for filtering stack\n// traces\nfunction captureLine() {\n    if (!hasStacks) {\n        return;\n    }\n\n    try {\n        throw new Error();\n    } catch (e) {\n        var lines = e.stack.split(\"\\n\");\n        var firstLine = lines[0].indexOf(\"@\") > 0 ? lines[1] : lines[2];\n        var fileNameAndLineNumber = getFileNameAndLineNumber(firstLine);\n        if (!fileNameAndLineNumber) {\n            return;\n        }\n\n        qFileName = fileNameAndLineNumber[0];\n        return fileNameAndLineNumber[1];\n    }\n}\n\nfunction deprecate(callback, name, alternative) {\n    return function () {\n        if (typeof console !== \"undefined\" &&\n            typeof console.warn === \"function\") {\n            console.warn(name + \" is deprecated, use \" + alternative +\n                         \" instead.\", new Error(\"\").stack);\n        }\n        return callback.apply(callback, arguments);\n    };\n}\n\n// end of shims\n// beginning of real work\n\n/**\n * Constructs a promise for an immediate reference, passes promises through, or\n * coerces promises from different systems.\n * @param value immediate reference or promise\n */\nfunction Q(value) {\n    // If the object is already a Promise, return it directly.  This enables\n    // the resolve function to both be used to created references from objects,\n    // but to tolerably coerce non-promises to promises.\n    if (value instanceof Promise) {\n        return value;\n    }\n\n    // assimilate thenables\n    if (isPromiseAlike(value)) {\n        return coerce(value);\n    } else {\n        return fulfill(value);\n    }\n}\nQ.resolve = Q;\n\n/**\n * Performs a task in a future turn of the event loop.\n * @param {Function} task\n */\nQ.nextTick = nextTick;\n\n/**\n * Controls whether or not long stack traces will be on\n */\nQ.longStackSupport = false;\n\n/**\n * The counter is used to determine the stopping point for building\n * long stack traces. In makeStackTraceLong we walk backwards through\n * the linked list of promises, only stacks which were created before\n * the rejection are concatenated.\n */\nvar longStackCounter = 1;\n\n// enable long stacks if Q_DEBUG is set\nif (typeof process === \"object\" && process && process.env && process.env.Q_DEBUG) {\n    Q.longStackSupport = true;\n}\n\n/**\n * Constructs a {promise, resolve, reject} object.\n *\n * `resolve` is a callback to invoke with a more resolved value for the\n * promise. To fulfill the promise, invoke `resolve` with any value that is\n * not a thenable. To reject the promise, invoke `resolve` with a rejected\n * thenable, or invoke `reject` with the reason directly. To resolve the\n * promise to another thenable, thus putting it in the same state, invoke\n * `resolve` with that other thenable.\n */\nQ.defer = defer;\nfunction defer() {\n    // if \"messages\" is an \"Array\", that indicates that the promise has not yet\n    // been resolved.  If it is \"undefined\", it has been resolved.  Each\n    // element of the messages array is itself an array of complete arguments to\n    // forward to the resolved promise.  We coerce the resolution value to a\n    // promise using the `resolve` function because it handles both fully\n    // non-thenable values and other thenables gracefully.\n    var messages = [], progressListeners = [], resolvedPromise;\n\n    var deferred = object_create(defer.prototype);\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, operands) {\n        var args = array_slice(arguments);\n        if (messages) {\n            messages.push(args);\n            if (op === \"when\" && operands[1]) { // progress operand\n                progressListeners.push(operands[1]);\n            }\n        } else {\n            Q.nextTick(function () {\n                resolvedPromise.promiseDispatch.apply(resolvedPromise, args);\n            });\n        }\n    };\n\n    // XXX deprecated\n    promise.valueOf = function () {\n        if (messages) {\n            return promise;\n        }\n        var nearerValue = nearer(resolvedPromise);\n        if (isPromise(nearerValue)) {\n            resolvedPromise = nearerValue; // shorten chain\n        }\n        return nearerValue;\n    };\n\n    promise.inspect = function () {\n        if (!resolvedPromise) {\n            return { state: \"pending\" };\n        }\n        return resolvedPromise.inspect();\n    };\n\n    if (Q.longStackSupport && hasStacks) {\n        try {\n            throw new Error();\n        } catch (e) {\n            // NOTE: don't try to use `Error.captureStackTrace` or transfer the\n            // accessor around; that causes memory leaks as per GH-111. Just\n            // reify the stack trace as a string ASAP.\n            //\n            // At the same time, cut off the first line; it's always just\n            // \"[object Promise]\\n\", as per the `toString`.\n            promise.stack = e.stack.substring(e.stack.indexOf(\"\\n\") + 1);\n            promise.stackCounter = longStackCounter++;\n        }\n    }\n\n    // NOTE: we do the checks for `resolvedPromise` in each method, instead of\n    // consolidating them into `become`, since otherwise we'd create new\n    // promises with the lines `become(whatever(value))`. See e.g. GH-252.\n\n    function become(newPromise) {\n        resolvedPromise = newPromise;\n\n        if (Q.longStackSupport && hasStacks) {\n            // Only hold a reference to the new promise if long stacks\n            // are enabled to reduce memory usage\n            promise.source = newPromise;\n        }\n\n        array_reduce(messages, function (undefined, message) {\n            Q.nextTick(function () {\n                newPromise.promiseDispatch.apply(newPromise, message);\n            });\n        }, void 0);\n\n        messages = void 0;\n        progressListeners = void 0;\n    }\n\n    deferred.promise = promise;\n    deferred.resolve = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(Q(value));\n    };\n\n    deferred.fulfill = function (value) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(fulfill(value));\n    };\n    deferred.reject = function (reason) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        become(reject(reason));\n    };\n    deferred.notify = function (progress) {\n        if (resolvedPromise) {\n            return;\n        }\n\n        array_reduce(progressListeners, function (undefined, progressListener) {\n            Q.nextTick(function () {\n                progressListener(progress);\n            });\n        }, void 0);\n    };\n\n    return deferred;\n}\n\n/**\n * Creates a Node-style callback that will resolve or reject the deferred\n * promise.\n * @returns a nodeback\n */\ndefer.prototype.makeNodeResolver = function () {\n    var self = this;\n    return function (error, value) {\n        if (error) {\n            self.reject(error);\n        } else if (arguments.length > 2) {\n            self.resolve(array_slice(arguments, 1));\n        } else {\n            self.resolve(value);\n        }\n    };\n};\n\n/**\n * @param resolver {Function} a function that returns nothing and accepts\n * the resolve, reject, and notify functions for a deferred.\n * @returns a promise that may be resolved with the given resolve and reject\n * functions, or rejected by a thrown exception in resolver\n */\nQ.Promise = promise; // ES6\nQ.promise = promise;\nfunction promise(resolver) {\n    if (typeof resolver !== \"function\") {\n        throw new TypeError(\"resolver must be a function.\");\n    }\n    var deferred = defer();\n    try {\n        resolver(deferred.resolve, deferred.reject, deferred.notify);\n    } catch (reason) {\n        deferred.reject(reason);\n    }\n    return deferred.promise;\n}\n\npromise.race = race; // ES6\npromise.all = all; // ES6\npromise.reject = reject; // ES6\npromise.resolve = Q; // ES6\n\n// XXX experimental.  This method is a way to denote that a local value is\n// serializable and should be immediately dispatched to a remote upon request,\n// instead of passing a reference.\nQ.passByCopy = function (object) {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return object;\n};\n\nPromise.prototype.passByCopy = function () {\n    //freeze(object);\n    //passByCopies.set(object, true);\n    return this;\n};\n\n/**\n * If two promises eventually fulfill to the same value, promises that value,\n * but otherwise rejects.\n * @param x {Any*}\n * @param y {Any*}\n * @returns {Any*} a promise for x and y if they are the same, but a rejection\n * otherwise.\n *\n */\nQ.join = function (x, y) {\n    return Q(x).join(y);\n};\n\nPromise.prototype.join = function (that) {\n    return Q([this, that]).spread(function (x, y) {\n        if (x === y) {\n            // TODO: \"===\" should be Object.is or equiv\n            return x;\n        } else {\n            throw new Error(\"Q can't join: not the same: \" + x + \" \" + y);\n        }\n    });\n};\n\n/**\n * Returns a promise for the first of an array of promises to become settled.\n * @param answers {Array[Any*]} promises to race\n * @returns {Any*} the first promise to be settled\n */\nQ.race = race;\nfunction race(answerPs) {\n    return promise(function (resolve, reject) {\n        // Switch to this once we can assume at least ES5\n        // answerPs.forEach(function (answerP) {\n        //     Q(answerP).then(resolve, reject);\n        // });\n        // Use this in the meantime\n        for (var i = 0, len = answerPs.length; i < len; i++) {\n            Q(answerPs[i]).then(resolve, reject);\n        }\n    });\n}\n\nPromise.prototype.race = function () {\n    return this.then(Q.race);\n};\n\n/**\n * Constructs a Promise with a promise descriptor object and optional fallback\n * function.  The descriptor contains methods like when(rejected), get(name),\n * set(name, value), post(name, args), and delete(name), which all\n * return either a value, a promise for a value, or a rejection.  The fallback\n * accepts the operation name, a resolver, and any further arguments that would\n * have been forwarded to the appropriate method above had a method been\n * provided with the proper name.  The API makes no guarantees about the nature\n * of the returned object, apart from that it is usable whereever promises are\n * bought and sold.\n */\nQ.makePromise = Promise;\nfunction Promise(descriptor, fallback, inspect) {\n    if (fallback === void 0) {\n        fallback = function (op) {\n            return reject(new Error(\n                \"Promise does not support operation: \" + op\n            ));\n        };\n    }\n    if (inspect === void 0) {\n        inspect = function () {\n            return {state: \"unknown\"};\n        };\n    }\n\n    var promise = object_create(Promise.prototype);\n\n    promise.promiseDispatch = function (resolve, op, args) {\n        var result;\n        try {\n            if (descriptor[op]) {\n                result = descriptor[op].apply(promise, args);\n            } else {\n                result = fallback.call(promise, op, args);\n            }\n        } catch (exception) {\n            result = reject(exception);\n        }\n        if (resolve) {\n            resolve(result);\n        }\n    };\n\n    promise.inspect = inspect;\n\n    // XXX deprecated `valueOf` and `exception` support\n    if (inspect) {\n        var inspected = inspect();\n        if (inspected.state === \"rejected\") {\n            promise.exception = inspected.reason;\n        }\n\n        promise.valueOf = function () {\n            var inspected = inspect();\n            if (inspected.state === \"pending\" ||\n                inspected.state === \"rejected\") {\n                return promise;\n            }\n            return inspected.value;\n        };\n    }\n\n    return promise;\n}\n\nPromise.prototype.toString = function () {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.then = function (fulfilled, rejected, progressed) {\n    var self = this;\n    var deferred = defer();\n    var done = false;   // ensure the untrusted promise makes at most a\n                        // single call to one of the callbacks\n\n    function _fulfilled(value) {\n        try {\n            return typeof fulfilled === \"function\" ? fulfilled(value) : value;\n        } catch (exception) {\n            return reject(exception);\n        }\n    }\n\n    function _rejected(exception) {\n        if (typeof rejected === \"function\") {\n            makeStackTraceLong(exception, self);\n            try {\n                return rejected(exception);\n            } catch (newException) {\n                return reject(newException);\n            }\n        }\n        return reject(exception);\n    }\n\n    function _progressed(value) {\n        return typeof progressed === \"function\" ? progressed(value) : value;\n    }\n\n    Q.nextTick(function () {\n        self.promiseDispatch(function (value) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_fulfilled(value));\n        }, \"when\", [function (exception) {\n            if (done) {\n                return;\n            }\n            done = true;\n\n            deferred.resolve(_rejected(exception));\n        }]);\n    });\n\n    // Progress propagator need to be attached in the current tick.\n    self.promiseDispatch(void 0, \"when\", [void 0, function (value) {\n        var newValue;\n        var threw = false;\n        try {\n            newValue = _progressed(value);\n        } catch (e) {\n            threw = true;\n            if (Q.onerror) {\n                Q.onerror(e);\n            } else {\n                throw e;\n            }\n        }\n\n        if (!threw) {\n            deferred.notify(newValue);\n        }\n    }]);\n\n    return deferred.promise;\n};\n\nQ.tap = function (promise, callback) {\n    return Q(promise).tap(callback);\n};\n\n/**\n * Works almost like \"finally\", but not called for rejections.\n * Original resolution value is passed through callback unaffected.\n * Callback may return a promise that will be awaited for.\n * @param {Function} callback\n * @returns {Q.Promise}\n * @example\n * doSomething()\n *   .then(...)\n *   .tap(console.log)\n *   .then(...);\n */\nPromise.prototype.tap = function (callback) {\n    callback = Q(callback);\n\n    return this.then(function (value) {\n        return callback.fcall(value).thenResolve(value);\n    });\n};\n\n/**\n * Registers an observer on a promise.\n *\n * Guarantees:\n *\n * 1. that fulfilled and rejected will be called only once.\n * 2. that either the fulfilled callback or the rejected callback will be\n *    called, but not both.\n * 3. that fulfilled and rejected will not be called in this turn.\n *\n * @param value      promise or immediate reference to observe\n * @param fulfilled  function to be called with the fulfilled value\n * @param rejected   function to be called with the rejection exception\n * @param progressed function to be called on any progress notifications\n * @return promise for the return value from the invoked callback\n */\nQ.when = when;\nfunction when(value, fulfilled, rejected, progressed) {\n    return Q(value).then(fulfilled, rejected, progressed);\n}\n\nPromise.prototype.thenResolve = function (value) {\n    return this.then(function () { return value; });\n};\n\nQ.thenResolve = function (promise, value) {\n    return Q(promise).thenResolve(value);\n};\n\nPromise.prototype.thenReject = function (reason) {\n    return this.then(function () { throw reason; });\n};\n\nQ.thenReject = function (promise, reason) {\n    return Q(promise).thenReject(reason);\n};\n\n/**\n * If an object is not a promise, it is as \"near\" as possible.\n * If a promise is rejected, it is as \"near\" as possible too.\n * If its a fulfilled promise, the fulfillment value is nearer.\n * If its a deferred promise and the deferred has been resolved, the\n * resolution is \"nearer\".\n * @param object\n * @returns most resolved (nearest) form of the object\n */\n\n// XXX should we re-do this?\nQ.nearer = nearer;\nfunction nearer(value) {\n    if (isPromise(value)) {\n        var inspected = value.inspect();\n        if (inspected.state === \"fulfilled\") {\n            return inspected.value;\n        }\n    }\n    return value;\n}\n\n/**\n * @returns whether the given object is a promise.\n * Otherwise it is a fulfilled value.\n */\nQ.isPromise = isPromise;\nfunction isPromise(object) {\n    return object instanceof Promise;\n}\n\nQ.isPromiseAlike = isPromiseAlike;\nfunction isPromiseAlike(object) {\n    return isObject(object) && typeof object.then === \"function\";\n}\n\n/**\n * @returns whether the given object is a pending promise, meaning not\n * fulfilled or rejected.\n */\nQ.isPending = isPending;\nfunction isPending(object) {\n    return isPromise(object) && object.inspect().state === \"pending\";\n}\n\nPromise.prototype.isPending = function () {\n    return this.inspect().state === \"pending\";\n};\n\n/**\n * @returns whether the given object is a value or fulfilled\n * promise.\n */\nQ.isFulfilled = isFulfilled;\nfunction isFulfilled(object) {\n    return !isPromise(object) || object.inspect().state === \"fulfilled\";\n}\n\nPromise.prototype.isFulfilled = function () {\n    return this.inspect().state === \"fulfilled\";\n};\n\n/**\n * @returns whether the given object is a rejected promise.\n */\nQ.isRejected = isRejected;\nfunction isRejected(object) {\n    return isPromise(object) && object.inspect().state === \"rejected\";\n}\n\nPromise.prototype.isRejected = function () {\n    return this.inspect().state === \"rejected\";\n};\n\n//// BEGIN UNHANDLED REJECTION TRACKING\n\n// This promise library consumes exceptions thrown in handlers so they can be\n// handled by a subsequent promise.  The exceptions get added to this array when\n// they are created, and removed when they are handled.  Note that in ES6 or\n// shimmed environments, this would naturally be a `Set`.\nvar unhandledReasons = [];\nvar unhandledRejections = [];\nvar reportedUnhandledRejections = [];\nvar trackUnhandledRejections = true;\n\nfunction resetUnhandledRejections() {\n    unhandledReasons.length = 0;\n    unhandledRejections.length = 0;\n\n    if (!trackUnhandledRejections) {\n        trackUnhandledRejections = true;\n    }\n}\n\nfunction trackRejection(promise, reason) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n    if (typeof process === \"object\" && typeof process.emit === \"function\") {\n        Q.nextTick.runAfter(function () {\n            if (array_indexOf(unhandledRejections, promise) !== -1) {\n                process.emit(\"unhandledRejection\", reason, promise);\n                reportedUnhandledRejections.push(promise);\n            }\n        });\n    }\n\n    unhandledRejections.push(promise);\n    if (reason && typeof reason.stack !== \"undefined\") {\n        unhandledReasons.push(reason.stack);\n    } else {\n        unhandledReasons.push(\"(no stack) \" + reason);\n    }\n}\n\nfunction untrackRejection(promise) {\n    if (!trackUnhandledRejections) {\n        return;\n    }\n\n    var at = array_indexOf(unhandledRejections, promise);\n    if (at !== -1) {\n        if (typeof process === \"object\" && typeof process.emit === \"function\") {\n            Q.nextTick.runAfter(function () {\n                var atReport = array_indexOf(reportedUnhandledRejections, promise);\n                if (atReport !== -1) {\n                    process.emit(\"rejectionHandled\", unhandledReasons[at], promise);\n                    reportedUnhandledRejections.splice(atReport, 1);\n                }\n            });\n        }\n        unhandledRejections.splice(at, 1);\n        unhandledReasons.splice(at, 1);\n    }\n}\n\nQ.resetUnhandledRejections = resetUnhandledRejections;\n\nQ.getUnhandledReasons = function () {\n    // Make a copy so that consumers can't interfere with our internal state.\n    return unhandledReasons.slice();\n};\n\nQ.stopUnhandledRejectionTracking = function () {\n    resetUnhandledRejections();\n    trackUnhandledRejections = false;\n};\n\nresetUnhandledRejections();\n\n//// END UNHANDLED REJECTION TRACKING\n\n/**\n * Constructs a rejected promise.\n * @param reason value describing the failure\n */\nQ.reject = reject;\nfunction reject(reason) {\n    var rejection = Promise({\n        \"when\": function (rejected) {\n            // note that the error has been handled\n            if (rejected) {\n                untrackRejection(this);\n            }\n            return rejected ? rejected(reason) : this;\n        }\n    }, function fallback() {\n        return this;\n    }, function inspect() {\n        return { state: \"rejected\", reason: reason };\n    });\n\n    // Note that the reason has not been handled.\n    trackRejection(rejection, reason);\n\n    return rejection;\n}\n\n/**\n * Constructs a fulfilled promise for an immediate reference.\n * @param value immediate reference\n */\nQ.fulfill = fulfill;\nfunction fulfill(value) {\n    return Promise({\n        \"when\": function () {\n            return value;\n        },\n        \"get\": function (name) {\n            return value[name];\n        },\n        \"set\": function (name, rhs) {\n            value[name] = rhs;\n        },\n        \"delete\": function (name) {\n            delete value[name];\n        },\n        \"post\": function (name, args) {\n            // Mark Miller proposes that post with no name should apply a\n            // promised function.\n            if (name === null || name === void 0) {\n                return value.apply(void 0, args);\n            } else {\n                return value[name].apply(value, args);\n            }\n        },\n        \"apply\": function (thisp, args) {\n            return value.apply(thisp, args);\n        },\n        \"keys\": function () {\n            return object_keys(value);\n        }\n    }, void 0, function inspect() {\n        return { state: \"fulfilled\", value: value };\n    });\n}\n\n/**\n * Converts thenables to Q promises.\n * @param promise thenable promise\n * @returns a Q promise\n */\nfunction coerce(promise) {\n    var deferred = defer();\n    Q.nextTick(function () {\n        try {\n            promise.then(deferred.resolve, deferred.reject, deferred.notify);\n        } catch (exception) {\n            deferred.reject(exception);\n        }\n    });\n    return deferred.promise;\n}\n\n/**\n * Annotates an object such that it will never be\n * transferred away from this process over any promise\n * communication channel.\n * @param object\n * @returns promise a wrapping of that object that\n * additionally responds to the \"isDef\" message\n * without a rejection.\n */\nQ.master = master;\nfunction master(object) {\n    return Promise({\n        \"isDef\": function () {}\n    }, function fallback(op, args) {\n        return dispatch(object, op, args);\n    }, function () {\n        return Q(object).inspect();\n    });\n}\n\n/**\n * Spreads the values of a promised array of arguments into the\n * fulfillment callback.\n * @param fulfilled callback that receives variadic arguments from the\n * promised array\n * @param rejected callback that receives the exception if the promise\n * is rejected.\n * @returns a promise for the return value or thrown exception of\n * either callback.\n */\nQ.spread = spread;\nfunction spread(value, fulfilled, rejected) {\n    return Q(value).spread(fulfilled, rejected);\n}\n\nPromise.prototype.spread = function (fulfilled, rejected) {\n    return this.all().then(function (array) {\n        return fulfilled.apply(void 0, array);\n    }, rejected);\n};\n\n/**\n * The async function is a decorator for generator functions, turning\n * them into asynchronous generators.  Although generators are only part\n * of the newest ECMAScript 6 drafts, this code does not cause syntax\n * errors in older engines.  This code should continue to work and will\n * in fact improve over time as the language improves.\n *\n * ES6 generators are currently part of V8 version 3.19 with the\n * --harmony-generators runtime flag enabled.  SpiderMonkey has had them\n * for longer, but under an older Python-inspired form.  This function\n * works on both kinds of generators.\n *\n * Decorates a generator function such that:\n *  - it may yield promises\n *  - execution will continue when that promise is fulfilled\n *  - the value of the yield expression will be the fulfilled value\n *  - it returns a promise for the return value (when the generator\n *    stops iterating)\n *  - the decorated function returns a promise for the return value\n *    of the generator or the first rejected promise among those\n *    yielded.\n *  - if an error is thrown in the generator, it propagates through\n *    every following yield until it is caught, or until it escapes\n *    the generator function altogether, and is translated into a\n *    rejection for the promise returned by the decorated generator.\n */\nQ.async = async;\nfunction async(makeGenerator) {\n    return function () {\n        // when verb is \"send\", arg is a value\n        // when verb is \"throw\", arg is an exception\n        function continuer(verb, arg) {\n            var result;\n\n            // Until V8 3.19 / Chromium 29 is released, SpiderMonkey is the only\n            // engine that has a deployed base of browsers that support generators.\n            // However, SM's generators use the Python-inspired semantics of\n            // outdated ES6 drafts.  We would like to support ES6, but we'd also\n            // like to make it possible to use generators in deployed browsers, so\n            // we also support Python-style generators.  At some point we can remove\n            // this block.\n\n            if (typeof StopIteration === \"undefined\") {\n                // ES6 Generators\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    return reject(exception);\n                }\n                if (result.done) {\n                    return Q(result.value);\n                } else {\n                    return when(result.value, callback, errback);\n                }\n            } else {\n                // SpiderMonkey Generators\n                // FIXME: Remove this case when SM does ES6 generators.\n                try {\n                    result = generator[verb](arg);\n                } catch (exception) {\n                    if (isStopIteration(exception)) {\n                        return Q(exception.value);\n                    } else {\n                        return reject(exception);\n                    }\n                }\n                return when(result, callback, errback);\n            }\n        }\n        var generator = makeGenerator.apply(this, arguments);\n        var callback = continuer.bind(continuer, \"next\");\n        var errback = continuer.bind(continuer, \"throw\");\n        return callback();\n    };\n}\n\n/**\n * The spawn function is a small wrapper around async that immediately\n * calls the generator and also ends the promise chain, so that any\n * unhandled errors are thrown instead of forwarded to the error\n * handler. This is useful because it's extremely common to run\n * generators at the top-level to work with libraries.\n */\nQ.spawn = spawn;\nfunction spawn(makeGenerator) {\n    Q.done(Q.async(makeGenerator)());\n}\n\n// FIXME: Remove this interface once ES6 generators are in SpiderMonkey.\n/**\n * Throws a ReturnValue exception to stop an asynchronous generator.\n *\n * This interface is a stop-gap measure to support generator return\n * values in older Firefox/SpiderMonkey.  In browsers that support ES6\n * generators like Chromium 29, just use \"return\" in your generator\n * functions.\n *\n * @param value the return value for the surrounding generator\n * @throws ReturnValue exception with the value.\n * @example\n * // ES6 style\n * Q.async(function* () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      return foo + bar;\n * })\n * // Older SpiderMonkey style\n * Q.async(function () {\n *      var foo = yield getFooPromise();\n *      var bar = yield getBarPromise();\n *      Q.return(foo + bar);\n * })\n */\nQ[\"return\"] = _return;\nfunction _return(value) {\n    throw new QReturnValue(value);\n}\n\n/**\n * The promised function decorator ensures that any promise arguments\n * are settled and passed as values (`this` is also settled and passed\n * as a value).  It will also ensure that the result of a function is\n * always a promise.\n *\n * @example\n * var add = Q.promised(function (a, b) {\n *     return a + b;\n * });\n * add(Q(a), Q(B));\n *\n * @param {function} callback The function to decorate\n * @returns {function} a function that has been decorated.\n */\nQ.promised = promised;\nfunction promised(callback) {\n    return function () {\n        return spread([this, all(arguments)], function (self, args) {\n            return callback.apply(self, args);\n        });\n    };\n}\n\n/**\n * sends a message to a value in a future turn\n * @param object* the recipient\n * @param op the name of the message operation, e.g., \"when\",\n * @param args further arguments to be forwarded to the operation\n * @returns result {Promise} a promise for the result of the operation\n */\nQ.dispatch = dispatch;\nfunction dispatch(object, op, args) {\n    return Q(object).dispatch(op, args);\n}\n\nPromise.prototype.dispatch = function (op, args) {\n    var self = this;\n    var deferred = defer();\n    Q.nextTick(function () {\n        self.promiseDispatch(deferred.resolve, op, args);\n    });\n    return deferred.promise;\n};\n\n/**\n * Gets the value of a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to get\n * @return promise for the property value\n */\nQ.get = function (object, key) {\n    return Q(object).dispatch(\"get\", [key]);\n};\n\nPromise.prototype.get = function (key) {\n    return this.dispatch(\"get\", [key]);\n};\n\n/**\n * Sets the value of a property in a future turn.\n * @param object    promise or immediate reference for object object\n * @param name      name of property to set\n * @param value     new value of property\n * @return promise for the return value\n */\nQ.set = function (object, key, value) {\n    return Q(object).dispatch(\"set\", [key, value]);\n};\n\nPromise.prototype.set = function (key, value) {\n    return this.dispatch(\"set\", [key, value]);\n};\n\n/**\n * Deletes a property in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of property to delete\n * @return promise for the return value\n */\nQ.del = // XXX legacy\nQ[\"delete\"] = function (object, key) {\n    return Q(object).dispatch(\"delete\", [key]);\n};\n\nPromise.prototype.del = // XXX legacy\nPromise.prototype[\"delete\"] = function (key) {\n    return this.dispatch(\"delete\", [key]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param value     a value to post, typically an array of\n *                  invocation arguments for promises that\n *                  are ultimately backed with `resolve` values,\n *                  as opposed to those backed with URLs\n *                  wherein the posted value can be any\n *                  JSON serializable object.\n * @return promise for the return value\n */\n// bound locally because it is used by other methods\nQ.mapply = // XXX As proposed by \"Redsandro\"\nQ.post = function (object, name, args) {\n    return Q(object).dispatch(\"post\", [name, args]);\n};\n\nPromise.prototype.mapply = // XXX As proposed by \"Redsandro\"\nPromise.prototype.post = function (name, args) {\n    return this.dispatch(\"post\", [name, args]);\n};\n\n/**\n * Invokes a method in a future turn.\n * @param object    promise or immediate reference for target object\n * @param name      name of method to invoke\n * @param ...args   array of invocation arguments\n * @return promise for the return value\n */\nQ.send = // XXX Mark Miller's proposed parlance\nQ.mcall = // XXX As proposed by \"Redsandro\"\nQ.invoke = function (object, name /*...args*/) {\n    return Q(object).dispatch(\"post\", [name, array_slice(arguments, 2)]);\n};\n\nPromise.prototype.send = // XXX Mark Miller's proposed parlance\nPromise.prototype.mcall = // XXX As proposed by \"Redsandro\"\nPromise.prototype.invoke = function (name /*...args*/) {\n    return this.dispatch(\"post\", [name, array_slice(arguments, 1)]);\n};\n\n/**\n * Applies the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param args      array of application arguments\n */\nQ.fapply = function (object, args) {\n    return Q(object).dispatch(\"apply\", [void 0, args]);\n};\n\nPromise.prototype.fapply = function (args) {\n    return this.dispatch(\"apply\", [void 0, args]);\n};\n\n/**\n * Calls the promised function in a future turn.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ[\"try\"] =\nQ.fcall = function (object /* ...args*/) {\n    return Q(object).dispatch(\"apply\", [void 0, array_slice(arguments, 1)]);\n};\n\nPromise.prototype.fcall = function (/*...args*/) {\n    return this.dispatch(\"apply\", [void 0, array_slice(arguments)]);\n};\n\n/**\n * Binds the promised function, transforming return values into a fulfilled\n * promise and thrown errors into a rejected one.\n * @param object    promise or immediate reference for target function\n * @param ...args   array of application arguments\n */\nQ.fbind = function (object /*...args*/) {\n    var promise = Q(object);\n    var args = array_slice(arguments, 1);\n    return function fbound() {\n        return promise.dispatch(\"apply\", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\nPromise.prototype.fbind = function (/*...args*/) {\n    var promise = this;\n    var args = array_slice(arguments);\n    return function fbound() {\n        return promise.dispatch(\"apply\", [\n            this,\n            args.concat(array_slice(arguments))\n        ]);\n    };\n};\n\n/**\n * Requests the names of the owned properties of a promised\n * object in a future turn.\n * @param object    promise or immediate reference for target object\n * @return promise for the keys of the eventually settled object\n */\nQ.keys = function (object) {\n    return Q(object).dispatch(\"keys\", []);\n};\n\nPromise.prototype.keys = function () {\n    return this.dispatch(\"keys\", []);\n};\n\n/**\n * Turns an array of promises into a promise for an array.  If any of\n * the promises gets rejected, the whole array is rejected immediately.\n * @param {Array*} an array (or promise for an array) of values (or\n * promises for values)\n * @returns a promise for an array of the corresponding values\n */\n// By Mark Miller\n// http://wiki.ecmascript.org/doku.php?id=strawman:concurrency&rev=1308776521#allfulfilled\nQ.all = all;\nfunction all(promises) {\n    return when(promises, function (promises) {\n        var pendingCount = 0;\n        var deferred = defer();\n        array_reduce(promises, function (undefined, promise, index) {\n            var snapshot;\n            if (\n                isPromise(promise) &&\n                (snapshot = promise.inspect()).state === \"fulfilled\"\n            ) {\n                promises[index] = snapshot.value;\n            } else {\n                ++pendingCount;\n                when(\n                    promise,\n                    function (value) {\n                        promises[index] = value;\n                        if (--pendingCount === 0) {\n                            deferred.resolve(promises);\n                        }\n                    },\n                    deferred.reject,\n                    function (progress) {\n                        deferred.notify({ index: index, value: progress });\n                    }\n                );\n            }\n        }, void 0);\n        if (pendingCount === 0) {\n            deferred.resolve(promises);\n        }\n        return deferred.promise;\n    });\n}\n\nPromise.prototype.all = function () {\n    return all(this);\n};\n\n/**\n * Returns the first resolved promise of an array. Prior rejected promises are\n * ignored.  Rejects only if all promises are rejected.\n * @param {Array*} an array containing values or promises for values\n * @returns a promise fulfilled with the value of the first resolved promise,\n * or a rejected promise if all promises are rejected.\n */\nQ.any = any;\n\nfunction any(promises) {\n    if (promises.length === 0) {\n        return Q.resolve();\n    }\n\n    var deferred = Q.defer();\n    var pendingCount = 0;\n    array_reduce(promises, function (prev, current, index) {\n        var promise = promises[index];\n\n        pendingCount++;\n\n        when(promise, onFulfilled, onRejected, onProgress);\n        function onFulfilled(result) {\n            deferred.resolve(result);\n        }\n        function onRejected(err) {\n            pendingCount--;\n            if (pendingCount === 0) {\n                err.message = (\"Q can't get fulfillment value from any promise, all \" +\n                    \"promises were rejected. Last error message: \" + err.message);\n                deferred.reject(err);\n            }\n        }\n        function onProgress(progress) {\n            deferred.notify({\n                index: index,\n                value: progress\n            });\n        }\n    }, undefined);\n\n    return deferred.promise;\n}\n\nPromise.prototype.any = function () {\n    return any(this);\n};\n\n/**\n * Waits for all promises to be settled, either fulfilled or\n * rejected.  This is distinct from `all` since that would stop\n * waiting at the first rejection.  The promise returned by\n * `allResolved` will never be rejected.\n * @param promises a promise for an array (or an array) of promises\n * (or values)\n * @return a promise for an array of promises\n */\nQ.allResolved = deprecate(allResolved, \"allResolved\", \"allSettled\");\nfunction allResolved(promises) {\n    return when(promises, function (promises) {\n        promises = array_map(promises, Q);\n        return when(all(array_map(promises, function (promise) {\n            return when(promise, noop, noop);\n        })), function () {\n            return promises;\n        });\n    });\n}\n\nPromise.prototype.allResolved = function () {\n    return allResolved(this);\n};\n\n/**\n * @see Promise#allSettled\n */\nQ.allSettled = allSettled;\nfunction allSettled(promises) {\n    return Q(promises).allSettled();\n}\n\n/**\n * Turns an array of promises into a promise for an array of their states (as\n * returned by `inspect`) when they have all settled.\n * @param {Array[Any*]} values an array (or promise for an array) of values (or\n * promises for values)\n * @returns {Array[State]} an array of states for the respective values.\n */\nPromise.prototype.allSettled = function () {\n    return this.then(function (promises) {\n        return all(array_map(promises, function (promise) {\n            promise = Q(promise);\n            function regardless() {\n                return promise.inspect();\n            }\n            return promise.then(regardless, regardless);\n        }));\n    });\n};\n\n/**\n * Captures the failure of a promise, giving an oportunity to recover\n * with a callback.  If the given promise is fulfilled, the returned\n * promise is fulfilled.\n * @param {Any*} promise for something\n * @param {Function} callback to fulfill the returned promise if the\n * given promise is rejected\n * @returns a promise for the return value of the callback\n */\nQ.fail = // XXX legacy\nQ[\"catch\"] = function (object, rejected) {\n    return Q(object).then(void 0, rejected);\n};\n\nPromise.prototype.fail = // XXX legacy\nPromise.prototype[\"catch\"] = function (rejected) {\n    return this.then(void 0, rejected);\n};\n\n/**\n * Attaches a listener that can respond to progress notifications from a\n * promise's originating deferred. This listener receives the exact arguments\n * passed to ``deferred.notify``.\n * @param {Any*} promise for something\n * @param {Function} callback to receive any progress notifications\n * @returns the given promise, unchanged\n */\nQ.progress = progress;\nfunction progress(object, progressed) {\n    return Q(object).then(void 0, void 0, progressed);\n}\n\nPromise.prototype.progress = function (progressed) {\n    return this.then(void 0, void 0, progressed);\n};\n\n/**\n * Provides an opportunity to observe the settling of a promise,\n * regardless of whether the promise is fulfilled or rejected.  Forwards\n * the resolution to the returned promise when the callback is done.\n * The callback can return a promise to defer completion.\n * @param {Any*} promise\n * @param {Function} callback to observe the resolution of the given\n * promise, takes no arguments.\n * @returns a promise for the resolution of the given promise when\n * ``fin`` is done.\n */\nQ.fin = // XXX legacy\nQ[\"finally\"] = function (object, callback) {\n    return Q(object)[\"finally\"](callback);\n};\n\nPromise.prototype.fin = // XXX legacy\nPromise.prototype[\"finally\"] = function (callback) {\n    if (!callback || typeof callback.apply !== \"function\") {\n        throw new Error(\"Q can't apply finally callback\");\n    }\n    callback = Q(callback);\n    return this.then(function (value) {\n        return callback.fcall().then(function () {\n            return value;\n        });\n    }, function (reason) {\n        // TODO attempt to recycle the rejection with \"this\".\n        return callback.fcall().then(function () {\n            throw reason;\n        });\n    });\n};\n\n/**\n * Terminates a chain of promises, forcing rejections to be\n * thrown as exceptions.\n * @param {Any*} promise at the end of a chain of promises\n * @returns nothing\n */\nQ.done = function (object, fulfilled, rejected, progress) {\n    return Q(object).done(fulfilled, rejected, progress);\n};\n\nPromise.prototype.done = function (fulfilled, rejected, progress) {\n    var onUnhandledError = function (error) {\n        // forward to a future turn so that ``when``\n        // does not catch it and turn it into a rejection.\n        Q.nextTick(function () {\n            makeStackTraceLong(error, promise);\n            if (Q.onerror) {\n                Q.onerror(error);\n            } else {\n                throw error;\n            }\n        });\n    };\n\n    // Avoid unnecessary `nextTick`ing via an unnecessary `when`.\n    var promise = fulfilled || rejected || progress ?\n        this.then(fulfilled, rejected, progress) :\n        this;\n\n    if (typeof process === \"object\" && process && process.domain) {\n        onUnhandledError = process.domain.bind(onUnhandledError);\n    }\n\n    promise.then(void 0, onUnhandledError);\n};\n\n/**\n * Causes a promise to be rejected if it does not get fulfilled before\n * some milliseconds time out.\n * @param {Any*} promise\n * @param {Number} milliseconds timeout\n * @param {Any*} custom error message or Error object (optional)\n * @returns a promise for the resolution of the given promise if it is\n * fulfilled before the timeout, otherwise rejected.\n */\nQ.timeout = function (object, ms, error) {\n    return Q(object).timeout(ms, error);\n};\n\nPromise.prototype.timeout = function (ms, error) {\n    var deferred = defer();\n    var timeoutId = setTimeout(function () {\n        if (!error || \"string\" === typeof error) {\n            error = new Error(error || \"Timed out after \" + ms + \" ms\");\n            error.code = \"ETIMEDOUT\";\n        }\n        deferred.reject(error);\n    }, ms);\n\n    this.then(function (value) {\n        clearTimeout(timeoutId);\n        deferred.resolve(value);\n    }, function (exception) {\n        clearTimeout(timeoutId);\n        deferred.reject(exception);\n    }, deferred.notify);\n\n    return deferred.promise;\n};\n\n/**\n * Returns a promise for the given value (or promised value), some\n * milliseconds after it resolved. Passes rejections immediately.\n * @param {Any*} promise\n * @param {Number} milliseconds\n * @returns a promise for the resolution of the given promise after milliseconds\n * time has elapsed since the resolution of the given promise.\n * If the given promise rejects, that is passed immediately.\n */\nQ.delay = function (object, timeout) {\n    if (timeout === void 0) {\n        timeout = object;\n        object = void 0;\n    }\n    return Q(object).delay(timeout);\n};\n\nPromise.prototype.delay = function (timeout) {\n    return this.then(function (value) {\n        var deferred = defer();\n        setTimeout(function () {\n            deferred.resolve(value);\n        }, timeout);\n        return deferred.promise;\n    });\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided as an array, and returns a promise.\n *\n *      Q.nfapply(FS.readFile, [__filename])\n *      .then(function (content) {\n *      })\n *\n */\nQ.nfapply = function (callback, args) {\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfapply = function (args) {\n    var deferred = defer();\n    var nodeArgs = array_slice(args);\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Passes a continuation to a Node function, which is called with the given\n * arguments provided individually, and returns a promise.\n * @example\n * Q.nfcall(FS.readFile, __filename)\n * .then(function (content) {\n * })\n *\n */\nQ.nfcall = function (callback /*...args*/) {\n    var args = array_slice(arguments, 1);\n    return Q(callback).nfapply(args);\n};\n\nPromise.prototype.nfcall = function (/*...args*/) {\n    var nodeArgs = array_slice(arguments);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.fapply(nodeArgs).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Wraps a NodeJS continuation passing function and returns an equivalent\n * version that returns a promise.\n * @example\n * Q.nfbind(FS.readFile, __filename)(\"utf-8\")\n * .then(console.log)\n * .done()\n */\nQ.nfbind =\nQ.denodeify = function (callback /*...args*/) {\n    if (callback === undefined) {\n        throw new Error(\"Q can't wrap an undefined function\");\n    }\n    var baseArgs = array_slice(arguments, 1);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        Q(callback).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nfbind =\nPromise.prototype.denodeify = function (/*...args*/) {\n    var args = array_slice(arguments);\n    args.unshift(this);\n    return Q.denodeify.apply(void 0, args);\n};\n\nQ.nbind = function (callback, thisp /*...args*/) {\n    var baseArgs = array_slice(arguments, 2);\n    return function () {\n        var nodeArgs = baseArgs.concat(array_slice(arguments));\n        var deferred = defer();\n        nodeArgs.push(deferred.makeNodeResolver());\n        function bound() {\n            return callback.apply(thisp, arguments);\n        }\n        Q(bound).fapply(nodeArgs).fail(deferred.reject);\n        return deferred.promise;\n    };\n};\n\nPromise.prototype.nbind = function (/*thisp, ...args*/) {\n    var args = array_slice(arguments, 0);\n    args.unshift(this);\n    return Q.nbind.apply(void 0, args);\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback with a given array of arguments, plus a provided callback.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param {Array} args arguments to pass to the method; the callback\n * will be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nmapply = // XXX As proposed by \"Redsandro\"\nQ.npost = function (object, name, args) {\n    return Q(object).npost(name, args);\n};\n\nPromise.prototype.nmapply = // XXX As proposed by \"Redsandro\"\nPromise.prototype.npost = function (name, args) {\n    var nodeArgs = array_slice(args || []);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * Calls a method of a Node-style object that accepts a Node-style\n * callback, forwarding the given variadic arguments, plus a provided\n * callback argument.\n * @param object an object that has the named method\n * @param {String} name name of the method of object\n * @param ...args arguments to pass to the method; the callback will\n * be provided by Q and appended to these arguments.\n * @returns a promise for the value or error\n */\nQ.nsend = // XXX Based on Mark Miller's proposed \"send\"\nQ.nmcall = // XXX Based on \"Redsandro's\" proposal\nQ.ninvoke = function (object, name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 2);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    Q(object).dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\nPromise.prototype.nsend = // XXX Based on Mark Miller's proposed \"send\"\nPromise.prototype.nmcall = // XXX Based on \"Redsandro's\" proposal\nPromise.prototype.ninvoke = function (name /*...args*/) {\n    var nodeArgs = array_slice(arguments, 1);\n    var deferred = defer();\n    nodeArgs.push(deferred.makeNodeResolver());\n    this.dispatch(\"post\", [name, nodeArgs]).fail(deferred.reject);\n    return deferred.promise;\n};\n\n/**\n * If a function would like to support both Node continuation-passing-style and\n * promise-returning-style, it can end its internal promise chain with\n * `nodeify(nodeback)`, forwarding the optional nodeback argument.  If the user\n * elects to use a nodeback, the result will be sent there.  If they do not\n * pass a nodeback, they will receive the result promise.\n * @param object a result (or a promise for a result)\n * @param {Function} nodeback a Node.js-style callback\n * @returns either the promise or nothing\n */\nQ.nodeify = nodeify;\nfunction nodeify(object, nodeback) {\n    return Q(object).nodeify(nodeback);\n}\n\nPromise.prototype.nodeify = function (nodeback) {\n    if (nodeback) {\n        this.then(function (value) {\n            Q.nextTick(function () {\n                nodeback(null, value);\n            });\n        }, function (error) {\n            Q.nextTick(function () {\n                nodeback(error);\n            });\n        });\n    } else {\n        return this;\n    }\n};\n\nQ.noConflict = function() {\n    throw new Error(\"Q.noConflict only works when Q is used as a global\");\n};\n\n// All code before this point will be filtered from stack traces.\nvar qEndingLine = captureLine();\n\nreturn Q;\n\n});\n\n}).call(this,require('_process'))\n},{\"_process\":20}],22:[function(require,module,exports){\nvar _global = (function() { return this; })();\nvar NativeWebSocket = _global.WebSocket || _global.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new NativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new NativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\n\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : NativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n\n},{\"./version\":23}],23:[function(require,module,exports){\nmodule.exports = require('../package.json').version;\n\n},{\"../package.json\":24}],24:[function(require,module,exports){\nmodule.exports={\n  \"_args\": [\n    [\n      \"websocket@1.0.24\",\n      \"/opt/ashamed\"\n    ]\n  ],\n  \"_from\": \"websocket@1.0.24\",\n  \"_id\": \"websocket@1.0.24\",\n  \"_inBundle\": false,\n  \"_integrity\": \"sha1-dJA+dfJUW2suHeFCW8HJBZF6GJA=\",\n  \"_location\": \"/websocket\",\n  \"_phantomChildren\": {},\n  \"_requested\": {\n    \"type\": \"version\",\n    \"registry\": true,\n    \"raw\": \"websocket@1.0.24\",\n    \"name\": \"websocket\",\n    \"escapedName\": \"websocket\",\n    \"rawSpec\": \"1.0.24\",\n    \"saveSpec\": null,\n    \"fetchSpec\": \"1.0.24\"\n  },\n  \"_requiredBy\": [\n    \"/\"\n  ],\n  \"_resolved\": \"https://registry.npmjs.org/websocket/-/websocket-1.0.24.tgz\",\n  \"_spec\": \"1.0.24\",\n  \"_where\": \"/opt/ashamed\",\n  \"author\": {\n    \"name\": \"Brian McKelvey\",\n    \"email\": \"brian@worlize.com\",\n    \"url\": \"https://www.worlize.com/\"\n  },\n  \"browser\": \"lib/browser.js\",\n  \"bugs\": {\n    \"url\": \"https://github.com/theturtle32/WebSocket-Node/issues\"\n  },\n  \"config\": {\n    \"verbose\": false\n  },\n  \"contributors\": [\n    {\n      \"name\": \"Iaki Baz Castillo\",\n      \"email\": \"ibc@aliax.net\",\n      \"url\": \"http://dev.sipdoc.net\"\n    }\n  ],\n  \"dependencies\": {\n    \"debug\": \"^2.2.0\",\n    \"nan\": \"^2.3.3\",\n    \"typedarray-to-buffer\": \"^3.1.2\",\n    \"yaeti\": \"^0.0.6\"\n  },\n  \"description\": \"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.\",\n  \"devDependencies\": {\n    \"buffer-equal\": \"^1.0.0\",\n    \"faucet\": \"^0.0.1\",\n    \"gulp\": \"git+https://github.com/gulpjs/gulp.git#4.0\",\n    \"gulp-jshint\": \"^2.0.4\",\n    \"jshint\": \"^2.0.0\",\n    \"jshint-stylish\": \"^2.2.1\",\n    \"tape\": \"^4.0.1\"\n  },\n  \"directories\": {\n    \"lib\": \"./lib\"\n  },\n  \"engines\": {\n    \"node\": \">=0.8.0\"\n  },\n  \"homepage\": \"https://github.com/theturtle32/WebSocket-Node\",\n  \"keywords\": [\n    \"websocket\",\n    \"websockets\",\n    \"socket\",\n    \"networking\",\n    \"comet\",\n    \"push\",\n    \"RFC-6455\",\n    \"realtime\",\n    \"server\",\n    \"client\"\n  ],\n  \"license\": \"Apache-2.0\",\n  \"main\": \"index\",\n  \"name\": \"websocket\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/theturtle32/WebSocket-Node.git\"\n  },\n  \"scripts\": {\n    \"gulp\": \"gulp\",\n    \"install\": \"(node-gyp rebuild 2> builderror.log) || (exit 0)\",\n    \"test\": \"faucet test/unit\"\n  },\n  \"version\": \"1.0.24\"\n}\n\n},{}]},{},[1]);\n"]}
>>>>>>> origin/master
