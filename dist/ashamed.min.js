/*! ashamed 2017-06-29 */

"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_slicedToArray=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();!function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(i)return i(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return o(n||e)},f,f.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){!function(t){var n=e("../lib/client.js");t.AshamedClient=n}(window)},{"../lib/client.js":2}],2:[function(e,t,n){function r(e){(e=JSON.parse(e.data)).channel==b&&("model-update"==e.type?o(e):"response"==e.type&&i(e))}function o(e){var t=e.args[0],n=e.args[1]||[];t=l(t),n.forEach(function(e){e.path=[].concat(t).concat(e.path),p(v,e)})}function i(e){var t=e.cid,n=_slicedToArray(e.args,2),r=n[0],o=n[1];if(y[t]){var i=y[t];delete y[t],i(r,o)}}var s=e("q"),u=e("./path.js"),c=e("extend"),a=e("events"),f=e("deep-diff").diff,p=u.applyChange,l=u.strToPath,h=(u.pathToStr,u.getPath),d="undefined"!=typeof WebSocket?WebSocket:e("websocket").w3cwebsocket,v={},y={},m=function(){},b="ashamed",g={host:"localhost:3000",base:"",realtime:!0},w=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e=c({},g,e),n._options=e,n._host=e.host,n._base=e.base,n._realtime=e.realtime,n._url={ws:"ws://"+e.host+e.base+"/ws",http:"http://"+e.host+e.base},n._err=null,n.connect(),n}return _inherits(t,e),_createClass(t,[{key:"_send",value:function(e,t){var n=this._err;e.channel=b,t=t||m,e.cid="ws_"+Math.random(),y[e.cid]=t,n?(n.code="ERROR",t(n,null)):this._ready.then(function(t){t.send(JSON.stringify(e))},function(e){e.code="ERROR",t(e,null)})}},{key:"connect",value:function(){var e=this,t=s.defer(),n=new d(this._url.ws);n.onerror=function(n){e._err="Unable to connect to "+e._url.ws,e.emit("error",e._err),t.reject(e._err)},n.onopen=function(){e._err=null,e.emit("ready",e),t.resolve(n)},n.onmessage=function(t){r(t),e.emit("message",t)},n.onclose=function(){e.emit("close"),e._err=new Error("Connection has been closed")},this._ready=t.promise}},{key:"get",value:function(e,t){var n=s.defer();Math.random();return t=c({},this._options,t),this._send({op:"get",args:[e,t]},function(r,o){r&&r.code?n.reject(r):t.realtime?n.resolve(h(e,!0,v,o)):n.resolve(o)}),n.promise}},{key:"set",value:function(e,t,n){var r=s.defer();Math.random();return n=c({},this._options,n),this._send({op:"set",args:[e,t,n]},function(t,o){t&&t.code?r.reject(t):n.realtime?r.resolve(h(e,!0,v,o)):r.resolve(o)}),r.promise}},{key:"update",value:function(e,t){var n=h(e,v),r=f(n,t);return this.diff(e,r)}},{key:"diff",value:function(e,t){var n=s.defer();Math.random();return this._send({op:"diff",args:[e,t]},function(e,t){e&&e.code?n.reject(e):n.resolve(t)}),n.promise}},{key:"path",value:function(e){var t=s.defer();Math.random();return this._send({op:"path",args:[e]},function(e,n){e&&e.code?t.reject(e):t.resolve(n)}),t.promise}},{key:"store",get:function(){return v}}]),t}(a);t.exports=w},{"./path.js":3,"deep-diff":4,events:5,extend:6,q:8,websocket:9}],3:[function(e,t,n){function r(e){return e=e||[],Array.isArray(e)?e:e.replace(/ /g,"").split("/").filter(function(e){return e.length})}function o(e,t,n){if(n.path&&n.path.length){var r,s=e[t],u=n.path.length-1;for(r=0;r<u;r++)s=s[n.path[r]];switch(n.kind){case"A":o(s[n.path[r]],n.index,n.item);break;case"D":delete s[n.path[r]];break;case"E":case"N":s[n.path[r]]=n.rhs}}else switch(n.kind){case"A":o(e[t],n.index,n.item);break;case"D":e=i(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function i(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}var s=e("extend");t.exports={strToPath:r,pathToStr:function(e){var t="string"==typeof(e=e||[])?e:e.join("/");return t.startsWith("/")?t:"/"+t},getPath:function(e,t,n,o){var i=n||{};if(!(e=r(e)).length)return i;for(;e.length;){var u=e.shift();if(!i[u]){if(!t)return null;i[u]={}}if(e.length||void 0===o||("object"==_typeof(i[u])&&Object.keys(i[u]).length&&"object"==(void 0===o?"undefined":_typeof(o))?s(!0,i[u],o):i[u]=o),i=i[u],!e.length)return i}},applyChange:function(e,t){if(e&&t&&t.kind){for(var n=e,r=-1,i=t.path?t.path.length-1:0;++r<i;)void 0===n[t.path[r]]&&(n[t.path[r]]="number"==typeof t.path[r]?[]:{}),n=n[t.path[r]];switch(t.kind){case"A":o(t.path?n[t.path[r]]:n,t.index,t.item);break;case"D":delete n[t.path[r]];break;case"E":case"N":void 0===n[t.path[r]]?n[t.path[r]]=t.rhs:s(!0,n[t.path[r]],t.rhs)}}}}},{extend:6}],4:[function(e,t,n){(function(e){!function(e,r){"object"===(void 0===n?"undefined":_typeof(n))&&void 0!==t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.DeepDiff=r()}(this,function(){function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function n(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function r(e,t,n){r.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function o(e,t){o.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function i(e,t){i.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function s(e,t,n){s.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function u(e,t,n){var r=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,r),e}function c(e){var t=void 0===e?"undefined":_typeof(e);return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"function"==typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function a(e,t,n,f,p,l,h){p=p||[],h=h||[];var d=p.slice(0);if(void 0!==l){if(f){if("function"==typeof f&&f(d,l))return;if("object"===(void 0===f?"undefined":_typeof(f))){if(f.prefilter&&f.prefilter(d,l))return;if(f.normalize){var v=f.normalize(d,l,e,t);v&&(e=v[0],t=v[1])}}}d.push(l)}"regexp"===c(e)&&"regexp"===c(t)&&(e=e.toString(),t=t.toString());var y=void 0===e?"undefined":_typeof(e),m=void 0===t?"undefined":_typeof(t),b="undefined"!==y||h&&h[h.length-1].lhs&&h[h.length-1].lhs.hasOwnProperty(l),g="undefined"!==m||h&&h[h.length-1].rhs&&h[h.length-1].rhs.hasOwnProperty(l);if(!b&&g)n(new o(d,t));else if(!g&&b)n(new i(d,e));else if(c(e)!==c(t))n(new r(d,e,t));else if("date"===c(e)&&e-t!=0)n(new r(d,e,t));else if("object"===y&&null!==e&&null!==t)if(h.filter(function(t){return t.lhs===e}).length)e!==t&&n(new r(d,e,t));else{if(h.push({lhs:e,rhs:t}),Array.isArray(e)){var w;e.length;for(w=0;w<e.length;w++)w>=t.length?n(new s(d,w,new i(void 0,e[w]))):a(e[w],t[w],n,f,d,w,h);for(;w<t.length;)n(new s(d,w,new o(void 0,t[w++])))}else{var k=Object.keys(e),_=Object.keys(t);k.forEach(function(r,o){var i=_.indexOf(r);i>=0?(a(e[r],t[r],n,f,d,r,h),_=u(_,i)):a(e[r],void 0,n,f,d,r,h)}),_.forEach(function(e){a(void 0,t[e],n,f,d,e,h)})}h.length=h.length-1}else e!==t&&("number"===y&&isNaN(e)&&isNaN(t)||n(new r(d,e,t)))}function f(e,t,n,r){return r=r||[],a(e,t,function(e){e&&r.push(e)},n),r.length?r:void 0}function p(e,t,n){if(n.path&&n.path.length){var r,o=e[t],i=n.path.length-1;for(r=0;r<i;r++)o=o[n.path[r]];switch(n.kind){case"A":p(o[n.path[r]],n.index,n.item);break;case"D":delete o[n.path[r]];break;case"E":case"N":o[n.path[r]]=n.rhs}}else switch(n.kind){case"A":p(e[t],n.index,n.item);break;case"D":e=u(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function l(e,t,n){if(e&&t&&n&&n.kind){for(var r=e,o=-1,i=n.path?n.path.length-1:0;++o<i;)void 0===r[n.path[o]]&&(r[n.path[o]]="number"==typeof n.path[o]?[]:{}),r=r[n.path[o]];switch(n.kind){case"A":p(n.path?r[n.path[o]]:r,n.index,n.item);break;case"D":delete r[n.path[o]];break;case"E":case"N":r[n.path[o]]=n.rhs}}}function h(e,t,n){if(n.path&&n.path.length){var r,o=e[t],i=n.path.length-1;for(r=0;r<i;r++)o=o[n.path[r]];switch(n.kind){case"A":h(o[n.path[r]],n.index,n.item);break;case"D":case"E":o[n.path[r]]=n.lhs;break;case"N":delete o[n.path[r]]}}else switch(n.kind){case"A":h(e[t],n.index,n.item);break;case"D":case"E":e[t]=n.lhs;break;case"N":e=u(e,t)}return e}var d,v,y=[];return d="object"===(void 0===e?"undefined":_typeof(e))&&e?e:"undefined"!=typeof window?window:{},(v=d.DeepDiff)&&y.push(function(){void 0!==v&&d.DeepDiff===f&&(d.DeepDiff=v,v=void 0)}),t(r,n),t(o,n),t(i,n),t(s,n),Object.defineProperties(f,{diff:{value:f,enumerable:!0},observableDiff:{value:a,enumerable:!0},applyDiff:{value:function(e,t,n){e&&t&&a(e,t,function(r){n&&!n(e,t,r)||l(e,t,r)})},enumerable:!0},applyChange:{value:l,enumerable:!0},revertChange:{value:function(e,t,n){if(e&&t&&n&&n.kind){var r,o,i=e;for(o=n.path.length-1,r=0;r<o;r++)void 0===i[n.path[r]]&&(i[n.path[r]]={}),i=i[n.path[r]];switch(n.kind){case"A":h(i[n.path[r]],n.index,n.item);break;case"D":case"E":i[n.path[r]]=n.lhs;break;case"N":delete i[n.path[r]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==v},enumerable:!0},noConflict:{value:function(){return y&&(y.forEach(function(e){e()}),y=null),f},enumerable:!0}}),f})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"number"==typeof e}function s(e){return"object"===(void 0===e?"undefined":_typeof(e))&&null!==e}function u(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,c,a;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(n=this._events[e],u(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(s(n))for(i=Array.prototype.slice.call(arguments,1),r=(a=n.slice()).length,c=0;c<r;c++)a[c].apply(this,i);return!0},r.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned&&(n=u(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,i,u;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(n)){for(u=i;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){r=u;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],6:[function(e,t,n){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},s=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t=r.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!n)return!1;var i;for(i in e);return void 0===i||r.call(e,i)};t.exports=function e(){var t,n,r,o,u,c,a=arguments[0],f=1,p=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[1]||{},f=2),(null==a||"object"!==(void 0===a?"undefined":_typeof(a))&&"function"!=typeof a)&&(a={});f<p;++f)if(null!=(t=arguments[f]))for(n in t)r=a[n],a!==(o=t[n])&&(l&&o&&(s(o)||(u=i(o)))?(u?(u=!1,c=r&&i(r)?r:[]):c=r&&s(r)?r:{},a[n]=e(l,c,o)):void 0!==o&&(a[n]=o));return a}},{}],7:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(p===setTimeout)return setTimeout(e,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function s(e){if(l===clearTimeout)return clearTimeout(e);if((l===o||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function u(){y&&d&&(y=!1,d.length?v=d.concat(v):m=-1,v.length&&c())}function c(){if(!y){var e=i(u);y=!0;for(var t=v.length;t;){for(d=v,v=[];++m<t;)d&&d[m].run();m=-1,t=v.length}d=null,y=!1,s(e)}}function a(e,t){this.fun=e,this.array=t}function f(){}var p,l,h=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(e){p=r}try{l="function"==typeof clearTimeout?clearTimeout:o}catch(e){l=o}}();var d,v=[],y=!1,m=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];v.push(new a(e,t)),1!==v.length||y||i(c)},a.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=f,h.addListener=f,h.once=f,h.off=f,h.removeListener=f,h.removeAllListeners=f,h.emit=f,h.prependListener=f,h.prependOnceListener=f,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],8:[function(e,t,n){(function(e){!function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"===(void 0===n?"undefined":_typeof(n))&&"object"===(void 0===t?"undefined":_typeof(t)))t.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var r="undefined"!=typeof window?window:self,o=r.Q;r.Q=e(),r.Q.noConflict=function(){return r.Q=o,this}}}(function(){function t(e){return function(){return M.apply(e,arguments)}}function n(e){return e===Object(e)}function r(e){return"[object StopIteration]"===V(e)||e instanceof N}function o(e,t){if(C&&t.stack&&"object"===(void 0===e?"undefined":_typeof(e))&&null!==e&&e.stack){for(var n=[],r=t;r;r=r.source)r.stack&&(!e.__minimumStackCounter__||e.__minimumStackCounter__>r.stackCounter)&&(I(e,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),n.unshift(r.stack));n.unshift(e.stack);var o=i(n.join("\n"+$+"\n"));I(e,"stack",{value:o,configurable:!0})}}function i(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var o=t[r];c(o)||s(o)||!o||n.push(o)}return n.join("\n")}function s(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function u(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function c(e){var t=u(e);if(!t)return!1;var n=t[0],r=t[1];return n===R&&r>=D&&r<=Y}function a(){if(C)try{throw new Error}catch(n){var e=n.stack.split("\n"),t=u(e[0].indexOf("@")>0?e[1]:e[2]);if(!t)return;return R=t[0],t[1]}}function f(e){return e instanceof d?e:b(e)?x(e):j(e)}function p(){function e(e){t=e,f.longStackSupport&&C&&(i.source=e),z(n,function(t,n){f.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],o=q(p.prototype),i=q(d.prototype);if(i.promiseDispatch=function(e,o,i){var s=Q(arguments);n?(n.push(s),"when"===o&&i[1]&&r.push(i[1])):f.nextTick(function(){t.promiseDispatch.apply(t,s)})},i.valueOf=function(){if(n)return i;var e=y(t);return m(e)&&(t=e),e},i.inspect=function(){return t?t.inspect():{state:"pending"}},f.longStackSupport&&C)try{throw new Error}catch(e){i.stack=e.stack.substring(e.stack.indexOf("\n")+1),i.stackCounter=H++}return o.promise=i,o.resolve=function(n){t||e(f(n))},o.fulfill=function(n){t||e(j(n))},o.reject=function(n){t||e(_(n))},o.notify=function(e){t||z(r,function(t,n){f.nextTick(function(){n(e)})},void 0)},o}function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=p();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function h(e){return l(function(t,n){for(var r=0,o=e.length;r<o;r++)f(e[r]).then(t,n)})}function d(e,t,n){void 0===t&&(t=function(e){return _(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=q(d.prototype);if(r.promiseDispatch=function(n,o,i){var s;try{s=e[o]?e[o].apply(r,i):t.call(r,o,i)}catch(e){s=_(e)}n&&n(s)},r.inspect=n,n){var o=n();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function v(e,t,n,r){return f(e).then(t,n,r)}function y(e){if(m(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function m(e){return e instanceof d}function b(e){return n(e)&&"function"==typeof e.then}function g(){J.length=0,G.length=0,X||(X=!0)}function w(t,n){X&&("object"===(void 0===e?"undefined":_typeof(e))&&"function"==typeof e.emit&&f.nextTick.runAfter(function(){-1!==U(G,t)&&(e.emit("unhandledRejection",n,t),K.push(t))}),G.push(t),n&&void 0!==n.stack?J.push(n.stack):J.push("(no stack) "+n))}function k(t){if(X){var n=U(G,t);-1!==n&&("object"===(void 0===e?"undefined":_typeof(e))&&"function"==typeof e.emit&&f.nextTick.runAfter(function(){var r=U(K,t);-1!==r&&(e.emit("rejectionHandled",J[n],t),K.splice(r,1))}),G.splice(n,1),J.splice(n,1))}}function _(e){var t=d({when:function(t){return t&&k(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return w(t,e),t}function j(e){return d({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return B(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function x(e){var t=p();return f.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}}),t.promise}function T(e,t,n){return f(e).spread(t,n)}function E(e,t,n){return f(e).dispatch(t,n)}function O(e){return v(e,function(e){var t=0,n=p();return z(e,function(r,o,i){var s;m(o)&&"fulfilled"===(s=o.inspect()).state?e[i]=s.value:(++t,v(o,function(r){e[i]=r,0==--t&&n.resolve(e)},n.reject,function(e){n.notify({index:i,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function S(e){if(0===e.length)return f.resolve();var t=f.defer(),n=0;return z(e,function(r,o,i){var s=e[i];n++,v(s,function(e){t.resolve(e)},function(e){0==--n&&(e.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+e.message,t.reject(e))},function(e){t.notify({index:i,value:e})})},void 0),t.promise}function A(e){return v(e,function(e){return e=W(e,f),v(O(W(e,function(e){return v(e,L,L)})),function(){return e})})}var C=!1;try{throw new Error}catch(e){C=!!e.stack}var R,N,D=a(),L=function(){},P=function(){function t(){for(var e,t;r.next;)e=(r=r.next).task,r.task=void 0,(t=r.domain)&&(r.domain=void 0,t.enter()),n(e,t);for(;c.length;)n(e=c.pop());i=!1}function n(e,n){try{e()}catch(e){if(u)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),e;setTimeout(function(){throw e},0)}n&&n.exit()}var r={task:void 0,next:null},o=r,i=!1,s=void 0,u=!1,c=[];if(P=function(t){o=o.next={task:t,domain:u&&e.domain,next:null},i||(i=!0,s())},"object"===(void 0===e?"undefined":_typeof(e))&&"[object process]"===e.toString()&&e.nextTick)u=!0,s=function(){e.nextTick(t)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){s=f,a.port1.onmessage=t,t()};var f=function(){a.port2.postMessage(0)};s=function(){setTimeout(t,0),f()}}else s=function(){setTimeout(t,0)};return P.runAfter=function(e){c.push(e),i||(i=!0,s())},P}(),M=Function.call,Q=t(Array.prototype.slice),z=t(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),U=t(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),W=t(Array.prototype.map||function(e,t){var n=this,r=[];return z(n,function(o,i,s){r.push(e.call(t,i,s,n))},void 0),r}),q=Object.create||function(e){function t(){}return t.prototype=e,new t},I=Object.defineProperty||function(e,t,n){return e[t]=n.value,e},F=t(Object.prototype.hasOwnProperty),B=Object.keys||function(e){var t=[];for(var n in e)F(e,n)&&t.push(n);return t},V=t(Object.prototype.toString);N="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var $="From previous event:";f.resolve=f,f.nextTick=P,f.longStackSupport=!1;var H=1;"object"===(void 0===e?"undefined":_typeof(e))&&e&&e.env&&e.env.Q_DEBUG&&(f.longStackSupport=!0),f.defer=p,p.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(Q(arguments,1)):e.resolve(n)}},f.Promise=l,f.promise=l,l.race=h,l.all=O,l.reject=_,l.resolve=f,f.passByCopy=function(e){return e},d.prototype.passByCopy=function(){return this},f.join=function(e,t){return f(e).join(t)},d.prototype.join=function(e){return f([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Q can't join: not the same: "+e+" "+t)})},f.race=h,d.prototype.race=function(){return this.then(f.race)},f.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(e,t,n){function r(t){try{return"function"==typeof e?e(t):t}catch(e){return _(e)}}function i(e){if("function"==typeof t){o(e,u);try{return t(e)}catch(e){return _(e)}}return _(e)}function s(e){return"function"==typeof n?n(e):e}var u=this,c=p(),a=!1;return f.nextTick(function(){u.promiseDispatch(function(e){a||(a=!0,c.resolve(r(e)))},"when",[function(e){a||(a=!0,c.resolve(i(e)))}])}),u.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(e){if(n=!0,!f.onerror)throw e;f.onerror(e)}n||c.notify(t)}]),c.promise},f.tap=function(e,t){return f(e).tap(t)},d.prototype.tap=function(e){return e=f(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},f.when=v,d.prototype.thenResolve=function(e){return this.then(function(){return e})},f.thenResolve=function(e,t){return f(e).thenResolve(t)},d.prototype.thenReject=function(e){return this.then(function(){throw e})},f.thenReject=function(e,t){return f(e).thenReject(t)},f.nearer=y,f.isPromise=m,f.isPromiseAlike=b,f.isPending=function(e){return m(e)&&"pending"===e.inspect().state},d.prototype.isPending=function(){return"pending"===this.inspect().state},f.isFulfilled=function(e){return!m(e)||"fulfilled"===e.inspect().state},d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},f.isRejected=function(e){return m(e)&&"rejected"===e.inspect().state},d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var J=[],G=[],K=[],X=!0;f.resetUnhandledRejections=g,f.getUnhandledReasons=function(){return J.slice()},f.stopUnhandledRejectionTracking=function(){g(),X=!1},g(),f.reject=_,f.fulfill=j,f.master=function(e){return d({isDef:function(){}},function(t,n){return E(e,t,n)},function(){return f(e).inspect()})},f.spread=T,d.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},f.async=function(e){return function(){function t(e,t){var s;if("undefined"==typeof StopIteration){try{s=n[e](t)}catch(e){return _(e)}return s.done?f(s.value):v(s.value,o,i)}try{s=n[e](t)}catch(e){return r(e)?f(e.value):_(e)}return v(s,o,i)}var n=e.apply(this,arguments),o=t.bind(t,"next"),i=t.bind(t,"throw");return o()}},f.spawn=function(e){f.done(f.async(e)())},f.return=function(e){throw new N(e)},f.promised=function(e){return function(){return T([this,O(arguments)],function(t,n){return e.apply(t,n)})}},f.dispatch=E,d.prototype.dispatch=function(e,t){var n=this,r=p();return f.nextTick(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},f.get=function(e,t){return f(e).dispatch("get",[t])},d.prototype.get=function(e){return this.dispatch("get",[e])},f.set=function(e,t,n){return f(e).dispatch("set",[t,n])},d.prototype.set=function(e,t){return this.dispatch("set",[e,t])},f.del=f.delete=function(e,t){return f(e).dispatch("delete",[t])},d.prototype.del=d.prototype.delete=function(e){return this.dispatch("delete",[e])},f.mapply=f.post=function(e,t,n){return f(e).dispatch("post",[t,n])},d.prototype.mapply=d.prototype.post=function(e,t){return this.dispatch("post",[e,t])},f.send=f.mcall=f.invoke=function(e,t){return f(e).dispatch("post",[t,Q(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(e){return this.dispatch("post",[e,Q(arguments,1)])},f.fapply=function(e,t){return f(e).dispatch("apply",[void 0,t])},d.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},f.try=f.fcall=function(e){return f(e).dispatch("apply",[void 0,Q(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,Q(arguments)])},f.fbind=function(e){var t=f(e),n=Q(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(Q(arguments))])}},d.prototype.fbind=function(){var e=this,t=Q(arguments);return function(){return e.dispatch("apply",[this,t.concat(Q(arguments))])}},f.keys=function(e){return f(e).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},f.all=O,d.prototype.all=function(){return O(this)},f.any=S,d.prototype.any=function(){return S(this)},f.allResolved=function(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}(A,"allResolved","allSettled"),d.prototype.allResolved=function(){return A(this)},f.allSettled=function(e){return f(e).allSettled()},d.prototype.allSettled=function(){return this.then(function(e){return O(W(e,function(e){function t(){return e.inspect()}return(e=f(e)).then(t,t)}))})},f.fail=f.catch=function(e,t){return f(e).then(void 0,t)},d.prototype.fail=d.prototype.catch=function(e){return this.then(void 0,e)},f.progress=function(e,t){return f(e).then(void 0,void 0,t)},d.prototype.progress=function(e){return this.then(void 0,void 0,e)},f.fin=f.finally=function(e,t){return f(e).finally(t)},d.prototype.fin=d.prototype.finally=function(e){if(!e||"function"!=typeof e.apply)throw new Error("Q can't apply finally callback");return e=f(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},f.done=function(e,t,n,r){return f(e).done(t,n,r)},d.prototype.done=function(t,n,r){var i=function(e){f.nextTick(function(){if(o(e,s),!f.onerror)throw e;f.onerror(e)})},s=t||n||r?this.then(t,n,r):this;"object"===(void 0===e?"undefined":_typeof(e))&&e&&e.domain&&(i=e.domain.bind(i)),s.then(void 0,i)},f.timeout=function(e,t,n){return f(e).timeout(t,n)},d.prototype.timeout=function(e,t){var n=p(),r=setTimeout(function(){t&&"string"!=typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),n.reject(t)},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},f.delay=function(e,t){return void 0===t&&(t=e,e=void 0),f(e).delay(t)},d.prototype.delay=function(e){return this.then(function(t){var n=p();return setTimeout(function(){n.resolve(t)},e),n.promise})},f.nfapply=function(e,t){return f(e).nfapply(t)},d.prototype.nfapply=function(e){var t=p(),n=Q(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},f.nfcall=function(e){var t=Q(arguments,1);return f(e).nfapply(t)},d.prototype.nfcall=function(){var e=Q(arguments),t=p();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},f.nfbind=f.denodeify=function(e){if(void 0===e)throw new Error("Q can't wrap an undefined function");var t=Q(arguments,1);return function(){var n=t.concat(Q(arguments)),r=p();return n.push(r.makeNodeResolver()),f(e).fapply(n).fail(r.reject),r.promise}},d.prototype.nfbind=d.prototype.denodeify=function(){var e=Q(arguments);return e.unshift(this),f.denodeify.apply(void 0,e)},f.nbind=function(e,t){var n=Q(arguments,2);return function(){var r=n.concat(Q(arguments)),o=p();return r.push(o.makeNodeResolver()),f(function(){return e.apply(t,arguments)}).fapply(r).fail(o.reject),o.promise}},d.prototype.nbind=function(){var e=Q(arguments,0);return e.unshift(this),f.nbind.apply(void 0,e)},f.nmapply=f.npost=function(e,t,n){return f(e).npost(t,n)},d.prototype.nmapply=d.prototype.npost=function(e,t){var n=Q(t||[]),r=p();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},f.nsend=f.nmcall=f.ninvoke=function(e,t){var n=Q(arguments,2),r=p();return n.push(r.makeNodeResolver()),f(e).dispatch("post",[t,n]).fail(r.reject),r.promise},d.prototype.nsend=d.prototype.nmcall=d.prototype.ninvoke=function(e){var t=Q(arguments,1),n=p();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},f.nodeify=function(e,t){return f(e).nodeify(t)},d.prototype.nodeify=function(e){if(!e)return this;this.then(function(t){f.nextTick(function(){e(null,t)})},function(t){f.nextTick(function(){e(t)})})},f.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var Y=a();return f})}).call(this,e("_process"))},{_process:7}],9:[function(e,t,n){var r=function(){return this}(),o=r.WebSocket||r.MozWebSocket,i=e("./version");t.exports={w3cwebsocket:o?function(e,t){return t?new o(e,t):new o(e)}:null,version:i}},{"./version":10}],10:[function(e,t,n){t.exports=e("../package.json").version},{"../package.json":11}],11:[function(e,t,n){t.exports={_args:[[{raw:"websocket@^1.0.24",scope:null,escapedName:"websocket",name:"websocket",rawSpec:"^1.0.24",spec:">=1.0.24 <2.0.0",type:"range"},"C:\\t\\ashamed"]],_from:"websocket@>=1.0.24 <2.0.0",_id:"websocket@1.0.24",_inCache:!0,_location:"/websocket",_nodeVersion:"7.3.0",_npmOperationalInternal:{host:"packages-12-west.internal.npmjs.com",tmp:"tmp/websocket-1.0.24.tgz_1482977757939_0.1858439394272864"},_npmUser:{name:"theturtle32",email:"brian@worlize.com"},_npmVersion:"3.10.10",_phantomChildren:{},_requested:{raw:"websocket@^1.0.24",scope:null,escapedName:"websocket",name:"websocket",rawSpec:"^1.0.24",spec:">=1.0.24 <2.0.0",type:"range"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/websocket/-/websocket-1.0.24.tgz",_shasum:"74903e75f2545b6b2e1de1425bc1c905917a1890",_shrinkwrap:null,_spec:"websocket@^1.0.24",_where:"C:\\t\\ashamed",author:{name:"Brian McKelvey",email:"brian@worlize.com",url:"https://www.worlize.com/"},browser:"lib/browser.js",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},config:{verbose:!1},contributors:[{name:"IÃ±aki Baz Castillo",email:"ibc@aliax.net",url:"http://dev.sipdoc.net"}],dependencies:{debug:"^2.2.0",nan:"^2.3.3","typedarray-to-buffer":"^3.1.2",yaeti:"^0.0.6"},description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",devDependencies:{"buffer-equal":"^1.0.0",faucet:"^0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^2.0.4",jshint:"^2.0.0","jshint-stylish":"^2.2.1",tape:"^4.0.1"},directories:{lib:"./lib"},dist:{shasum:"74903e75f2545b6b2e1de1425bc1c905917a1890",tarball:"https://registry.npmjs.org/websocket/-/websocket-1.0.24.tgz"},engines:{node:">=0.8.0"},gitHead:"0e15f9445953927c39ce84a232cb7dd6e3adf12e",homepage:"https://github.com/theturtle32/WebSocket-Node",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],license:"Apache-2.0",main:"index",maintainers:[{name:"theturtle32",email:"brian@worlize.com"}],name:"websocket",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+https://github.com/theturtle32/WebSocket-Node.git"},scripts:{gulp:"gulp",install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit"},version:"1.0.24"}},{}]},{},[1]);